导出，如遇到19849错误，自动将text改为byte导出。
```
#user modify area
DBNAME=db2022
DATADIR=/home/gbasedbt/db
#user modify area end

FET_BUF_SIZE=32767
LANG=en_us
EXPDATE=`date +%Y%m%d%H%M%S`
mkdir -p $DATADIR
mkdir explog.${EXPDATE}
cd explog.${EXPDATE}
mkdir rejectfile
CURRDIR=`pwd`
filename=chk.log
Current=0

echo ""
echo "#################### check database information... ###################"
echo ""
dbaccess sysmaster - <<EOF >${filename} 2>/dev/null
!echo "#################### database log type information ###################"
select * from sysdatabases where name='${DBNAME}';
!echo "#################### database locale information #####################"
select * from sysdbslocale where dbs_dbsname='${DBNAME}';
database ${DBNAME};
!echo "#################### database object count information ###############"
select
(select count(*) from systables where tabtype='T' and tabid>99 ) as tableCount,
(select count(*) from systables where tabtype='E' and tabid>99) as extTabCount,
(select count(*) from systables where tabtype='V' and tabid>99) as viewCount,
(select count(*) from systables where tabtype='Q' and tabid>99) as sequenceCount,
(select count(*) from systables where tabtype='S' or tabtype='P' and tabid>99) as synonymCount,
(select count(*) from sysindexes where tabid>99) as indexCount,
(select count(*) from sysprocedures where mode='O') as proccount,
(select count(*) from systriggers) as trigcount
from systables where tabid=1;
EOF
#####################chkrows########################
echo "#################### database table rows information ##################"  >>${filename}
dbaccess -e -m ${DBNAME} -<<! >/dev/null 2>&1
unload to tablist.unl delimiter " " select tabname from systables where tabid>99 and tabtype='T' order by tabname;
!
while read tab 
do
dbaccess ${DBNAME} -<<!>/dev/null 2>&1
unload to tmp.unl select "${tab}",count(*) from $tab;
!
cat tmp.unl >>${filename}
done <tablist.unl
rm -rf tmp.unl

echo "#################### check database information completed! ###########"
echo ""

cat <<EOF  >exptab.sh
tabname=\$1
DATE=\`date\`
echo "unload "\$tabname" start: "\$DATE >>exp.log
dbaccess -e -m ${DBNAME} -<<! >tablog/\${tabname}.log 2>&1   
unload to ${DATADIR}/\${tabname}.unl select * from \${tabname};
!
ISERROR=\`grep -c 19849 tablog/\${tabname}.log\`
if [ \${ISERROR} -eq 1 ];then
SQLTEXTTOBYTE=\`echo "SELECT ' table ' || tab.tabname || ' modify (' || wm_concat(col.colname||' byte') || ');' as alter  fROM syscolumns col,systables tab WHERE col.tabid = tab.tabid AND col.coltype = 12 and tabname='"\${tabname}"' group by tabname" |dbaccess ${DBNAME}\`
SQLBYTETOTEXT=\`echo "SELECT ' table ' || tab.tabname || ' modify (' || wm_concat(col.colname||' text') || ');' as alter  fROM syscolumns col,systables tab WHERE col.tabid = tab.tabid AND col.coltype = 12 and tabname='"\${tabname}"' group by tabname" |dbaccess ${DBNAME}\`
echo \${SQLBYTETOTEXT} >>${DATADIR}\/bytetotext.sql
echo "set lock mode to wait;"\${SQLTEXTTOBYTE} |dbaccess -e -m ${DBNAME}  >>tablog/\${tabname}.log 2>&1
dbaccess -e -m ${DBNAME} - <<! >>tablog/\${tabname}.log 2>&1
unload to ${DATADIR}/\${tabname}.unl select * from \${tabname};
!
fi
DATE=\`date\`
echo "unload "\$tabname" end: "\$DATE >>exp.log
EOF

echo "######################### export data start! #########################"
echo ""
mkdir tablog
>exp.log
echo "set lock mode to wait;">${DATADIR}/bytetotext.sql
while read tabname
do
nohup sh exptab.sh $tabname >/dev/null 2>&1 &
done < tablist.unl

TotoaTab=`wc -l tablist.unl |awk '{print $1}'`
Current=`grep -c end: exp.log`
while ((${Current}<${TotoaTab}))
do
Before=`grep -c end: exp.log`
sleep 10
Current=`grep -c end: exp.log`
if [ ${Current} -gt ${Before} ]
then
echo "#################### "${Current}" tables of "${TotoaTab}" completed! ####################"
echo ""
fi
done

echo "#################### get database schema... ##########################"
dbschema -d ${DBNAME} -nw -ss ${DATADIR}/${DBNAME}.ss.sql >/dev/null 2>&1
dbschema -d ${DBNAME} -nw  ${DATADIR}/${DBNAME}.sql >/dev/null 2>&1
echo "set pdqpriority 96;" > ${DATADIR}/idx.sql
sed -n '/revoke usage /,$p' ${DATADIR}/${DBNAME}.ss.sql >> ${DATADIR}/idx.sql
sed -n '1,/revoke usage /p' ${DATADIR}/${DBNAME}.ss.sql > ${DATADIR}/tab.sql
echo ""
echo "#################### get database schema completed! ##################"
echo ""
echo "#################### cover byte to text! #############################"
echo ""
dbaccess -e -m ${DBNAME} ${DATADIR}/bytetotext.sql >bytetotext.log 2>&1
echo "#################### cover byte to text completed! ###################"
echo ""
cp chk.log ${DATADIR}
cp tablist.unl ${DATADIR}
echo "#################### data export completed! ##########################"

```

导出，byte导入完成后更改为text。
```
#user modify area
DBNAME=db2022
DATADIR=/home/gbasedbt/db
#user modify area end

export FET_BUF_SIZE=32767
export LANG=en_us
IMPDATE=`date +%Y%m%d%H%M%S`
mkdir implog.${IMPDATE}
cd implog.${IMPDATE}
mkdir rejectfile
export CURRDIR=`pwd`
filename=chk.log

#################### new imptab.sh ###################################
cat <<EOF  >imptab.sh
tabname=\$1
dbaccess -e -m ${DBNAME} -<<! >>tablog/\${tabname}.log 2>&1
load from ${DATADIR}/\${tabname}.unl insert into  \${tabname};
!
DATE=\`date\`
echo "load "\$tabname" end: "\$DATE >>imp.log
EOF

cp $DATADIR/tablist.unl .

echo "#################### create table start! #############################"
echo ""
dbaccess -e -m ${DBNAME} ${DATADIR}/tab.sql >createTab.log 2>&1
echo "#################### create table completed! #########################"

#################### import data ###################################
mkdir tablog
>imp.log
while read tabname
do
nohup sh imptab.sh $tabname >/dev/null 2>&1 & 
done < tablist.unl
echo ""
echo "#################### data import is running... #######################"
echo ""
TotoaTab=`wc -l tablist.unl |awk '{print $1}'`
Current=`grep -c end: imp.log`
while ((${Current}<${TotoaTab}))
do
Before=`grep -c end: imp.log`
sleep 10
Current=`grep -c end: imp.log`
if [ ${Current} -gt ${Before} ]
then
echo "#################### "${Current}" tables of "${TotoaTab}" completed! ####################"
date
echo ""
fi
done

echo "#################### data import completed! ##########################"
echo ""
echo "#################### create index start... ###########################"
echo ""
dbaccess -e -m ${DBNAME} ${DATADIR}/idx.sql >createIdx.log 2>&1
echo "#################### create index completed! #########################"
echo ""
echo "#################### cover byte to text! #############################"
echo ""
dbaccess -e -m ${DBNAME} ${DATADIR}/bytetotext.sql >bytetotext.log 2>&1
echo "#################### cover byte to text completed! ###################"
echo ""
echo "#################### change database log mode...! ####################"
echo ""
ontape -s -U ${DBNAME} -t /dev/null>/dev/null 2>&1
echo "#################### change database log mode completed! #############"
echo ""
echo "#### check all objects in database! any diffents will display! #######"
echo ""
dbaccess sysmaster - <<EOF >${filename} 2>/dev/null
!echo "#################### database log type information ###################"
select * from sysdatabases where name='${DBNAME}';
!echo "#################### database locale information #####################"
select * from sysdbslocale where dbs_dbsname='${DBNAME}';
database ${DBNAME};
!echo "#################### database object count information ###############"
select
(select count(*) from systables where tabtype='T' and tabid>99) as tableCount,
(select count(*) from systables where tabtype='E' and tabid>99) as extTabCount,
(select count(*) from systables where tabtype='V' and tabid>99) as viewCount,
(select count(*) from systables where tabtype='Q' and tabid>99) as sequenceCount,
(select count(*) from systables where tabtype='S' or tabtype='P' and tabid>99) as synonymCount,
(select count(*) from sysindexes where tabid>99) as indexCount,
(select count(*) from sysprocedures where  mode='O') as proccount,
(select count(*) from systriggers) as trigcount
from systables where tabid=1;
EOF
#####################chkrows########################
echo "#################### database table rows information ##################"  >>${filename}
dbaccess -e -m ${DBNAME} -<<! >/dev/null 2>&1
unload to tabTotal.unl delimiter " " select tabname from systables where tabid>99 and tabtype='T' order by tabname;
!
while read tab 
do
dbaccess ${DBNAME} -<<!>/dev/null 2>&1
unload to tmp.unl select "${tab}",count(*) from $tab;
!
cat tmp.unl >>${filename}
done <tabTotal.unl
rm -rf tmp.unl
diff $DATADIR/chk.log chk.log
echo "#################### check database information completed! ###########"
echo ""
echo "################################## end ###############################"

```