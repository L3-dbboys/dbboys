<?xml version="1.0" encoding="UTF-8"?>

<?import java.lang.*?>
<?import java.util.*?>
<?import javafx.scene.*?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.shape.SVGPath?>
<?import com.dbboys.customnode.CustomLabelTextField?>
<?import javafx.collections.FXCollections?>
<?import com.dbboys.customnode.CustomSqlEditCodeArea?>
<?import org.fxmisc.flowless.VirtualizedScrollPane?>
<?import com.dbboys.customnode.CustomInfoStackPane?>
<?import com.dbboys.customnode.CustomUserTextField?>
<?import org.controlsfx.control.tableview2.TableView2?>
<?import com.dbboys.customnode.CustomResultsetTableView?>
<VBox fx:id="sqlTab" fx:controller="com.dbboys.ctrl.SqlTabController" xmlns="http://javafx.com/javafx/8.0.31" xmlns:fx="http://javafx.com/fxml/1">
    <HBox alignment="CENTER_LEFT" style="-fx-border-color: #aaa;-fx-border-width: 0.2 0 0.2 0">
        <Button fx:id="sqlRunButton" styleClass="custom-button" focusTraversable="false">
            <tooltip>
                <Tooltip text="执行选定SQL，如未选定默认选中所有。" />
            </tooltip>
            <graphic>
                <Group>
                    <SVGPath content="M20.625 11.2812 L17 9.1719 L14 12.0781 L16.7344 14.7031 L20.625 12.4531 Q20.7969 12.3906 20.8906 12.2344 Q20.9844 12.0625 20.9844 11.875 Q20.9844 11.875 20.9844 11.875 Q20.9844 11.875 20.9844 11.875 L20.9844 11.875 Q20.9844 11.875 20.9844 11.875 Q20.9844 11.875 20.9844 11.875 Q20.9844 11.6875 20.8906 11.5312 Q20.7969 11.375 20.625 11.2812 L20.625 11.2812 L20.625 11.2812 ZM16.3906 8.8281 L12.375 6.5 L3.6094 2 L13.5 11.5938 L16.3906 8.8281 ZM3.75 22 L12.4062 17.2344 L16.125 15.0781 L13.5 12.5469 L3.75 22 ZM3.0312 2.4062 L3.0312 21.7656 L13.0156 12.0781 L3.0312 2.4062 Z" fill="#074675" scaleX="0.7" scaleY="0.7"/>
                </Group>
            </graphic>
        </Button>
        <Button fx:id="sqlExplainButton" styleClass="custom-button" focusTraversable="false">
            <tooltip>
                <Tooltip text="生成选定SQL的执行计划，如未选定默认选中所有。" />
            </tooltip>
            <graphic>
                <Group>
                    <SVGPath content="M16.2656 2.0391 Q16.5156 2.0391 16.7188 2.2109 Q16.9375 2.3828 16.9844 2.6641 L16.9844 3.5234 L17.7656 3.5234 Q18.6719 3.5234 19.3438 4.1797 Q20.0156 4.8203 20.0156 5.7891 L20.0156 16.0078 L16.0781 16.0078 Q15.2656 16.1016 14.6562 16.6797 Q14.0625 17.2578 14.0156 18.1172 L14.0156 22.0078 L5.7656 22.0078 Q4.7969 22.0078 4.1406 21.3672 Q3.5 20.7109 3.5 19.8047 L3.5 5.7891 Q3.5 4.8203 4.1406 4.1797 Q4.7969 3.5234 5.7656 3.5234 L6.4844 3.5234 L6.4844 2.7578 Q6.4844 2.4766 6.6875 2.2578 Q6.9062 2.0391 7.1875 2.0234 Q7.4844 1.9922 7.7188 2.1953 Q7.9688 2.3828 8.0156 2.6641 L8.0156 3.5234 L10.9844 3.5234 L10.9844 2.7578 Q10.9844 2.4766 11.2031 2.2578 Q11.4219 2.0391 11.7031 2.0234 Q12 1.9922 12.2344 2.1953 Q12.4844 2.3828 12.4844 2.6641 L12.4844 3.5234 L15.5 3.5234 L15.5 2.7578 Q15.5 2.4766 15.7188 2.2578 Q15.9375 2.0391 16.2656 2.0391 ZM19.5781 17.5391 L15.5 21.5703 L15.5 18.1641 Q15.5469 17.9297 15.7188 17.7422 Q15.8906 17.5391 16.125 17.5391 L19.5312 17.5391 L19.5781 17.5391 ZM11.2344 16.0078 L7.25 16.0078 L7.1562 16.0078 Q6.8594 16.0547 6.6719 16.2734 Q6.4844 16.4922 6.4844 16.7891 Q6.4844 17.0703 6.6719 17.2891 Q6.8594 17.4922 7.1562 17.4922 L11.3281 17.4922 Q11.6094 17.4922 11.7969 17.2891 Q12 17.0703 12 16.7891 Q12 16.4922 11.7969 16.2734 Q11.6094 16.0547 11.3281 16.0078 L11.2344 16.0078 ZM16.2188 12.0234 L7.25 12.0234 L7.1562 12.0234 Q6.8594 12.0703 6.6719 12.2891 Q6.4844 12.5078 6.4844 12.7734 Q6.4844 13.0391 6.6719 13.2578 Q6.8594 13.4609 7.1562 13.5078 L16.375 13.5078 Q16.6094 13.4609 16.7969 13.2578 Q16.9844 13.0391 16.9844 12.7734 Q16.9844 12.5078 16.7969 12.2891 Q16.6094 12.0703 16.375 12.0234 L16.2656 12.0234 L16.2188 12.0234 ZM16.2188 8.0391 L7.25 8.0391 L7.1562 8.0391 Q6.8594 8.0859 6.6719 8.2891 Q6.4844 8.4766 6.4844 8.7734 Q6.4844 9.0547 6.6719 9.2734 Q6.8594 9.4766 7.1562 9.5234 L16.375 9.5234 Q16.6094 9.4766 16.7969 9.2734 Q16.9844 9.0547 16.9844 8.7734 Q16.9844 8.4766 16.7969 8.2891 Q16.6094 8.0859 16.375 8.0391 L16.2656 8.0391 L16.2188 8.0391 Z" fill="#074675" scaleX="0.7" scaleY="0.7"/>
                </Group>
            </graphic>
        </Button>
        <Button fx:id="sqlStopButton" styleClass="custom-button" focusTraversable="false">
            <tooltip>
                <Tooltip text="停止执行当前正在运行的SQL" />
            </tooltip>
            <graphic>
                <Group>
                    <SVGPath content="M19.2031 6.0078 L19.2031 17.7734 Q19.2031 18.3516 18.7812 18.7734 Q18.3594 19.1953 17.7656 19.1953 L6 19.1953 Q5.5156 19.1953 5.1562 18.8516 Q4.8125 18.4922 4.8125 18.0078 L4.8125 6.2422 Q4.8125 5.6484 5.2344 5.2266 Q5.6562 4.8047 6.2344 4.8047 L18 4.8047 Q18.5 4.8047 18.8438 5.1641 Q19.2031 5.5078 19.2031 6.0078 L19.2031 6.0078 Z" fill="#9f453c" scaleX="0.75" scaleY="0.75"/>
                </Group>
            </graphic>
        </Button>
        <Region prefWidth="50"></Region>
        <StackPane fx:id="sqlConnectChoiceBoxIconStackPane"/>
        <ChoiceBox fx:id="sqlConnectChoiceBox" styleClass="custom-connectname-choicebox" focusTraversable="false">
        </ChoiceBox>
        <Group>
            <SVGPath content="M21 3.4219 L21 5.5781 Q21 6.9844 17.9219 8 Q14.8594 9 10.5 9 Q6.1406 9 3.0625 8 Q0 6.9844 0 5.5781 L0 3.4219 Q0 2.0156 3.0625 1.0156 Q6.1406 0 10.5 0 Q14.8594 0 17.9219 1.0156 Q21 2.0156 21 3.4219 ZM21 8.25 L21 13.0781 Q21 14.4844 17.9219 15.5 Q14.8594 16.5 10.5 16.5 Q6.1406 16.5 3.0625 15.5 Q0 14.4844 0 13.0781 L0 8.25 Q3.3281 10.5469 10.5 10.5469 Q17.6719 10.5469 21 8.25 ZM21 15.75 L21 20.5781 Q21 21.9844 17.9219 22.9844 Q14.8594 24 10.5 24 Q6.1406 24 3.0625 22.9844 Q0 21.9844 0 20.5781 L0 15.75 Q3.3281 18.0469 10.5 18.0469 Q17.6719 18.0469 21 15.75 Z" fill="#888" scaleX="0.4" scaleY="0.4"/>
        </Group>
        <ChoiceBox fx:id="sqlDbChoiceBox"  styleClass="custom-dbname-choicebox" focusTraversable="false">
        </ChoiceBox>
        <Group>
            <SVGPath content="M7.5 6.9922 Q7.5 8.8672 8.8281 10.1797 Q10.1562 11.4922 12 11.4922 Q13.8594 11.4922 15.1719 10.1797 Q16.5 8.8672 16.5 6.9922 Q16.5 5.1484 15.1719 3.8203 Q13.8594 2.4922 12 2.4922 Q10.1562 2.4922 8.8281 3.8203 Q7.5 5.1484 7.5 6.9922 ZM20 21.5078 L21 21.5078 L21 20.4922 Q21 19.0703 20.4375 17.7734 Q19.9062 16.5078 18.9531 15.5703 Q18 14.6172 16.7188 14.0547 Q15.4531 13.5078 14 13.5078 L10.0156 13.5078 Q8.5625 13.5078 7.2969 14.0547 Q6 14.6172 5.0469 15.5703 Q4.1094 16.5078 3.5625 17.7734 Q3 19.0703 3 20.4922 L3 21.5078 L20 21.5078 L20 21.5078 Z" fill="#888" scaleX="0.55" scaleY="0.55"/>
        </Group>
        <CustomLabelTextField fx:id="sqlUserTextField" focusTraversable="false" style="-fx-padding: 0 0 0 5">
        </CustomLabelTextField>
        <ChoiceBox fx:id="sqlSqlModeChoiceBox" styleClass="custom-sqlmode-choicebox" focusTraversable="false">
        </ChoiceBox>
        <Region HBox.hgrow="ALWAYS"></Region>
        
        <StackPane>
            <HBox alignment="CENTER_RIGHT">
                <Label fx:id="sqlReadOnlyLabel" text=" " visible="false">
                    <graphic>
                        <Group>
                            <SVGPath content="M17 9.0078 L17 7.0078 Q17 5.9609 16.625 5.0391 Q16.2188 4.1328 15.5469 3.4609 Q14.8906 2.7734 13.9688 2.3984 Q13.0625 1.9922 12 1.9922 Q10.9531 1.9922 10.0312 2.3984 Q9.125 2.7734 8.4531 3.4609 Q7.7812 4.1328 7.3906 5.0391 Q7.0156 5.9609 7.0156 7.0078 L7.0156 9.0078 Q5.7188 9.0078 4.8594 9.8828 Q4.0156 10.7422 4.0156 12.0078 L4.0156 19.0078 Q4.0156 20.2734 4.8594 21.1484 Q5.7188 22.0078 7.0156 22.0078 L17 22.0078 Q18.2812 22.0078 19.1406 21.1484 Q20 20.2734 20 19.0078 L20 12.0078 Q20 10.7422 19.1406 9.8828 Q18.2812 9.0078 17 9.0078 L17 9.0078 ZM9 7.0078 Q9 5.7266 9.8594 4.8672 Q10.7344 4.0078 12 4.0078 Q13.2656 4.0078 14.125 4.8672 Q15 5.7266 15 7.0078 L15 9.0078 L9 9.0078 L9 7.0078 L9 7.0078 ZM13.1094 15.4922 Q13.1094 15.4922 13.0625 15.5547 Q13.0156 15.6172 13.0156 15.6172 L13.0156 16.9922 Q13.0156 17.4609 12.7344 17.7422 Q12.4531 18.0078 12 18.0078 Q11.5625 18.0078 11.2812 17.7422 Q11 17.4609 11 16.9922 L11 15.6172 Q10.5469 15.1484 10.5 14.5547 Q10.4531 13.9453 10.9062 13.5078 Q11.3438 13.0547 11.9375 13.0078 Q12.5469 12.9609 13.0156 13.4141 Q13.4531 13.7891 13.5 14.4297 Q13.5469 15.0547 13.1094 15.4922 L13.1094 15.4922 Z" fill="#9f453c" scaleX="0.5" scaleY="0.5"/>
                        </Group>
                    </graphic>
                </Label>
            </HBox>
            <HBox>
                <ChoiceBox fx:id="sqlCommitModeChoiceBox"  styleClass="custom-commitmode-choicebox" focusTraversable="false">
                    <items>
                        <FXCollections fx:factory="observableArrayList">
                            <String fx:value="自动提交" />
                            <String fx:value="手动提交" />
                        </FXCollections>
                    </items>
                </ChoiceBox>
                <Button fx:id="sqlRecordButton" styleClass="custom-button" focusTraversable="false">
                    <tooltip>
                        <Tooltip text="当前连接执行成功的变更记录" />
                    </tooltip>
                    <graphic>
                        <Group>
                            <SVGPath content="M12.5156 4.5 Q9.3281 4.5469 7.1875 6.6875 Q5.0625 8.8125 5.0156 12 Q5.0625 15.1875 7.1875 17.2969 Q9.3281 19.4062 12.5156 19.5 Q15.7031 19.4062 17.8125 17.2969 Q19.9219 15.1875 20.0156 12 Q19.9219 8.8125 17.8125 6.6875 Q15.7031 4.5469 12.5156 4.5 ZM6.9844 9.4688 L9 9.4688 Q9.4219 9.5156 9.7031 9.7969 Q9.9844 10.0781 9.9844 10.5 L9.9844 11.4844 Q9.9844 11.8594 9.75 12.125 Q9.5156 12.375 9.1406 12.4688 L10.3125 14.4844 L9.1406 14.4844 L8.0156 12.4688 L8.0156 14.4844 L6.9844 14.4844 L6.9844 9.4688 ZM12 9.4688 L14.0156 9.4688 L14.0156 10.5 L12 10.5 L12 11.4844 L14.0156 11.4844 L14.0156 12.4688 L12 12.4688 L12 13.5 L14.0156 13.5 L14.0156 14.4844 L12 14.4844 Q11.5781 14.4844 11.2969 14.2031 Q11.0156 13.9219 11.0156 13.5 L11.0156 10.5 Q11.0156 10.0781 11.2969 9.7969 Q11.5781 9.5156 12 9.4688 ZM15.9844 9.4688 L18 9.4688 L18 10.5 L15.9844 10.5 L15.9844 13.5 L18 13.5 L18 14.4844 L15.9844 14.4844 Q15.5625 14.4844 15.2812 14.2031 Q15 13.9219 15 13.5 L15 10.5 Q15 10.0781 15.2812 9.7969 Q15.5625 9.5156 15.9844 9.4688 ZM8.0156 10.5 L8.0156 11.4844 L9 11.4844 L9 10.5 L8.0156 10.5 Z" fill="#074675" scaleX="0.8" scaleY="0.8"/>
                        </Group>
                    </graphic>
                </Button>
            </HBox>
        </StackPane>
    </HBox>
    <SplitPane fx:id="sqlSplitPane" prefHeight="30000" style="-fx-background-color: none" orientation="VERTICAL">
        <Pane fx:id="topPane">
            <StackPane fx:id="sqlEditStackPane" alignment="BOTTOM_LEFT">
                <VirtualizedScrollPane fx:id="sqlEditScrollPane">
                    <content>
                    <CustomSqlEditCodeArea fx:id="sqlEditCodeArea">
                    </CustomSqlEditCodeArea>
                    </content>
                </VirtualizedScrollPane>
                <HBox fx:id="transactionBox" maxHeight="15" maxWidth="160" alignment="CENTER_LEFT" visible="false">
                    <!--
                    <Button fx:id="trans_warning_button"  focusTraversable="false" style="-fx-background-color: none;-fx-border-color: none" visible="false">
                        <graphic>
                            <Group>
                                <SVGPath content="M10.8906 3.0859 Q11.6562 2.6641 12.5156 2.8828 Q13.3906 3.0859 13.875 3.8047 L21.75 17.9609 Q21.9844 18.4922 22 19.0703 Q22.0312 19.6484 21.7344 20.1641 Q21.4531 20.6641 20.9688 20.9766 Q20.5 21.2734 19.9219 21.3359 L4.2188 21.3359 Q3.6406 21.3359 3.1406 21.0547 Q2.6406 20.7578 2.3281 20.2734 Q2.0156 19.7891 1.9844 19.2266 Q1.9688 18.6484 2.2031 18.1172 L10.0312 3.9453 Q10.3125 3.3828 10.8906 3.0859 ZM12 16.2891 Q11.4219 16.2891 11.1094 16.7891 Q10.7969 17.2891 11.1094 17.8047 Q11.4219 18.3047 12 18.3047 Q12.3906 18.3047 12.6719 18.0234 Q12.9531 17.7266 12.9531 17.3203 Q12.9531 16.9141 12.6719 16.6328 Q12.3906 16.3359 12 16.2891 ZM12 8.3203 Q11.6094 8.3203 11.3281 8.5703 Q11.0469 8.8047 10.9844 9.1797 L10.9844 14.4141 Q11.0469 14.8047 11.3281 15.0703 Q11.6094 15.3359 12 15.3359 Q12.3906 15.3359 12.6719 15.0703 Q12.9531 14.8047 13.0156 14.4141 L13.0156 9.1797 Q12.9531 8.8047 12.6719 8.5703 Q12.3906 8.3203 12 8.3203 Z" fill="#ff0000" scaleX="0.6" scaleY="0.6"/>
                            </Group>
                        </graphic>
                    </Button>
                    -->
                    <Button fx:id="transactionCommitButton"  focusTraversable="false" text="commit" styleClass="commit-btn">
                    </Button>
                    <Label text=" "></Label>
                    <Button fx:id="transactionRollbackButton"  focusTraversable="false" text="rollback" styleClass="commit-btn">
                    </Button>
                </HBox>
            </StackPane>
        </Pane>
        <!--Pane用于避免拖动被元素阻挡 -->
        <Pane fx:id="bottomPane">
            <StackPane fx:id="bottomPaneStackPane">
                <TabPane fx:id="resultsetTabPane" tabClosingPolicy="ALL_TABS">
                    <Tab text="执行结果" closable="false" style="-fx-pref-height: 18;">
                        <StackPane fx:id="resultsetStackPane">
                            <CustomResultsetTableView fx:id="resultsetTotalTableView" style="-fx-background-color: white">
                            </CustomResultsetTableView>
                        </StackPane>

                    </Tab>
                </TabPane>
                <!--<HBox>外层需加一层stackpane，防止HBox设置不可见时导致下层tableview列宽拖动会被卡顿-->
                <StackPane fx:id="sqlExecuteProcessStackPane" maxWidth="300" maxHeight="50" alignment="CENTER" visible="false">
                    <HBox alignment="CENTER">
                        <ProgressIndicator prefWidth="15"></ProgressIndicator>
                        <Label fx:id="sqlExecuteTaskInfo"></Label>
                        <Label fx:id="sqlExecuteTimeInfo" text="耗时 0 秒"></Label>
                    </HBox>
                </StackPane>
            </StackPane>
        </Pane>
    </SplitPane>
</VBox>
