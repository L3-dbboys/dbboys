package com.dbboys.util;

import com.dbboys.app.Main;
import com.dbboys.ctrl.CreateConnectController;
import com.dbboys.customnode.*;
import com.dbboys.service.ConnectDBaccessService;
import com.dbboys.vo.*;
import javafx.application.Platform;
import javafx.collections.FXCollections;
import javafx.collections.ObservableList;
import javafx.concurrent.Task;
import javafx.event.ActionEvent;
import javafx.fxml.FXMLLoader;
import javafx.geometry.Insets;
import javafx.geometry.Pos;
import javafx.scene.Group;
import javafx.scene.control.*;
import javafx.scene.image.Image;
import javafx.scene.input.*;
import javafx.scene.layout.GridPane;
import javafx.scene.layout.HBox;
import javafx.scene.layout.VBox;
import javafx.scene.paint.Color;
import javafx.scene.shape.SVGPath;
import javafx.stage.Stage;
import org.apache.logging.log4j.LogManager;
import org.apache.logging.log4j.Logger;
import org.json.JSONArray;
import org.json.JSONObject;

import java.io.IOException;
import java.sql.SQLException;
import java.util.ArrayList;
import java.util.Comparator;
import java.util.List;
import java.util.concurrent.ExecutorService;
import java.util.concurrent.Executors;
import java.util.function.UnaryOperator;
import java.util.regex.Matcher;
import java.util.regex.Pattern;

public class MetadataTreeviewUtil {
    private static final Logger log = LogManager.getLogger(MetadataTreeviewUtil.class);

    //public static ExecutorService executorService;
    public static List<TreeItem<TreeData>> searchResults = new ArrayList<>();
    public static ConnectDBaccessService metaDBaccessService;
    public static MenuItem refreshItem;
    public static MenuItem databaseOpenFileItem;
    public static MenuItem connectFolderInfoItem;
    public static MenuItem connectInfoItem;
    public   static int currentIndex = -1;
    public static Thread testConnThread;
    static{
        //executorService = Executors.newSingleThreadExecutor();
        metaDBaccessService = new ConnectDBaccessService();
    }


    public static void initDatabaseObjectsTreeview(TreeView<TreeData> treeView){
        TreeItem<TreeData> rootItem = new TreeItem<>();
        rootItem.setExpanded(true);
        treeView.setRoot(rootItem);
        treeView.getSelectionModel().select(rootItem);
        treeView.setShowRoot(false);
        List<TreeData> connectFolders = SqliteDBaccessUtil.getConnectFolders();
        List<TreeData> connectLeafs = SqliteDBaccessUtil.getConnectLeafs();
        //添加分类节点
        for(TreeData connectFolder : connectFolders){
            TreeItem<TreeData> connectFolderItem = createTreeItem(connectFolder);
            if(((ConnectFolder)connectFolder).getExpand()==1){
                connectFolderItem.setExpanded(true);
            }else{
                connectFolderItem.setExpanded(false);
            }
            rootItem.getChildren().add(connectFolderItem);

            //每个分类添加子节点
            for(TreeData connectLeaf : connectLeafs){
                if(((Connect)connectLeaf).getParentId()==((ConnectFolder)connectFolder).getId()){
                    TreeItem<TreeData> connectLeafItem = createTreeItem(connectLeaf);
                    connectFolderItem.getChildren().add(connectLeafItem);
                }
            }

        }

        //右键弹出框
        ContextMenu treeview_menu = new ContextMenu();
        //单独设置宽度
        //treeview_menu.getStyleClass().add("exclude-css");

        SVGPath createConnectItemIcon = new SVGPath();
        createConnectItemIcon.setContent("M12.125 15.3281 L8.2344 19.2031 Q7.9062 19.5469 7.4375 19.7344 Q6.9844 19.9219 6.4688 19.9219 Q5.9844 19.9219 5.5156 19.7344 Q5.0625 19.5469 4.7344 19.2031 L4.7344 19.2031 Q4.3906 18.875 4.2031 18.4219 Q4.0156 17.9531 4.0156 17.4688 Q4.0156 16.9531 4.2031 16.5 Q4.3906 16.0312 4.7344 15.7031 L8.6094 11.8125 Q8.75 11.6719 8.8281 11.5 Q8.9062 11.3281 8.9062 11.1094 Q8.9062 10.6875 8.6094 10.4062 Q8.3281 10.1094 7.9062 10.1094 Q7.6875 10.1094 7.5156 10.1875 Q7.3438 10.2656 7.2031 10.4062 L7.2031 10.4062 L3.3125 14.2969 Q2.7656 14.8906 2.4531 15.6719 Q2.1406 16.4531 2.1406 17.3281 Q2.1406 19.1719 3.4531 20.4844 Q4.7656 21.7969 6.6094 21.7969 Q7.4844 21.7969 8.2656 21.4844 Q9.0469 21.1719 9.6406 20.625 L9.6406 20.625 L13.5312 16.7344 Q13.6719 16.5938 13.75 16.4219 Q13.8281 16.25 13.8281 16.0312 Q13.8281 15.6094 13.5312 15.3281 Q13.25 15.0312 12.8281 15.0312 Q12.6094 15.0312 12.4375 15.1094 Q12.2656 15.1875 12.125 15.3281 L12.125 15.3281 L12.125 15.3281 ZM8.8438 15.0938 Q8.9844 15.2344 9.1562 15.3281 Q9.3281 15.4062 9.5469 15.4062 Q9.5469 15.4062 9.5469 15.4062 Q9.5469 15.4062 9.5469 15.4062 L9.5469 15.4062 Q9.5469 15.4062 9.5469 15.4062 Q9.5469 15.4062 9.5469 15.4062 Q9.75 15.4062 9.9375 15.3281 Q10.125 15.2344 10.25 15.0938 L15.1719 10.1719 Q15.3125 10.0625 15.3906 9.875 Q15.4688 9.6875 15.4688 9.4688 Q15.4688 9.0469 15.1719 8.7656 Q14.8906 8.4688 14.4688 8.4688 Q14.25 8.4688 14.0625 8.5469 Q13.875 8.625 13.7656 8.7656 L8.8438 13.6875 Q8.7031 13.8125 8.6094 14 Q8.5312 14.1875 8.5312 14.3906 Q8.5312 14.6094 8.6094 14.7812 Q8.7031 14.9531 8.8438 15.0938 L8.8438 15.0938 L8.8438 15.0938 ZM21 17.9375 L20 17.9375 L20 16.9219 Q20 16.5312 19.7031 16.2344 Q19.4062 15.9375 19.0156 15.9375 Q18.5938 15.9375 18.2969 16.2344 Q18 16.5312 18 16.9219 L18 16.9219 L18 17.9375 L17 17.9375 Q16.5938 17.9375 16.2969 18.2344 Q16.0156 18.5156 16.0156 18.9375 Q16.0156 19.3438 16.2969 19.6406 Q16.5938 19.9219 17 19.9219 L17 19.9219 L18 19.9219 L18 20.9375 Q18 21.3594 18.2969 21.6562 Q18.5938 21.9375 19.0156 21.9375 Q19.4062 21.9375 19.7031 21.6562 Q20 21.3594 20 20.9375 L20 20.9375 L20 19.9219 L21 19.9219 Q21.4219 19.9219 21.7188 19.6406 Q22.0156 19.3438 22.0156 18.9375 Q22.0156 18.5156 21.7188 18.2344 Q21.4219 17.9375 21 17.9375 L21 17.9375 ZM16.8125 13.4531 L20.7031 9.5625 Q21.2344 8.9844 21.5469 8.2031 Q21.875 7.4062 21.875 6.5469 Q21.875 4.6875 20.5625 3.375 Q19.25 2.0625 17.3906 2.0625 Q16.5312 2.0625 15.7344 2.3906 Q14.9531 2.7031 14.375 3.2344 L14.375 3.2344 L10.4844 7.125 Q10.3438 7.2656 10.25 7.4531 Q10.1719 7.625 10.1719 7.8281 Q10.1719 8.25 10.4688 8.5469 Q10.7656 8.8438 11.1875 8.8438 Q11.3906 8.8438 11.5625 8.7656 Q11.75 8.6719 11.8906 8.5312 L11.8906 8.5312 L15.7812 4.6719 Q16.1094 4.3125 16.5625 4.125 Q17.0156 3.9375 17.5312 3.9375 Q18.0312 3.9375 18.4844 4.125 Q18.9375 4.3125 19.2656 4.6719 L19.2656 4.6719 Q19.625 5 19.8125 5.4531 Q20 5.9062 20 6.4062 Q20 6.9219 19.8125 7.375 Q19.625 7.8281 19.2656 8.1562 L15.4062 12.0469 Q15.2656 12.1719 15.1719 12.3594 Q15.0938 12.5469 15.0938 12.75 Q15.0938 12.9688 15.1719 13.1406 Q15.2656 13.3125 15.4062 13.4531 L15.4062 13.4531 Q15.5156 13.5938 15.7031 13.6875 Q15.8906 13.7656 16.1094 13.7656 Q16.3125 13.7656 16.4844 13.6875 Q16.6719 13.5938 16.8125 13.4531 L16.8125 13.4531 L16.8125 13.4531 Z");
        createConnectItemIcon.setScaleX(0.6);
        createConnectItemIcon.setScaleY(0.6);
        createConnectItemIcon.setFill(Color.valueOf("#074675"));
        SVGPath deleteItemIcon = new SVGPath();
        deleteItemIcon.setContent("M16.5156 11.6406 Q17.9531 11.6406 19.25 12.3906 Q20.5469 13.125 21.2656 14.4062 Q21.9844 15.6719 21.9844 17.1406 Q21.9844 18.5938 21.2656 19.875 Q20.5469 21.1406 19.25 21.8906 Q17.9531 22.625 16.4844 22.625 Q15.0312 22.625 13.75 21.8906 Q12.4844 21.1406 11.7344 19.9062 Q10.9844 18.6562 10.9844 17.1406 Q10.9844 15.625 11.7344 14.375 Q12.4844 13.125 13.75 12.3906 Q15.0312 11.6406 16.5156 11.6406 ZM12 1.375 Q13.2969 1.375 14.2344 2.2656 Q15.1719 3.1406 15.2656 4.4375 L15.2656 4.625 L20.5 4.625 Q20.7812 4.625 21 4.8438 Q21.2188 5.0625 21.2344 5.3594 Q21.2656 5.6406 21.0625 5.8594 Q20.875 6.0781 20.5938 6.125 L19.7344 6.125 L19.2031 11.2031 Q18.4844 10.9219 17.7656 10.7812 L18.1875 6.125 L5.8125 6.125 L7.0625 19.0312 Q7.1094 19.4688 7.4219 19.7812 Q7.7344 20.0938 8.2031 20.1406 L10.75 20.1406 Q11.1875 20.9531 11.8125 21.625 L8.2969 21.625 Q7.2969 21.625 6.5312 20.9844 Q5.7656 20.3281 5.6094 19.3281 L4.2656 6.125 L3.5 6.125 Q3.2188 6.125 3 5.9531 Q2.7812 5.7812 2.7344 5.5 L2.7344 5.4062 Q2.7344 5.1094 2.9219 4.9062 Q3.125 4.6875 3.4062 4.625 L8.7344 4.625 Q8.7344 3.2812 9.6875 2.3281 Q10.6562 1.375 12 1.375 ZM13.7344 14.2344 L13.625 14.2812 L13.5781 14.375 Q13.3906 14.6094 13.5781 14.9062 L15.7969 17.1562 L13.5781 19.375 Q13.3906 19.6562 13.5781 19.9375 L13.7344 20.0469 Q14.0156 20.2344 14.2969 20.0469 L16.5156 17.8281 L18.7188 20.0469 Q19.0156 20.2344 19.2969 20.0469 L19.3906 19.9375 Q19.5781 19.6562 19.3906 19.375 L17.1875 17.1562 L19.3906 14.9062 Q19.5781 14.6094 19.3906 14.375 L19.2969 14.2344 Q19.0156 14.0469 18.7188 14.2344 L16.5156 16.4375 L14.2969 14.2344 Q14.0625 14.0938 13.7812 14.1875 L13.7344 14.2344 ZM12 2.9062 Q11.3281 2.9062 10.8125 3.3594 Q10.3125 3.8125 10.2656 4.4844 L10.2656 4.625 L13.7344 4.625 Q13.7344 3.9062 13.2188 3.4062 Q12.7188 2.9062 12 2.9062 Z");
        deleteItemIcon.setScaleX(0.6);
        deleteItemIcon.setScaleY(0.6);
        deleteItemIcon.setFill(Color.valueOf("#9f453c"));
        SVGPath expandFolderItemIcon = new SVGPath();
        expandFolderItemIcon.setContent("M9.9844 13.8359 Q10.1094 13.9609 10.1094 14.1484 Q10.1094 14.3203 9.9844 14.4453 L5.5312 18.8984 L7.4531 20.8203 Q7.7188 21.0859 7.7188 21.4297 Q7.7188 21.7734 7.4531 22.0234 Q7.2031 22.2891 6.8594 22.2891 L0.8594 22.2891 Q0.5156 22.2891 0.25 22.0234 Q0 21.7734 0 21.4297 L0 15.4297 Q0 15.0859 0.25 14.8359 Q0.5156 14.5703 0.8594 14.5703 Q1.2031 14.5703 1.4531 14.8203 L3.3906 16.7578 L7.8281 12.3047 Q7.9688 12.1797 8.1406 12.1797 Q8.3125 12.1797 8.4531 12.3047 L9.9844 13.8359 ZM20.5781 2.5703 L20.5781 8.5703 Q20.5781 8.9141 20.3125 9.1797 Q20.0625 9.4297 19.7031 9.4297 Q19.3594 9.4297 19.1094 9.1797 L17.1875 7.2422 L12.7344 11.6953 Q12.6094 11.8203 12.4219 11.8203 Q12.25 11.8203 12.125 11.6953 L10.5938 10.1641 Q10.4531 10.0234 10.4531 9.8516 Q10.4531 9.6797 10.5938 9.5547 L15.0469 5.1016 L13.1094 3.1797 Q12.8594 2.9141 12.8594 2.5703 Q12.8594 2.2266 13.1094 1.9766 Q13.3594 1.7109 13.7188 1.7109 L19.7188 1.7109 Q20.0625 1.7109 20.3125 1.9766 Q20.5781 2.2266 20.5781 2.5703 Z");
        //expandFolderItemIcon.setContent("M12.9844 9 L12.9844 15 L15.9844 15 L12 18.9844 L8.0156 15 L11.0156 15 L11.0156 9 L8.0156 9 L12 5.0156 L15.9844 9 L12.9844 9 ZM3.9844 2.0156 L20.0156 2.0156 L20.0156 3.9844 L3.9844 3.9844 L3.9844 2.0156 ZM3.9844 20.0156 L20.0156 20.0156 L20.0156 21.9844 L3.9844 21.9844 L3.9844 20.0156 Z");
        expandFolderItemIcon.setScaleX(0.5);
        expandFolderItemIcon.setScaleY(0.5);
        expandFolderItemIcon.setFill(Color.valueOf("#074675"));
        SVGPath flodFolderItemIcon = new SVGPath();
        flodFolderItemIcon.setContent("M19.0156 9 L16.4375 9 L19.7188 5.7188 Q19.8594 5.5781 19.9375 5.3906 Q20.0156 5.2031 20.0156 4.9844 Q20.0156 4.5938 19.7031 4.2969 Q19.4062 3.9844 19.0156 3.9844 Q18.7969 3.9844 18.6094 4.0625 Q18.4219 4.1406 18.2812 4.2812 L18.2812 4.2812 L15 7.5625 L15 4.9844 Q15 4.5938 14.7031 4.2969 Q14.4219 4 14 4 L14 4 Q13.5938 4 13.2969 4.2969 Q13.0156 4.5938 13.0156 4.9844 L13.0156 4.9844 L13.0156 10 Q13.0156 10.4062 13.2969 10.7031 Q13.5938 10.9844 14 10.9844 L14 10.9844 L19.0156 10.9844 Q19.4062 10.9844 19.7031 10.7031 Q20 10.4062 20 10 Q20 9.5781 19.7031 9.2969 Q19.4062 9 19.0156 9 L19.0156 9 L19.0156 9 ZM10.0156 13 L5 13 Q4.5938 13 4.2969 13.2969 Q4.0156 13.5938 4.0156 13.9844 Q4.0156 14.4062 4.2969 14.7031 Q4.5938 15 5 15 L5 15 L7.5781 15 L4.2969 18.2812 Q4.1562 18.4219 4.0625 18.6094 Q3.9844 18.7969 3.9844 19 Q3.9844 19.2188 4.0625 19.3906 Q4.1562 19.5625 4.2969 19.7031 L4.2969 19.7031 Q4.4375 19.8438 4.6094 19.9375 Q4.7812 20.0156 5 20.0156 Q5.2031 20.0156 5.3906 19.9375 Q5.5781 19.8438 5.7188 19.7031 L9 16.4219 L9 19 Q9 19.4062 9.2969 19.7031 Q9.5938 19.9844 10.0156 19.9844 L10.0156 19.9844 Q10.4062 19.9844 10.7031 19.7031 Q11 19.4062 11 19 L11 19 L11 13.9844 Q11 13.5938 10.7031 13.2969 Q10.4062 13 10.0156 13 L10.0156 13 L10.0156 13 Z");
        flodFolderItemIcon.setScaleX(0.75);
        flodFolderItemIcon.setScaleY(0.75);
        flodFolderItemIcon.setFill(Color.valueOf("#074675"));
        SVGPath refreshItemIcon = new SVGPath();
        refreshItemIcon.setContent("M17.6719 6.3281 L20.0156 3.9844 L20.0156 11.0156 L12.9844 11.0156 L16.2188 7.7812 Q15.375 6.9375 14.2969 6.4688 Q13.2188 6 12 6 Q10.3594 6 8.9688 6.7969 Q7.5938 7.5938 6.7969 8.9844 Q6 10.3594 6 12 Q6 13.6406 6.7969 15.0312 Q7.5938 16.4062 8.9688 17.2031 Q10.3594 18 12 18 L12 18 Q13.7344 18 15.3906 16.8281 Q17.0625 15.6562 17.6719 14.0156 L19.7344 14.0156 Q19.0312 16.6406 16.8906 18.3281 Q14.7656 20.0156 12 20.0156 Q9.8438 20.0156 7.9844 18.9375 Q6.1406 17.8594 5.0781 16.0156 Q4.0312 14.1562 4.0312 12 Q4.0312 9.8438 5.0781 8 Q6.1406 6.1406 7.9844 5.0625 Q9.8438 3.9844 12 3.9844 L12 3.9844 Q13.3594 3.9844 15.0156 4.6875 Q16.6875 5.3906 17.6719 6.3281 Z");
        refreshItemIcon.setScaleX(0.7);
        refreshItemIcon.setScaleY(0.7);
        refreshItemIcon.setFill(Color.valueOf("#074675"));
        SVGPath connectItemIcon = new SVGPath();
        connectItemIcon.setContent("M21.2812 3.3281 Q22.2656 4.3125 22.6094 5.6562 Q22.9688 6.9844 22.6094 8.3281 Q22.2656 9.6562 21.2812 10.6406 L19.4531 12.4688 Q18.4688 13.4531 17.125 13.7812 Q15.7969 14.1094 14.4844 13.7812 L19.4531 8.8125 Q20.2031 8.0625 20.2031 6.9844 Q20.2031 5.9062 19.4531 5.1562 Q18.7031 4.4062 17.625 4.4062 Q16.5469 4.4062 15.7969 5.1562 L10.8281 10.125 Q10.5 8.8125 10.8281 7.4844 Q11.1562 6.1406 12.1406 5.1562 L13.9688 3.3281 Q14.9531 2.3438 16.2812 2 Q17.625 1.6406 18.9531 2 Q20.2969 2.3438 21.2812 3.3281 ZM10.3125 16.125 L16.7344 9.7031 Q17.1094 9.3281 17.1094 8.7969 Q17.1094 8.25 16.7031 7.875 Q16.3125 7.5 15.7656 7.5312 Q15.2344 7.5469 14.8594 7.875 L8.4844 14.2969 Q8.1094 14.6719 8.1094 15.2188 Q8.1094 15.75 8.4844 16.125 Q8.8594 16.5 9.3906 16.4844 Q9.9375 16.4531 10.3125 16.125 ZM9.375 18.8438 L14.3438 13.875 Q14.7188 15.1875 14.3906 16.5312 Q14.0625 17.8594 13.0781 18.8438 L11.25 20.6719 Q10.2188 21.7031 8.9062 22.0312 Q7.5938 22.3594 6.25 22.0312 Q4.9219 21.7031 3.9062 20.7031 Q2.9062 19.6875 2.5469 18.3594 Q2.2031 17.0156 2.5469 15.6875 Q2.9062 14.3438 3.8906 13.3594 L5.7656 11.5312 Q6.75 10.5469 8.0625 10.2188 Q9.375 9.8906 10.7344 10.2188 L5.7656 15.1875 Q4.9688 15.9375 4.9688 17.0156 Q4.9688 18.0938 5.7344 18.875 Q6.5156 19.6406 7.5625 19.6406 Q8.625 19.6406 9.375 18.8438 Z");
        connectItemIcon.setScaleX(0.65);
        connectItemIcon.setScaleY(0.65);
        connectItemIcon.setFill(Color.valueOf("#074675"));
        SVGPath connectInfoItemIcon = new SVGPath();
        connectInfoItemIcon.setContent("M10.5 7.125 Q10.5 6.6562 10.8281 6.3281 Q11.1562 6 11.625 6 L12.375 6 Q12.8438 6 13.1719 6.3281 Q13.5 6.6562 13.5 7.125 L13.5 7.875 Q13.5 8.3438 13.1719 8.6719 Q12.8438 9 12.375 9 L11.625 9 Q11.1562 9 10.8281 8.6719 Q10.5 8.3438 10.5 7.875 L10.5 7.125 ZM15 18 L9 18 L9 16.5 L10.5 16.5 L10.5 12 L9 12 L9 10.5 L13.5 10.5 L13.5 16.5 L15 16.5 L15 18 ZM12 0 Q9.5156 0 7.3281 0.9375 Q5.1406 1.875 3.5 3.5 Q1.875 5.125 0.9375 7.3281 Q0 9.5156 0 12 Q0 14.4844 0.9375 16.6719 Q1.875 18.8594 3.5 20.5 Q5.1406 22.125 7.3281 23.0625 Q9.5156 24 12 24 Q14.4844 24 16.6719 23.0625 Q18.875 22.125 20.5 20.5 Q22.125 18.8594 23.0625 16.6719 Q24 14.4844 24 12 Q24 9.5156 23.0625 7.3281 Q22.125 5.125 20.5 3.5 Q18.875 1.875 16.6719 0.9375 Q14.4844 0 12 0 ZM12 21.75 Q9.9844 21.75 8.2031 20.9844 Q6.4219 20.2188 5.0938 18.9062 Q3.7812 17.5781 3.0156 15.7969 Q2.25 14.0156 2.25 12 Q2.25 9.9844 3.0156 8.2031 Q3.7812 6.4219 5.0938 5.0938 Q6.4219 3.7656 8.2031 3.0156 Q9.9844 2.25 12 2.25 Q14.0156 2.25 15.7969 3.0156 Q17.5781 3.7656 18.9062 5.0938 Q20.2344 6.4219 20.9844 8.2031 Q21.75 9.9844 21.75 12 Q21.75 14.0156 20.9844 15.7969 Q20.2344 17.5781 18.9062 18.9062 Q17.5781 20.2188 15.7969 20.9844 Q14.0156 21.75 12 21.75 Z");
        connectInfoItemIcon.setScaleX(0.55);
        connectInfoItemIcon.setScaleY(0.55);
        connectInfoItemIcon.setFill(Color.valueOf("#074675"));
        SVGPath reconnectItemIcon = new SVGPath();
        reconnectItemIcon.setContent("M21.7031 3.6328 Q21.9844 3.3359 21.9844 2.9297 Q21.9844 2.5234 21.6875 2.2422 Q21.4062 1.9453 21 1.9453 Q20.5938 1.9453 20.2969 2.2266 L18.4844 4.0078 Q17.2344 3.2422 15.7656 3.4141 Q14.2969 3.5703 13.25 4.6328 L12.1875 5.6953 Q11.6562 6.2109 11.6562 6.9453 Q11.6562 7.6641 12.1875 8.1797 L15.75 11.7422 Q16.2656 12.2734 16.9844 12.2734 Q17.7188 12.2734 18.2344 11.7422 L19.2969 10.6797 Q20.3594 9.6328 20.5156 8.1641 Q20.6875 6.6953 19.9219 5.4453 L21.7031 3.6328 ZM10.7031 11.6484 Q10.9844 11.3516 10.9844 10.9453 Q10.9844 10.5391 10.7031 10.2578 Q10.4219 9.9609 10 9.9609 Q9.5938 9.9609 9.3125 10.1953 L7.8281 11.6953 L7.5312 11.3984 Q7.2969 11.1641 6.9844 11.1641 Q6.6719 11.1641 6.4844 11.3984 L4.7031 13.1797 Q3.6406 14.2266 3.4688 15.6953 Q3.3125 17.1641 4.0781 18.4141 L2.2969 20.2266 Q1.875 20.6172 2.0156 21.1953 Q2.1562 21.7734 2.7344 21.9141 Q3.3125 22.0547 3.7031 21.6328 L5.5156 19.8516 Q6.7656 20.6172 8.2344 20.4609 Q9.7031 20.2891 10.75 19.2266 L12.5312 17.4453 Q12.7656 17.2578 12.7656 16.9453 Q12.7656 16.6328 12.5312 16.3984 L12.2344 16.1016 L13.7344 14.6172 Q13.9688 14.3359 13.9688 13.9297 Q13.9688 13.5078 13.6719 13.2266 Q13.3906 12.9453 12.9844 12.9453 Q12.5781 12.9453 12.2812 13.2266 L10.7969 14.7109 L9.2188 13.1328 L10.7031 11.6484 Z");
        reconnectItemIcon.setScaleX(0.7);
        reconnectItemIcon.setScaleY(0.7);
        reconnectItemIcon.setFill(Color.valueOf("#074675"));
        SVGPath disconnectFolderIcon = new SVGPath();
        disconnectFolderIcon.setContent("M5.875 17.8828 L2.4531 21.3047 Q2.2969 21.4297 2.1406 21.4297 Q1.9844 21.4297 1.8281 21.3047 Q1.7188 21.1797 1.7188 21.0078 Q1.7188 20.8203 1.8281 20.6953 L5.2656 17.2578 Q5.3906 17.1484 5.5625 17.1484 Q5.75 17.1484 5.875 17.2578 Q6 17.3984 6 17.5703 Q6 17.7422 5.875 17.8828 ZM8.1406 18.4297 L8.1406 22.7109 Q8.1406 22.8984 8.0156 23.0234 Q7.9062 23.1484 7.7188 23.1484 Q7.5312 23.1484 7.4062 23.0234 Q7.2812 22.8984 7.2812 22.7109 L7.2812 18.4297 Q7.2812 18.2422 7.4062 18.1328 Q7.5312 18.0078 7.7188 18.0078 Q7.9062 18.0078 8.0156 18.1328 Q8.1406 18.2422 8.1406 18.4297 ZM5.0156 15.1328 Q5.1406 15.2422 5.1406 15.4297 Q5.1406 15.6172 5.0156 15.7422 Q4.9062 15.8516 4.7188 15.8516 L0.4219 15.8516 Q0.2344 15.8516 0.1094 15.7422 Q0 15.6172 0 15.4297 Q0 15.2422 0.1094 15.1328 Q0.2344 15.0078 0.4219 15.0078 L4.7188 15.0078 Q4.9062 15.0078 5.0156 15.1328 ZM22.0781 17.1484 Q22.0781 18.7578 20.9375 19.8672 L18.9688 21.8203 Q17.8594 22.9297 16.25 22.9297 Q14.625 22.9297 13.5156 21.7891 L9.0469 17.3047 Q8.7656 17.0234 8.4844 16.5547 L11.6719 16.3203 L15.3281 19.9766 Q15.7031 20.3516 16.25 20.3516 Q16.7969 20.3516 17.1562 19.9922 L19.125 18.0391 Q19.5 17.6641 19.5 17.1484 Q19.5 16.6016 19.125 16.2266 L15.4531 12.5547 L15.7031 9.3516 Q16.1719 9.6328 16.4531 9.9141 L20.9531 14.4141 Q22.0781 15.5703 22.0781 17.1484 ZM13.8125 7.4453 L10.6094 7.6953 L6.9531 4.0234 Q6.5781 3.6484 6.0469 3.6484 Q5.5156 3.6484 5.125 4.0078 L3.1562 5.9609 Q2.7812 6.3359 2.7812 6.8516 Q2.7812 7.3984 3.1562 7.7734 L6.8281 11.4453 L6.5938 14.6484 Q6.125 14.3672 5.8438 14.0859 L1.3438 9.5859 Q0.2188 8.4453 0.2188 6.8516 Q0.2188 5.2578 1.3594 4.1328 L3.3281 2.1797 Q4.4375 1.0703 6.0469 1.0703 Q7.6562 1.0703 8.7656 2.2109 L13.25 6.6953 Q13.5312 6.9766 13.8125 7.4453 ZM22.1562 8.2734 Q22.2812 8.3828 22.2812 8.5703 Q22.2812 8.7578 22.1562 8.8828 Q22.0469 9.0078 21.8594 9.0078 L17.5781 9.0078 Q17.3906 9.0078 17.2656 8.8828 Q17.1406 8.7578 17.1406 8.5703 Q17.1406 8.3828 17.2656 8.2734 Q17.3906 8.1484 17.5781 8.1484 L21.8594 8.1484 Q22.0469 8.1484 22.1562 8.2734 ZM15 1.2891 L15 5.5703 Q15 5.7578 14.875 5.8828 Q14.7656 6.0078 14.5781 6.0078 Q14.3906 6.0078 14.2656 5.8828 Q14.1406 5.7578 14.1406 5.5703 L14.1406 1.2891 Q14.1406 1.1016 14.2656 0.9766 Q14.3906 0.8516 14.5781 0.8516 Q14.7656 0.8516 14.875 0.9766 Q15 1.1016 15 1.2891 ZM20.4531 3.3047 L17.0156 6.7422 Q16.875 6.8516 16.7031 6.8516 Q16.5469 6.8516 16.4062 6.7422 Q16.2812 6.6016 16.2812 6.4297 Q16.2812 6.2578 16.4062 6.1172 L19.8281 2.6953 Q19.9688 2.5703 20.1406 2.5703 Q20.3125 2.5703 20.4531 2.6953 Q20.5781 2.8203 20.5781 3.0078 Q20.5781 3.1797 20.4531 3.3047 Z");
        disconnectFolderIcon.setScaleX(0.6);
        disconnectFolderIcon.setScaleY(0.6);
        disconnectFolderIcon.setFill(Color.valueOf("#074675"));
        SVGPath disconnectItemIcon = new SVGPath();
        disconnectItemIcon.setContent("M5.875 17.8828 L2.4531 21.3047 Q2.2969 21.4297 2.1406 21.4297 Q1.9844 21.4297 1.8281 21.3047 Q1.7188 21.1797 1.7188 21.0078 Q1.7188 20.8203 1.8281 20.6953 L5.2656 17.2578 Q5.3906 17.1484 5.5625 17.1484 Q5.75 17.1484 5.875 17.2578 Q6 17.3984 6 17.5703 Q6 17.7422 5.875 17.8828 ZM8.1406 18.4297 L8.1406 22.7109 Q8.1406 22.8984 8.0156 23.0234 Q7.9062 23.1484 7.7188 23.1484 Q7.5312 23.1484 7.4062 23.0234 Q7.2812 22.8984 7.2812 22.7109 L7.2812 18.4297 Q7.2812 18.2422 7.4062 18.1328 Q7.5312 18.0078 7.7188 18.0078 Q7.9062 18.0078 8.0156 18.1328 Q8.1406 18.2422 8.1406 18.4297 ZM5.0156 15.1328 Q5.1406 15.2422 5.1406 15.4297 Q5.1406 15.6172 5.0156 15.7422 Q4.9062 15.8516 4.7188 15.8516 L0.4219 15.8516 Q0.2344 15.8516 0.1094 15.7422 Q0 15.6172 0 15.4297 Q0 15.2422 0.1094 15.1328 Q0.2344 15.0078 0.4219 15.0078 L4.7188 15.0078 Q4.9062 15.0078 5.0156 15.1328 ZM22.0781 17.1484 Q22.0781 18.7578 20.9375 19.8672 L18.9688 21.8203 Q17.8594 22.9297 16.25 22.9297 Q14.625 22.9297 13.5156 21.7891 L9.0469 17.3047 Q8.7656 17.0234 8.4844 16.5547 L11.6719 16.3203 L15.3281 19.9766 Q15.7031 20.3516 16.25 20.3516 Q16.7969 20.3516 17.1562 19.9922 L19.125 18.0391 Q19.5 17.6641 19.5 17.1484 Q19.5 16.6016 19.125 16.2266 L15.4531 12.5547 L15.7031 9.3516 Q16.1719 9.6328 16.4531 9.9141 L20.9531 14.4141 Q22.0781 15.5703 22.0781 17.1484 ZM13.8125 7.4453 L10.6094 7.6953 L6.9531 4.0234 Q6.5781 3.6484 6.0469 3.6484 Q5.5156 3.6484 5.125 4.0078 L3.1562 5.9609 Q2.7812 6.3359 2.7812 6.8516 Q2.7812 7.3984 3.1562 7.7734 L6.8281 11.4453 L6.5938 14.6484 Q6.125 14.3672 5.8438 14.0859 L1.3438 9.5859 Q0.2188 8.4453 0.2188 6.8516 Q0.2188 5.2578 1.3594 4.1328 L3.3281 2.1797 Q4.4375 1.0703 6.0469 1.0703 Q7.6562 1.0703 8.7656 2.2109 L13.25 6.6953 Q13.5312 6.9766 13.8125 7.4453 ZM22.1562 8.2734 Q22.2812 8.3828 22.2812 8.5703 Q22.2812 8.7578 22.1562 8.8828 Q22.0469 9.0078 21.8594 9.0078 L17.5781 9.0078 Q17.3906 9.0078 17.2656 8.8828 Q17.1406 8.7578 17.1406 8.5703 Q17.1406 8.3828 17.2656 8.2734 Q17.3906 8.1484 17.5781 8.1484 L21.8594 8.1484 Q22.0469 8.1484 22.1562 8.2734 ZM15 1.2891 L15 5.5703 Q15 5.7578 14.875 5.8828 Q14.7656 6.0078 14.5781 6.0078 Q14.3906 6.0078 14.2656 5.8828 Q14.1406 5.7578 14.1406 5.5703 L14.1406 1.2891 Q14.1406 1.1016 14.2656 0.9766 Q14.3906 0.8516 14.5781 0.8516 Q14.7656 0.8516 14.875 0.9766 Q15 1.1016 15 1.2891 ZM20.4531 3.3047 L17.0156 6.7422 Q16.875 6.8516 16.7031 6.8516 Q16.5469 6.8516 16.4062 6.7422 Q16.2812 6.6016 16.2812 6.4297 Q16.2812 6.2578 16.4062 6.1172 L19.8281 2.6953 Q19.9688 2.5703 20.1406 2.5703 Q20.3125 2.5703 20.4531 2.6953 Q20.5781 2.8203 20.5781 3.0078 Q20.5781 3.1797 20.4531 3.3047 Z");
        disconnectItemIcon.setScaleX(0.6);
        disconnectItemIcon.setScaleY(0.6);
        disconnectItemIcon.setFill(Color.valueOf("#074675"));
        SVGPath renameItemIcon = new SVGPath();
        renameItemIcon.setContent("M11.0156 20.0156 L15 15.9844 L21 15.9844 L21 20.0156 L11.0156 20.0156 ZM6.1875 18 L14.8594 9.3281 L13.6406 8.1094 L5.0156 16.7812 L5.0156 18 L6.1875 18 ZM18.4219 5.8125 Q19.0312 6.4219 19.0312 7.2188 Q19.0312 8.0156 18.4219 8.625 L7.0312 20.0156 L3 20.0156 L3 15.9375 Q14.25 4.7344 14.3906 4.5938 Q15 3.9844 15.7969 3.9844 Q16.5938 3.9844 17.2031 4.5938 L18.4219 5.8125 Z");
        renameItemIcon.setScaleX(0.7);
        renameItemIcon.setScaleY(0.7);
        renameItemIcon.setFill(Color.valueOf("#074675"));
        SVGPath moveItemIcon = new SVGPath();
        moveItemIcon.setContent("M17.5156 10 Q19.0156 10 20.25 10.75 Q21.5 11.5 22.2344 12.7812 Q22.9844 14.0469 22.9844 15.5312 Q22.9844 17.0156 22.2344 18.2969 Q21.5 19.5625 20.25 20.2812 Q19.0156 21 17.5 21 Q15.9844 21 14.7344 20.2812 Q13.4844 19.5625 12.7344 18.2969 Q12 17.0156 12 15.5312 Q12 14.0469 12.7344 12.7812 Q13.4844 11.5 14.7344 10.75 Q15.9844 10 17.5156 10 ZM8.2031 3 Q8.9219 3 9.5 3.4375 L12 5.5 L19.7344 5.5 Q20.5938 5.5 21.2188 6.0469 Q21.8438 6.5938 21.9844 7.4688 L21.9844 7.6094 L21.9844 10.8281 Q21.3125 10.2031 20.5 9.7656 L20.5 7.75 Q20.5 7.4688 20.2969 7.2812 Q20.1094 7.0781 19.875 7.0312 L12 7.0312 L9.6406 9 Q9.125 9.4375 8.4062 9.5312 L3.5 9.5312 L3.5 16.7812 Q3.5 17.0625 3.6875 17.2656 Q3.8906 17.4531 4.125 17.5 L11.3281 17.5 Q11.5625 18.3125 12 19.0312 L4.2656 19.0312 Q3.3594 19.0312 2.7031 18.4062 Q2.0625 17.7812 2.0156 16.9219 L2.0156 5.25 Q2.0156 4.3906 2.6094 3.75 Q3.2188 3.0938 4.0781 3 L8.2031 3 ZM17.8125 12.5469 L17.7188 12.5938 L17.5625 12.75 Q17.375 13.0312 17.5625 13.3125 L19.2969 15 L13.9219 15 Q13.5781 15.0938 13.4844 15.4375 L13.4844 15.625 Q13.5781 15.9531 13.9219 16 L19.2969 16 L17.5625 17.7344 Q17.4688 17.875 17.4844 18.0781 Q17.5156 18.2656 17.6406 18.3906 Q17.7656 18.5 17.9531 18.5312 Q18.1406 18.5469 18.2812 18.4062 L20.9219 15.7656 L20.9688 15.5781 L20.9219 15.2344 L18.2812 12.5938 Q18.0469 12.4531 17.8125 12.5469 ZM8.2031 4.5312 L4.2656 4.5312 Q3.9844 4.5312 3.7656 4.7031 Q3.5469 4.875 3.5 5.1562 L3.5 7.9844 L8.2031 7.9844 Q8.4062 7.9844 8.5938 7.8906 L10.5625 6.2656 L8.6875 4.6719 Q8.5469 4.5312 8.2969 4.5312 L8.2031 4.5312 Z");
        moveItemIcon.setScaleX(0.7);
        moveItemIcon.setScaleY(0.7);
        moveItemIcon.setFill(Color.valueOf("#074675"));
        SVGPath addSystemLevleIcon = new SVGPath();
        addSystemLevleIcon.setContent("M23.2812 10.8047 L19.2031 10.8047 L19.2031 6.7266 Q19.2031 6.1953 18.875 6.1016 Q18.5469 6.0078 18 6.0078 Q17.4688 6.0078 17.1406 6.1016 Q16.8125 6.1953 16.8125 6.7266 L16.8125 10.8047 L12.7344 10.8047 Q12.1875 10.8047 12.0938 11.1328 Q12 11.4609 12 12.0078 Q12 12.5391 12.0938 12.8672 Q12.1875 13.1953 12.7344 13.1953 L16.8125 13.1953 L16.8125 17.2734 Q16.8125 17.8203 17.1406 17.9141 Q17.4688 18.0078 18 18.0078 Q18.5469 18.0078 18.875 17.9141 Q19.2031 17.8203 19.2031 17.2734 L19.2031 13.1953 L23.2812 13.1953 Q23.8125 13.1953 23.9062 12.8672 Q24 12.5391 24 12.0078 Q24 11.4609 23.9062 11.1328 Q23.8125 10.8047 23.2812 10.8047 L23.2812 10.8047 ZM8.8906 10.8047 L0.7344 10.8047 Q0.1875 10.8047 0.0938 11.1328 Q0 11.4609 0 12.0078 Q0 12.5391 0.0938 12.8672 Q0.1875 13.1953 0.7344 13.1953 L8.8906 13.1953 Q9.4219 13.1953 9.5156 12.8672 Q9.6094 12.5391 9.6094 12.0078 Q9.6094 11.4609 9.5156 11.1328 Q9.4219 10.8047 8.8906 10.8047 ZM8.8906 16.8047 L0.7344 16.8047 Q0.1875 16.8047 0.0938 17.1328 Q0 17.4609 0 18.0078 Q0 18.5391 0.0938 18.8672 Q0.1875 19.1953 0.7344 19.1953 L8.8906 19.1953 Q9.4219 19.1953 9.5156 18.8672 Q9.6094 18.5391 9.6094 18.0078 Q9.6094 17.4609 9.5156 17.1328 Q9.4219 16.8047 8.8906 16.8047 ZM8.8906 4.8047 L0.7344 4.8047 Q0.1875 4.8047 0.0938 5.1328 Q0 5.4609 0 6.0078 Q0 6.5391 0.0938 6.8672 Q0.1875 7.1953 0.7344 7.1953 L8.8906 7.1953 Q9.4219 7.1953 9.5156 6.8672 Q9.6094 6.5391 9.6094 6.0078 Q9.6094 5.4609 9.5156 5.1328 Q9.4219 4.8047 8.8906 4.8047 Z");
        addSystemLevleIcon.setScaleX(0.7);
        addSystemLevleIcon.setScaleY(0.7);
        addSystemLevleIcon.setFill(Color.valueOf("#074675"));
        SVGPath copyconnectItemIcon = new SVGPath();
        copyconnectItemIcon.setContent("M3.5 6.2656 L3.5 4.1094 Q2.8281 4.3438 2.4219 4.9531 Q2.0156 5.5469 2.0156 6.2656 L2.0156 16.7344 Q2.0156 17.6875 2.375 18.5781 Q2.7344 19.4688 3.4062 20.125 Q4.0781 20.7656 4.9375 21.125 Q5.8125 21.4844 6.7656 21.4844 L11.8125 21.4844 Q11.1875 20.8125 10.75 20 L6.7656 20 Q5.4219 20 4.4531 19.0625 Q3.5 18.125 3.5 16.7344 L3.5 6.2656 ZM18 10.6875 L18 3.7656 Q18 2.8125 17.3438 2.1719 Q16.7031 1.5156 15.75 1.5156 L6.7656 1.5156 Q5.8125 1.5156 5.1562 2.1719 Q4.5156 2.8125 4.5156 3.7656 L4.5156 16.7344 Q4.5156 17.6875 5.1562 18.3438 Q5.8125 18.9844 6.7656 18.9844 L10.3125 18.9844 Q10.0781 18.2656 10.0312 17.5 L6.7656 17.5 Q6.4375 17.5 6.2188 17.2812 Q6 17.0625 6 16.7344 L6 3.7656 Q6 3.4375 6.2188 3.2188 Q6.4375 3 6.7656 3 L15.75 3 Q16.0781 3 16.2969 3.2188 Q16.5156 3.4375 16.5156 3.7656 L16.5156 10.4844 Q17.2812 10.4844 18 10.6875 ZM16.5156 11.5 Q17.9531 11.5 19.25 12.25 Q20.5469 12.9844 21.2656 14.2656 Q21.9844 15.5312 21.9844 17 Q21.9844 18.4531 21.2656 19.7344 Q20.5469 21 19.25 21.75 Q17.9531 22.4844 16.4844 22.4844 Q15.0312 22.4844 13.75 21.75 Q12.4844 21 11.7344 19.7656 Q10.9844 18.5156 10.9844 17 Q10.9844 15.4844 11.7344 14.2344 Q12.4844 12.9844 13.75 12.25 Q15.0312 11.5 16.5156 11.5 ZM16.9844 20 L16.9844 17.5 L19.4844 17.5 Q19.7344 17.5 19.875 17.3594 Q20.0156 17.2188 20.0156 17 Q20.0156 16.7812 19.875 16.6406 Q19.7344 16.4844 19.4844 16.4844 L16.9844 16.4844 L16.9844 14 Q16.9844 13.7969 16.8438 13.6562 Q16.7031 13.5156 16.4844 13.5156 Q16.2656 13.5156 16.125 13.6562 Q15.9844 13.7969 15.9844 14 L15.9844 16.4844 L13.4844 16.4844 Q13.2969 16.4844 13.1562 16.6406 Q13.0156 16.7812 13.0156 17 Q13.0156 17.2188 13.1562 17.3594 Q13.2969 17.5 13.4844 17.5 L15.9844 17.5 L15.9844 20 Q15.9844 20.1875 16.125 20.3594 Q16.2656 20.5312 16.4844 20.5312 Q16.7031 20.5312 16.8438 20.3594 Q16.9844 20.1875 16.9844 20 Z");
        copyconnectItemIcon.setScaleX(0.7);
        copyconnectItemIcon.setScaleY(0.7);
        copyconnectItemIcon.setFill(Color.valueOf("#074675"));
        SVGPath modifyconnectItemIcon = new SVGPath();
        modifyconnectItemIcon.setContent("M2.0156 8.4297 Q2.0156 6.3672 3.4688 4.8984 Q4.9375 3.4297 7.0156 3.4297 L9.0312 3.4297 Q9.4062 3.4297 9.6875 3.7266 Q9.9844 4.0078 9.9844 4.4453 Q9.9844 4.8828 9.6875 5.1797 Q9.4062 5.4609 9.0312 5.4609 L7.0156 5.4609 Q5.7656 5.4609 4.875 6.3203 Q3.9844 7.1797 3.9844 8.4297 Q3.9844 9.6797 4.875 10.5703 Q5.7656 11.4609 7.0156 11.4609 L9.0312 11.4609 Q9.4062 11.4609 9.6875 11.7422 Q9.9844 12.0234 9.9844 12.4453 Q9.9844 12.8516 9.6875 13.1328 Q9.4062 13.4141 9.0312 13.4141 L7.0156 13.4141 Q4.9375 13.4141 3.4688 11.9609 Q2.0156 10.4922 2.0156 8.4297 ZM21.9844 8.4297 Q21.9844 7.4766 21.5938 6.5391 Q21.2188 5.6016 20.5156 4.9141 Q19.8281 4.2109 18.9062 3.8203 Q18 3.4297 16.9844 3.4297 L15.0312 3.4297 Q14.5938 3.4297 14.2969 3.7266 Q14.0156 4.0078 14.0156 4.4453 Q14.0156 4.8828 14.2969 5.1797 Q14.5938 5.4609 15.0312 5.4609 L16.9844 5.4609 Q18.2344 5.4609 19.125 6.3203 Q20.0156 7.1797 20.0156 8.4297 L20.0156 8.4766 Q21.125 8.5703 21.9375 9.2891 Q21.9844 8.8672 21.9844 8.4297 ZM17.4688 9.3359 Q17.6094 9.1953 17.7656 9.1016 Q18.1875 8.5703 17.8906 8.0234 Q17.6094 7.4766 16.9844 7.4141 L7.0156 7.4141 Q6.5781 7.4766 6.2812 7.7578 Q6 8.0391 6 8.4609 Q6 8.8672 6.2812 9.1484 Q6.5781 9.4297 7.0156 9.4297 L16.9844 9.4297 Q17.2344 9.4297 17.4688 9.3359 ZM21.3125 10.1016 Q20.6406 9.4297 19.7031 9.4297 Q18.7656 9.4297 18.0938 10.1016 L12.1875 16.0078 Q11.6562 16.5391 11.4688 17.2578 L11.0469 19.0859 Q10.8906 19.7109 11.3281 20.1484 Q11.7656 20.5703 12.3438 20.4297 L14.1562 19.9453 Q14.875 19.7578 15.4062 19.2266 L21.3125 13.3203 Q21.9844 12.6953 21.9844 11.7422 Q21.9844 10.7891 21.3125 10.1016 Z");
        modifyconnectItemIcon.setScaleX(0.7);
        modifyconnectItemIcon.setScaleY(0.7);
        modifyconnectItemIcon.setFill(Color.valueOf("#074675"));
        SVGPath createDatabaseItemIcon = new SVGPath();
        createDatabaseItemIcon.setContent("M9 2.5078 Q5.5781 2.5547 3.3281 3.6797 Q1.0781 4.8047 0.9844 6.4922 Q1.0781 8.2266 3.3281 9.3516 Q5.5781 10.4766 9 10.4766 Q12.4219 10.4766 14.6719 9.3516 Q16.9219 8.2266 17.0156 6.4922 Q16.9219 4.8047 14.6719 3.6797 Q12.4219 2.5547 9 2.5078 ZM0.9844 8.5078 L0.9844 11.5078 Q1.0781 13.1953 3.3281 14.3203 Q5.5781 15.4453 9 15.4453 Q12.4219 15.4453 14.6719 14.3203 Q16.9219 13.1953 17.0156 11.5078 L17.0156 8.5078 Q16.9219 10.1953 14.6719 11.3203 Q12.4219 12.4453 9 12.4453 Q5.5781 12.4453 3.3281 11.3203 Q1.0781 10.1953 0.9844 8.5078 ZM0.9844 13.5234 L0.9844 16.5234 Q1.0781 18.2109 3.3281 19.3359 Q5.5781 20.4609 9 20.5078 Q11.1562 20.5078 12.9844 19.9453 L12.9844 16.9453 Q11.1562 17.5078 9 17.5078 Q5.5781 17.4609 3.3281 16.3359 Q1.0781 15.2109 0.9844 13.5234 ZM18 13.5234 L18 16.5234 L15 16.5234 L15 18.4922 L18 18.4922 L18 21.4922 L20.0156 21.4922 L20.0156 18.4922 L23.0156 18.4922 L23.0156 16.5234 L20.0156 16.5234 L20.0156 13.5234 L18 13.5234 Z");
        createDatabaseItemIcon.setScaleX(0.7);
        createDatabaseItemIcon.setScaleY(0.7);
        createDatabaseItemIcon.setFill(Color.valueOf("#074675"));
        SVGPath setDefaultDatabaseItemIcon = new SVGPath();
        setDefaultDatabaseItemIcon.setContent("M13.5312 3.0938 Q14.2031 2.5156 15.0625 2.5156 Q15.9375 2.5156 16.6094 3.0938 L21.5 8.3281 Q22.2188 9.0469 22.0938 10.0781 Q21.9844 11.1094 21.125 11.7344 L16.0781 14.6094 Q15.8906 14.7031 15.7969 14.8594 L13.9688 19.4688 Q13.8281 19.8438 13.4688 19.9375 Q13.1094 20.0312 12.8125 19.7969 L9.5 16.4844 L4.5625 21.4844 L3.4531 21.4219 L3.4531 20.4219 L8.4531 15.4219 L5.2344 12.2188 Q4.9375 11.9688 4.9844 11.6094 Q5.0469 11.25 5.375 11.0625 L9.9844 9.1875 Q10.1719 9.1406 10.2656 8.9531 L13.1094 3.7188 Q13.2969 3.375 13.5312 3.0938 Z");
        setDefaultDatabaseItemIcon.setScaleX(0.6);
        setDefaultDatabaseItemIcon.setScaleY(0.6);
        setDefaultDatabaseItemIcon.setFill(Color.valueOf("#074675"));
        SVGPath connectFolderInfoItemIcon = new SVGPath();
        connectFolderInfoItemIcon.setContent("M10.5 7.125 Q10.5 6.6562 10.8281 6.3281 Q11.1562 6 11.625 6 L12.375 6 Q12.8438 6 13.1719 6.3281 Q13.5 6.6562 13.5 7.125 L13.5 7.875 Q13.5 8.3438 13.1719 8.6719 Q12.8438 9 12.375 9 L11.625 9 Q11.1562 9 10.8281 8.6719 Q10.5 8.3438 10.5 7.875 L10.5 7.125 ZM15 18 L9 18 L9 16.5 L10.5 16.5 L10.5 12 L9 12 L9 10.5 L13.5 10.5 L13.5 16.5 L15 16.5 L15 18 ZM12 0 Q9.5156 0 7.3281 0.9375 Q5.1406 1.875 3.5 3.5 Q1.875 5.125 0.9375 7.3281 Q0 9.5156 0 12 Q0 14.4844 0.9375 16.6719 Q1.875 18.8594 3.5 20.5 Q5.1406 22.125 7.3281 23.0625 Q9.5156 24 12 24 Q14.4844 24 16.6719 23.0625 Q18.875 22.125 20.5 20.5 Q22.125 18.8594 23.0625 16.6719 Q24 14.4844 24 12 Q24 9.5156 23.0625 7.3281 Q22.125 5.125 20.5 3.5 Q18.875 1.875 16.6719 0.9375 Q14.4844 0 12 0 ZM12 21.75 Q9.9844 21.75 8.2031 20.9844 Q6.4219 20.2188 5.0938 18.9062 Q3.7812 17.5781 3.0156 15.7969 Q2.25 14.0156 2.25 12 Q2.25 9.9844 3.0156 8.2031 Q3.7812 6.4219 5.0938 5.0938 Q6.4219 3.7656 8.2031 3.0156 Q9.9844 2.25 12 2.25 Q14.0156 2.25 15.7969 3.0156 Q17.5781 3.7656 18.9062 5.0938 Q20.2344 6.4219 20.9844 8.2031 Q21.75 9.9844 21.75 12 Q21.75 14.0156 20.9844 15.7969 Q20.2344 17.5781 18.9062 18.9062 Q17.5781 20.2188 15.7969 20.9844 Q14.0156 21.75 12 21.75 Z");
        connectFolderInfoItemIcon.setScaleX(0.55);
        connectFolderInfoItemIcon.setScaleY(0.55);
        connectFolderInfoItemIcon.setFill(Color.valueOf("#074675"));
        SVGPath connectOpenFileItemIcon = new SVGPath();
        connectOpenFileItemIcon.setContent("M12 9.7656 Q12.3125 9.7656 12.5156 9.9688 Q12.7188 10.1562 12.7188 10.4844 L12.7188 12.7188 L15.0469 12.7188 Q15.2812 12.7188 15.5156 12.9688 Q15.7656 13.2031 15.7656 13.5312 Q15.7656 13.8438 15.5156 14.0469 Q15.2812 14.2344 15.0469 14.2344 L12.7188 14.2344 L12.7188 16.4844 Q12.7188 16.7969 12.5156 17.0469 Q12.3125 17.2812 12 17.2812 Q11.6875 17.2812 11.4844 17.0469 Q11.2812 16.7969 11.2812 16.4844 L11.2812 14.2344 L9.0469 14.2344 Q8.7188 14.2344 8.4688 14.0469 Q8.2344 13.8438 8.2344 13.5312 Q8.2344 13.2031 8.4688 12.9688 Q8.7188 12.7188 9.0469 12.7188 L11.2812 12.7188 L11.2812 10.4844 Q11.2812 10.1562 11.4844 9.9688 Q11.6875 9.7656 12 9.7656 ZM21.0469 6.7188 L21.0469 20.9531 Q21.0469 22.2344 20.1562 23.125 Q19.2812 24 18 24 L6 24 Q4.7188 24 3.8281 23.125 Q2.9531 22.2344 2.9531 21.0469 L2.9531 2.9531 Q3.0469 1.7656 3.875 0.8906 Q4.7188 0 6 0 L14.2344 0 L21.0469 6.7188 ZM16.4844 6.7188 Q15.5938 6.7188 14.9062 6.0781 Q14.2344 5.4375 14.2344 4.4844 L14.2344 1.5156 L6 1.5156 Q5.3594 1.5156 4.9219 1.9688 Q4.4844 2.4062 4.4844 2.9531 L4.4844 20.9531 Q4.4844 21.5938 4.9219 22.0469 Q5.3594 22.4844 6 22.4844 L18 22.4844 Q18.6406 22.4844 19.0781 22.0469 Q19.5156 21.5938 19.5156 20.9531 L19.5156 6.7188 L16.4844 6.7188 Z");
        connectOpenFileItemIcon.setScaleX(0.65);
        connectOpenFileItemIcon.setScaleY(0.65);
        connectOpenFileItemIcon.setFill(Color.valueOf("#074675"));
        SVGPath databaseOpenFileItemIcon = new SVGPath();
        databaseOpenFileItemIcon.setContent("M12 9.7656 Q12.3125 9.7656 12.5156 9.9688 Q12.7188 10.1562 12.7188 10.4844 L12.7188 12.7188 L15.0469 12.7188 Q15.2812 12.7188 15.5156 12.9688 Q15.7656 13.2031 15.7656 13.5312 Q15.7656 13.8438 15.5156 14.0469 Q15.2812 14.2344 15.0469 14.2344 L12.7188 14.2344 L12.7188 16.4844 Q12.7188 16.7969 12.5156 17.0469 Q12.3125 17.2812 12 17.2812 Q11.6875 17.2812 11.4844 17.0469 Q11.2812 16.7969 11.2812 16.4844 L11.2812 14.2344 L9.0469 14.2344 Q8.7188 14.2344 8.4688 14.0469 Q8.2344 13.8438 8.2344 13.5312 Q8.2344 13.2031 8.4688 12.9688 Q8.7188 12.7188 9.0469 12.7188 L11.2812 12.7188 L11.2812 10.4844 Q11.2812 10.1562 11.4844 9.9688 Q11.6875 9.7656 12 9.7656 ZM21.0469 6.7188 L21.0469 20.9531 Q21.0469 22.2344 20.1562 23.125 Q19.2812 24 18 24 L6 24 Q4.7188 24 3.8281 23.125 Q2.9531 22.2344 2.9531 21.0469 L2.9531 2.9531 Q3.0469 1.7656 3.875 0.8906 Q4.7188 0 6 0 L14.2344 0 L21.0469 6.7188 ZM16.4844 6.7188 Q15.5938 6.7188 14.9062 6.0781 Q14.2344 5.4375 14.2344 4.4844 L14.2344 1.5156 L6 1.5156 Q5.3594 1.5156 4.9219 1.9688 Q4.4844 2.4062 4.4844 2.9531 L4.4844 20.9531 Q4.4844 21.5938 4.9219 22.0469 Q5.3594 22.4844 6 22.4844 L18 22.4844 Q18.6406 22.4844 19.0781 22.0469 Q19.5156 21.5938 19.5156 20.9531 L19.5156 6.7188 L16.4844 6.7188 Z");
        databaseOpenFileItemIcon.setScaleX(0.6);
        databaseOpenFileItemIcon.setScaleY(0.55);
        databaseOpenFileItemIcon.setFill(Color.valueOf("#074675"));
        SVGPath updateStatisticsItemIcon=new SVGPath();
        updateStatisticsItemIcon.setContent("M11.0156 8.8125 Q11.0156 8.4844 11.2188 8.2812 Q11.4375 8.0625 11.7344 8.0625 Q12.0469 8.0625 12.2812 8.2812 Q12.5156 8.4844 12.5156 8.7656 L12.5156 12.1875 L15.375 13.875 Q15.6562 14.0625 15.7188 14.375 Q15.7969 14.6719 15.625 14.9375 Q15.4688 15.1875 15.1562 15.2656 Q14.8594 15.3281 14.625 15.1875 L11.4844 13.3594 Q11.0156 13.0312 11.0156 12.4688 L11.0156 8.8125 ZM21 9.5625 Q21 9.75 20.8594 9.8906 Q20.7188 10.0312 20.4844 10.0312 L15.1875 10.0312 Q14.8594 10.0312 14.7344 9.7344 Q14.625 9.4219 14.8594 9.1875 L16.9688 7.0781 Q15.9844 6.1406 14.6875 5.6094 Q13.4062 5.0625 12 5.0625 Q10.0781 5.0625 8.4531 6.0312 Q6.8438 6.9844 5.9062 8.6094 Q4.9688 10.2188 4.9844 12.0938 Q5.0156 13.9688 5.9688 15.5469 Q6.9375 17.1094 8.5 18.0781 Q10.0781 19.0312 11.875 19.0625 Q13.6875 19.0781 15.2031 18.2656 Q16.7344 17.4375 17.7344 16.0312 Q18.75 14.625 18.9375 12.8906 Q18.9844 12.5625 19.2656 12.3125 Q19.5469 12.0469 19.9688 12.0469 Q20.3906 12.0469 20.6875 12.375 Q21 12.7031 20.9531 13.1719 Q20.625 15.2812 19.3281 17.0625 Q18.0469 18.8438 16.0938 19.9062 Q14.1562 20.9531 12 20.9531 Q9.5625 20.9531 7.5 19.7344 Q5.4375 18.5156 4.2188 16.4531 Q3 14.3906 3 11.9531 Q3 11.4844 3.0469 11.0156 Q3.2812 8.9531 4.4062 7.2188 Q5.5312 5.4844 7.3125 4.3906 Q9.0938 3.2812 11.1562 3.0938 Q11.5781 3.0469 12 3.0469 Q13.5469 3.0469 15.4219 3.8281 Q17.2969 4.5938 18.375 5.6719 L20.1562 3.8906 Q20.3906 3.6562 20.6875 3.7969 Q21 3.9375 21 4.2656 L21 9.5625 Z");
        updateStatisticsItemIcon.setScaleX(0.66);
        updateStatisticsItemIcon.setScaleY(0.66);
        updateStatisticsItemIcon.setFill(Color.valueOf("#074675"));
        SVGPath truncateItemIcon=new SVGPath();
        truncateItemIcon.setContent("M8.4375 4.3125 L8.25 4.3125 Q8.3281 4.3125 8.375 4.25 Q8.4375 4.1875 8.4375 4.125 L8.4375 4.3125 L15.5625 4.3125 L15.5625 4.125 Q15.5625 4.1875 15.625 4.25 Q15.6875 4.3125 15.75 4.3125 L15.5625 4.3125 L15.5625 6 L17.25 6 L17.25 4.125 Q17.25 3.5156 16.7969 3.0781 Q16.3594 2.625 15.75 2.625 L8.25 2.625 Q7.6406 2.625 7.1875 3.0781 Q6.75 3.5156 6.75 4.125 L6.75 6 L8.4375 6 L8.4375 4.3125 ZM20.25 6 L3.75 6 Q3.4531 6 3.2188 6.2188 Q3 6.4375 3 6.75 L3 7.5 Q3 7.5625 3.0625 7.625 Q3.125 7.6875 3.1875 7.6875 L4.5938 7.6875 L5.1875 19.9375 Q5.2031 20.5469 5.6406 20.9688 Q6.0781 21.375 6.6875 21.375 L17.3281 21.375 Q17.9375 21.375 18.3594 20.9688 Q18.7969 20.5469 18.8281 19.9375 L19.4062 7.6875 L20.8125 7.6875 Q20.8906 7.6875 20.9375 7.625 Q21 7.5625 21 7.5 L21 6.75 Q21 6.4375 20.7812 6.2188 Q20.5625 6 20.25 6 ZM17.1406 19.6875 L6.875 19.6875 L6.2812 7.6875 L17.7031 7.6875 L17.1406 19.6875 Z");
        truncateItemIcon.setScaleX(0.7);
        truncateItemIcon.setScaleY(0.7);
        truncateItemIcon.setFill(Color.valueOf("#074675"));
        SVGPath enableItemIcon=new SVGPath();
        enableItemIcon.setContent("M12 1.9922 Q9.9375 1.9922 8.1094 2.7891 Q6.2812 3.5703 4.9219 4.9297 Q3.5625 6.2891 2.7969 8.1172 Q2 9.9453 2 12.0078 Q2 14.0703 2.7969 15.8984 Q3.5625 17.7266 4.9219 19.0859 Q6.2812 20.4453 8.1094 21.2109 Q9.9375 22.0078 12 22.0078 Q14.0625 22.0078 15.8906 21.2109 Q17.7188 20.4453 19.0781 19.0859 Q20.4375 17.7266 21.2188 15.8984 Q22.0156 14.0703 22.0156 12.0078 Q22.0156 9.9453 21.2188 8.1172 Q20.4375 6.2891 19.0781 4.9297 Q17.7188 3.5703 15.8906 2.7891 Q14.0625 1.9922 12 1.9922 L12 1.9922 ZM12 19.9922 Q10.3438 19.9922 8.8906 19.3672 Q7.4375 18.7578 6.3438 17.6641 Q5.25 16.5703 4.6406 15.1172 Q4.0156 13.6641 4.0156 12.0078 Q4.0156 10.3359 4.6406 8.8828 Q5.25 7.4297 6.3438 6.3516 Q7.4375 5.2578 8.8906 4.6484 Q10.3438 4.0078 12 4.0078 Q13.6719 4.0078 15.125 4.6484 Q16.5781 5.2578 17.6562 6.3516 Q18.75 7.4297 19.3594 8.8828 Q20 10.3359 20 12.0078 Q20 13.6641 19.3594 15.1172 Q18.75 16.5703 17.6562 17.6641 Q16.5781 18.7578 15.125 19.3672 Q13.6719 19.9922 12 19.9922 ZM10.0156 13.6016 L7.7188 11.3047 L6.2812 12.7109 L10.0156 16.4141 L16.7188 9.7109 L15.3125 8.3047 L10.0156 13.6016 Z");
        enableItemIcon.setScaleX(0.7);
        enableItemIcon.setScaleY(0.7);
        enableItemIcon.setFill(Color.valueOf("#074675"));
        SVGPath disableItemIcon=new SVGPath();
        disableItemIcon.setContent("M205.2041,203.44006A107.94107,107.94107,0,0,0,52.56543,50.79309a11.93641,11.93641,0,0,0-1.772,1.772,107.94091,107.94091,0,0,0,152.647,152.63819,12.09058,12.09058,0,0,0,.92773-.83545A12.28919,12.28919,0,0,0,205.2041,203.44006Zm6.79688-75.43994a83.5591,83.5591,0,0,1-16.751,50.27881L77.72217,60.7511a83.95816,83.95816,0,0,1,134.27881,67.249Zm-168,0A83.5605,83.5605,0,0,1,60.75146,77.7218L178.2793,195.24963A83.95828,83.95828,0,0,1,44.001,128.00012Z");
        disableItemIcon.setScaleX(0.06);
        disableItemIcon.setScaleY(0.06);
        disableItemIcon.setFill(Color.valueOf("#074675"));
        SVGPath sqlHisItemIcon=new SVGPath();
        sqlHisItemIcon.setContent("M12.5156 4.5 Q9.3281 4.5469 7.1875 6.6875 Q5.0625 8.8125 5.0156 12 Q5.0625 15.1875 7.1875 17.2969 Q9.3281 19.4062 12.5156 19.5 Q15.7031 19.4062 17.8125 17.2969 Q19.9219 15.1875 20.0156 12 Q19.9219 8.8125 17.8125 6.6875 Q15.7031 4.5469 12.5156 4.5 ZM6.9844 9.4688 L9 9.4688 Q9.4219 9.5156 9.7031 9.7969 Q9.9844 10.0781 9.9844 10.5 L9.9844 11.4844 Q9.9844 11.8594 9.75 12.125 Q9.5156 12.375 9.1406 12.4688 L10.3125 14.4844 L9.1406 14.4844 L8.0156 12.4688 L8.0156 14.4844 L6.9844 14.4844 L6.9844 9.4688 ZM12 9.4688 L14.0156 9.4688 L14.0156 10.5 L12 10.5 L12 11.4844 L14.0156 11.4844 L14.0156 12.4688 L12 12.4688 L12 13.5 L14.0156 13.5 L14.0156 14.4844 L12 14.4844 Q11.5781 14.4844 11.2969 14.2031 Q11.0156 13.9219 11.0156 13.5 L11.0156 10.5 Q11.0156 10.0781 11.2969 9.7969 Q11.5781 9.5156 12 9.4688 ZM15.9844 9.4688 L18 9.4688 L18 10.5 L15.9844 10.5 L15.9844 13.5 L18 13.5 L18 14.4844 L15.9844 14.4844 Q15.5625 14.4844 15.2812 14.2031 Q15 13.9219 15 13.5 L15 10.5 Q15 10.0781 15.2812 9.7969 Q15.5625 9.5156 15.9844 9.4688 ZM8.0156 10.5 L8.0156 11.4844 L9 11.4844 L9 10.5 L8.0156 10.5 Z");
        sqlHisItemIcon.setScaleX(0.85);
        sqlHisItemIcon.setScaleY(0.85);
        sqlHisItemIcon.setFill(Color.valueOf("#074675"));
        SVGPath modifyToRawItemIcon=new SVGPath();
        modifyToRawItemIcon.setContent("M21.8906 6.75 L21.6562 12.75 L21.4531 16.1406 L21.1406 13.5 L20.625 9.3906 L19.125 9.3906 L18.6094 13.5 L18.3125 16.1406 L18.0938 12.75 L17.8594 6.75 L16.5 6.75 L17.25 17.25 L18.9688 17.25 L19.5312 13.5469 L19.875 10.5 L19.875 10.4688 L19.875 10.5 L20.2344 13.5469 L20.7969 17.25 L22.5 17.25 L23.25 6.75 L21.8906 6.75 L21.8906 6.75 ZM13.5 6.75 L10.5 6.75 Q9.875 6.75 9.4375 7.1875 Q9 7.6094 9 8.25 L9 8.25 L9 17.25 L10.5 17.25 L10.5 13.5 L13.5 13.5 L13.5 17.25 L15 17.25 L15 8.25 Q15 7.6094 14.5625 7.1875 Q14.1406 6.75 13.5 6.75 L13.5 6.75 ZM10.5 12 L10.5 8.25 L13.5 8.25 L13.5 12 L10.5 12 ZM7.5 11.25 L7.5 8.25 Q7.5 7.6094 7.0625 7.1875 Q6.6406 6.75 6 6.75 L6 6.75 L1.5 6.75 L1.5 17.25 L3 17.25 L3 12.75 L4.1094 12.75 L5.8594 17.25 L7.5 17.25 L5.7188 12.75 L6 12.75 Q6.6406 12.75 7.0625 12.3125 Q7.5 11.875 7.5 11.25 L7.5 11.25 ZM3 8.25 L6 8.25 L6 11.25 L3 11.25 L3 8.25 Z");
        modifyToRawItemIcon.setScaleX(0.6);
        modifyToRawItemIcon.setScaleY(0.6);
        modifyToRawItemIcon.setFill(Color.valueOf("#074675"));
        SVGPath modifyToStandardItemIcon=new SVGPath();
        modifyToStandardItemIcon.setContent("M290.5,3851 L287,3851 L287,3853 L291,3853 C292.105,3853 293,3852.104 293,3851 L293,3850 C293,3848.895 292.105,3848 291,3848 L289.5,3848 C289.224,3848 289,3847.776 289,3847.5 C289,3847.224 289.224,3847 289.5,3847 L291,3847 L293,3847 L293,3845 L291,3845 L289.605,3845 C288.166,3845 287,3846.166 287,3847.605 C287,3848.922 288.078,3850 289.395,3850 L290.5,3850 C290.776,3850 291,3850.224 291,3850.5 C291,3850.776 290.776,3851 290.5,3851 L290.5,3851 Z M299,3847.5 C299,3847.224 298.776,3847 298.5,3847 L297,3847 L297,3851 L298.5,3851 C298.775,3851 299,3850.775 299,3850.5 L299,3847.5 Z M299,3853 L295,3853 L295,3845 L299,3845 C300.105,3845 301,3845.895 301,3847 L301,3851 C301,3852.104 300.105,3853 299,3853 L299,3853 Z M284,3839 L284,3843 L286,3843 L286,3841 L302,3841 L302,3843 L304,3843 L304,3839 L284,3839 Z M302,3855 L304,3855 L304,3859 L284,3859 L284,3855 L286,3855 L286,3857 L302,3857 L302,3855 Z");
        modifyToStandardItemIcon.setScaleX(0.6);
        modifyToStandardItemIcon.setScaleY(0.6);
        modifyToStandardItemIcon.setFill(Color.valueOf("#074675"));
        SVGPath packageDDLItemIcon=new SVGPath();
        packageDDLItemIcon.setContent("M18 14.25 L18 5.25 L16.5 5.25 L16.5 15.75 L22.5 15.75 L22.5 14.25 L18 14.25 ZM13.5 5.25 L10.5 5.25 Q9.875 5.25 9.4375 5.6875 Q9 6.1094 9 6.75 L9 6.75 L9 14.25 Q9 14.875 9.4375 15.3125 Q9.875 15.75 10.5 15.75 L10.5 15.75 L11.25 15.75 L11.25 17.25 Q11.25 17.875 11.6875 18.3125 Q12.125 18.75 12.75 18.75 L12.75 18.75 L14.25 18.75 L14.25 17.25 L12.75 17.25 L12.75 15.75 L13.5 15.75 Q14.1406 15.75 14.5625 15.3125 Q15 14.875 15 14.25 L15 14.25 L15 6.75 Q15 6.1094 14.5625 5.6875 Q14.1406 5.25 13.5 5.25 L13.5 5.25 ZM10.5 14.25 L10.5 6.75 L13.5 6.75 L13.5 14.25 L10.5 14.25 ZM6 15.75 L1.5 15.75 L1.5 14.25 L6 14.25 L6 11.25 L3 11.25 Q2.375 11.25 1.9375 10.8125 Q1.5 10.375 1.5 9.75 L1.5 9.75 L1.5 6.75 Q1.5 6.1094 1.9375 5.6875 Q2.375 5.25 3 5.25 L3 5.25 L7.5 5.25 L7.5 6.75 L3 6.75 L3 9.75 L6 9.75 Q6.6406 9.75 7.0625 10.1875 Q7.5 10.6094 7.5 11.25 L7.5 11.25 L7.5 14.25 Q7.5 14.875 7.0625 15.3125 Q6.6406 15.75 6 15.75 L6 15.75 Z");
        packageDDLItemIcon.setScaleX(0.6);
        packageDDLItemIcon.setScaleY(0.6);
        packageDDLItemIcon.setFill(Color.valueOf("#074675"));
        SVGPath copyItemIcon = new SVGPath();
        copyItemIcon.setScaleX(0.65);
        copyItemIcon.setScaleY(0.65);
        copyItemIcon.setContent("M5.5156 4.6094 L5.5156 6.7656 L5.5156 17.2344 Q5.5156 18.625 6.4531 19.5625 Q7.3906 20.5 8.7344 20.5 L17.375 20.5 Q17.1406 21.1719 16.5312 21.5781 Q15.9375 21.9844 15.2656 21.9844 L8.7344 21.9844 Q7.8281 21.9844 6.9375 21.625 Q6.0469 21.2656 5.375 20.625 Q4.7031 19.9688 4.3438 19.0781 Q3.9844 18.1875 3.9844 17.2344 L3.9844 6.7656 Q3.9844 6 4.4062 5.4219 Q4.8438 4.8438 5.5156 4.6094 ZM17.7656 2.0156 Q18.6719 2.0156 19.3438 2.6719 Q20.0156 3.3125 20.0156 4.2656 L20.0156 17.2344 Q20.0156 18.1875 19.3438 18.8438 Q18.6719 19.4844 17.7656 19.4844 L8.7344 19.4844 Q7.8281 19.4844 7.1562 18.8438 Q6.4844 18.1875 6.4844 17.2344 L6.4844 4.2656 Q6.4844 3.3125 7.1562 2.6719 Q7.8281 2.0156 8.7344 2.0156 L17.7656 2.0156 ZM17.7656 3.5 L8.7344 3.5 Q8.4531 3.5 8.2344 3.7188 Q8.0156 3.9375 8.0156 4.2656 L8.0156 17.2344 Q8.0156 17.5625 8.2344 17.7812 Q8.4531 18 8.7344 18 L17.7656 18 Q18.0469 18 18.2656 17.7812 Q18.4844 17.5625 18.4844 17.2344 L18.4844 4.2656 Q18.4844 3.9375 18.2656 3.7188 Q18.0469 3.5 17.7656 3.5 Z");
        copyItemIcon.setFill(Color.valueOf("#074675"));
        SVGPath addUserIcon = new SVGPath();
        addUserIcon.setScaleX(0.55);
        addUserIcon.setScaleY(0.55);
        addUserIcon.setContent("M13.0625 10.4922 Q11.5625 11.9922 9.4219 11.9922 Q7.2969 11.9922 5.7812 10.4922 Q4.2812 8.9922 4.2812 6.8672 Q4.2812 4.7266 5.7812 3.2266 Q7.2969 1.7109 9.4219 1.7109 Q11.5625 1.7109 13.0625 3.2266 Q14.5781 4.7266 14.5781 6.8672 Q14.5781 8.9922 13.0625 10.4922 ZM22.2812 13.7109 L27 13.7109 Q27.1719 13.7109 27.2969 13.8359 Q27.4219 13.9609 27.4219 14.1484 L27.4219 16.7109 Q27.4219 16.8828 27.2969 17.0234 Q27.1719 17.1484 27 17.1484 L22.2812 17.1484 L22.2812 21.8516 Q22.2812 22.0234 22.1562 22.1484 Q22.0312 22.2891 21.8594 22.2891 L19.2812 22.2891 Q19.1094 22.2891 18.9844 22.1484 Q18.8594 22.0234 18.8594 21.8516 L18.8594 17.1484 L14.1406 17.1484 Q13.9688 17.1484 13.8438 17.0234 Q13.7188 16.8828 13.7188 16.7109 L13.7188 14.1484 Q13.7188 13.9609 13.8438 13.8359 Q13.9688 13.7109 14.1406 13.7109 L18.8594 13.7109 L18.8594 8.9922 Q18.8594 8.8203 18.9844 8.6953 Q19.1094 8.5703 19.2812 8.5703 L21.8594 8.5703 Q22.0312 8.5703 22.1562 8.6953 Q22.2812 8.8203 22.2812 8.9922 L22.2812 13.7109 ZM12.4219 16.7109 Q12.4219 17.4141 12.9375 17.9297 Q13.4531 18.4297 14.1406 18.4297 L17.5781 18.4297 L17.5781 21.6172 Q16.6562 22.2891 15.2812 22.2891 L3.5781 22.2891 Q1.9531 22.2891 0.9688 21.3516 Q0 20.4297 0 18.8203 Q0 18.1016 0.0469 17.4297 Q0.0938 16.7578 0.2344 15.9766 Q0.375 15.1797 0.5781 14.5234 Q0.7969 13.8516 1.1562 13.2109 Q1.5312 12.5703 2 12.1328 Q2.4688 11.6797 3.1406 11.4141 Q3.8125 11.1484 4.6406 11.1484 Q4.8906 11.1484 5.1562 11.3672 Q6.2188 12.1797 7.2188 12.6016 Q8.2344 13.0078 9.4219 13.0078 Q10.625 13.0078 11.625 12.6016 Q12.6406 12.1797 13.7031 11.3672 Q13.9688 11.1484 14.2188 11.1484 Q15.9844 11.1484 17.125 12.4297 L14.1406 12.4297 Q13.4531 12.4297 12.9375 12.9453 Q12.4219 13.4453 12.4219 14.1484 L12.4219 16.7109 Z");
        addUserIcon.setFill(Color.valueOf("#074675"));
        SVGPath modifyUserIcon = new SVGPath();
        modifyUserIcon.setScaleX(0.5);
        modifyUserIcon.setScaleY(0.5);
        modifyUserIcon.setContent("M14.7344 10.2465 Q12.9844 11.9965 10.5 11.9965 Q8.0156 11.9965 6.25 10.2465 Q4.5 8.4809 4.5 5.9965 Q4.5 3.5121 6.25 1.7621 Q8.0156 -0.0035 10.5 -0.0035 Q12.9844 -0.0035 14.7344 1.7621 Q16.5 3.5121 16.5 5.9965 Q16.5 8.4809 14.7344 10.2465 ZM14.7188 13.4965 Q17.4844 13.4965 19.4062 15.6527 L15.75 19.2621 L15.375 19.6371 L15.3281 20.1527 L15 23.0121 Q14.9531 23.4809 15.1406 23.9965 L2.25 23.9965 Q1.3125 23.9965 0.6562 23.3402 Q0 22.684 0 21.7465 L0 19.7777 Q0 17.1996 1.8438 15.3559 Q3.7031 13.4965 6.2812 13.4965 L7.0781 13.4965 Q8.7188 14.2465 10.5 14.2465 Q12.2812 14.2465 13.9219 13.4965 L14.7188 13.4965 ZM16.8281 20.2934 L23.2969 13.8715 L26.625 17.1996 L20.2031 23.6684 L17.3438 23.9965 Q16.9688 24.0434 16.7031 23.7777 Q16.4531 23.5277 16.5 23.1527 L16.8281 20.2934 ZM29.6719 12.6059 Q30 12.934 30 13.4027 Q30 13.8715 29.6719 14.1996 L27.7031 16.1684 L24.3281 12.7934 L24.5625 12.6059 L26.2969 10.8246 Q26.625 10.4965 27.0938 10.4965 Q27.5625 10.4965 27.8906 10.8246 L29.6719 12.6059 Z");
        modifyUserIcon.setFill(Color.valueOf("#074675"));
        SVGPath healthCheckItemIcon = new SVGPath();
        healthCheckItemIcon.setScaleX(0.65);
        healthCheckItemIcon.setScaleY(0.65);
        healthCheckItemIcon.setContent("M17.7656 5.8594 Q18 6.0938 17.7656 6.375 L7.9688 16.1719 Q7.8281 16.3125 7.6875 16.3125 L7.6875 16.3125 Q7.5469 16.3125 7.4062 16.1719 L3.6094 12.4219 Q3.4688 12.2812 3.4688 12.1406 Q3.4688 12 3.6094 11.8594 L5.6719 9.7969 Q5.9531 9.5156 6.2344 9.7969 L7.6875 11.25 L15.1406 3.75 Q15.2344 3.6562 15.4219 3.6562 Q15.6094 3.6562 15.7031 3.75 L17.7656 5.8594 ZM12.9844 12.8906 L15.375 10.4531 L15.375 19.125 Q15.375 19.5938 15 19.9688 Q14.625 20.3438 14.1562 20.3438 L14.1094 20.3438 L14.1094 20.3438 L1.2188 20.3438 L1.2188 20.3438 L1.2188 20.3438 Q0.75 20.3438 0.375 19.9688 Q0 19.5938 0 19.125 L0 6.1875 Q0 5.7188 0.375 5.3438 Q0.75 4.9688 1.2188 4.9688 L1.2656 4.9688 L12.2344 4.9688 L9.8438 7.3594 L2.3906 7.3594 L2.3906 17.9531 L12.9844 17.9531 L12.9844 12.8906 Z");
        healthCheckItemIcon.setFill(Color.valueOf("#074675"));
        SVGPath onlinelogItemIcon = new SVGPath();
        onlinelogItemIcon.setScaleX(0.5);
        onlinelogItemIcon.setScaleY(0.5);
        onlinelogItemIcon.setContent("M22.4844 14.9688 L3.75 15 Q3.4531 15 3.2188 15.2188 Q3 15.4375 3 15.7656 Q3 16.0781 3.2188 16.2969 Q3.4531 16.5 3.75 16.5 L13.5 16.5 L13.5 18 L3.75 18 Q3.4531 18 3.2188 18.2188 Q3 18.4375 3 18.75 Q3 19.0469 3.2188 19.2812 Q3.4531 19.5 3.75 19.5 L13.5 19.5 L13.5 23.9688 L3 23.9688 Q2.375 23.9688 1.9375 23.5469 Q1.5 23.1094 1.5 22.4688 L1.5 1.5 Q1.5 0.8594 1.9375 0.4375 Q2.375 0 3 0 L20.9844 0 Q21.6094 0 22.0469 0.4375 Q22.4844 0.8594 22.4844 1.5 L22.4844 14.9531 L22.4844 14.9688 ZM20.2344 3.0156 L3.75 3.0156 Q3.4531 3.0156 3.2188 3.2344 Q3 3.4375 3 3.7656 Q3 4.0781 3.2188 4.2969 Q3.4531 4.5156 3.75 4.5156 L20.2344 4.5156 Q20.5625 4.5156 20.7656 4.2969 Q20.9844 4.0781 20.9844 3.7656 Q20.9844 3.4375 20.7656 3.2344 Q20.5625 3.0156 20.2344 3.0156 ZM20.2344 6.0156 L3.75 6.0156 Q3.4531 6.0156 3.2188 6.2344 Q3 6.4375 3 6.7656 Q3 7.0781 3.2188 7.2969 Q3.4531 7.5156 3.75 7.5156 L20.2344 7.5156 Q20.5625 7.5156 20.7656 7.2969 Q20.9844 7.0781 20.9844 6.7656 Q20.9844 6.4375 20.7656 6.2344 Q20.5625 6.0156 20.2344 6.0156 ZM20.2344 9 L3.75 9 Q3.4531 9 3.2188 9.2188 Q3 9.4375 3 9.7656 Q3 10.0781 3.2188 10.2969 Q3.4531 10.5 3.75 10.5 L20.2344 10.5 Q20.5625 10.5 20.7656 10.2969 Q20.9844 10.0781 20.9844 9.7656 Q20.9844 9.4375 20.7656 9.2188 Q20.5625 9 20.2344 9 ZM20.2344 12 L3.75 12 Q3.4531 12 3.2188 12.2188 Q3 12.4375 3 12.7656 Q3 13.0781 3.2188 13.2969 Q3.4531 13.5 3.75 13.5 L20.2344 13.5 Q20.5625 13.5 20.7656 13.2969 Q20.9844 13.0781 20.9844 12.7656 Q20.9844 12.4375 20.7656 12.2188 Q20.5625 12 20.2344 12 ZM22.0312 17.5469 L16.0312 23.5781 Q15.6094 24 15 24 L15 16.4688 L22.4844 16.4688 Q22.4844 17.1094 22.0312 17.5469 Z");
        onlinelogItemIcon.setFill(Color.valueOf("#074675"));
        SVGPath spaceManagerItemIcon = new SVGPath();
        spaceManagerItemIcon.setScaleX(0.55);
        spaceManagerItemIcon.setScaleY(0.55);
        spaceManagerItemIcon.setContent("M2.0156 20.0156 L2.0156 15.9844 L21.9844 15.9844 L21.9844 20.0156 L2.0156 20.0156 ZM3.9844 17.0156 L3.9844 18.9844 L6 18.9844 L6 17.0156 L3.9844 17.0156 ZM2.0156 3.9844 L21.9844 3.9844 L21.9844 8.0156 L2.0156 8.0156 L2.0156 3.9844 ZM6 6.9844 L6 5.0156 L3.9844 5.0156 L3.9844 6.9844 L6 6.9844 ZM2.0156 14.0156 L2.0156 9.9844 L21.9844 9.9844 L21.9844 14.0156 L2.0156 14.0156 ZM3.9844 11.0156 L3.9844 12.9844 L6 12.9844 L6 11.0156 L3.9844 11.0156 Z");
        spaceManagerItemIcon.setFill(Color.valueOf("#074675"));
        SVGPath onconfigItemIcon = new SVGPath();
        onconfigItemIcon.setScaleX(0.55);
        onconfigItemIcon.setScaleY(0.55);
        onconfigItemIcon.setContent("M12.7031 14.4297 Q13.7188 13.4141 13.7188 12.0078 Q13.7188 10.5859 12.7031 9.5859 Q11.7031 8.5703 10.2812 8.5703 Q8.8594 8.5703 7.8594 9.5859 Q6.8594 10.5859 6.8594 12.0078 Q6.8594 13.4141 7.8594 14.4297 Q8.8594 15.4297 10.2812 15.4297 Q11.7031 15.4297 12.7031 14.4297 ZM20.5781 10.5391 L20.5781 13.5078 Q20.5781 13.6797 20.4688 13.8203 Q20.3594 13.9609 20.2031 13.9922 L17.7188 14.3672 Q17.4688 15.0859 17.2031 15.5859 Q17.6719 16.2578 18.625 17.4297 Q18.7656 17.6016 18.7656 17.7734 Q18.7656 17.9453 18.6406 18.0859 Q18.2812 18.5703 17.3125 19.5234 Q16.3594 20.4766 16.0625 20.4766 Q15.8906 20.4766 15.7031 20.3516 L13.8594 18.9141 Q13.2656 19.2109 12.6406 19.4141 Q12.4219 21.2422 12.25 21.9141 Q12.1562 22.2891 11.7656 22.2891 L8.7969 22.2891 Q8.6094 22.2891 8.4688 22.1641 Q8.3281 22.0547 8.3125 21.8828 L7.9375 19.4141 Q7.2812 19.2109 6.7344 18.9297 L4.8438 20.3516 Q4.7188 20.4766 4.5156 20.4766 Q4.3281 20.4766 4.1719 20.3359 Q2.4844 18.8047 1.9688 18.0859 Q1.875 17.9453 1.875 17.7734 Q1.875 17.6172 1.9844 17.4609 Q2.1875 17.1797 2.6562 16.5703 Q3.1406 15.9609 3.3906 15.6328 Q3.0312 14.9609 2.8438 14.3047 L0.3906 13.9453 Q0.2188 13.9141 0.1094 13.7734 Q0 13.6328 0 13.4609 L0 10.4922 Q0 10.3203 0.1094 10.1797 Q0.2188 10.0234 0.3594 10.0078 L2.8594 9.6328 Q3.0469 9.0078 3.375 8.3984 Q2.8438 7.6328 1.9375 6.5547 Q1.8125 6.3828 1.8125 6.2266 Q1.8125 6.0859 1.9219 5.9141 Q2.2812 5.4297 3.25 4.4766 Q4.2188 3.5234 4.5156 3.5234 Q4.6875 3.5234 4.8594 3.6484 L6.7031 5.0859 Q7.2969 4.7734 7.9219 4.5859 Q8.1406 2.7578 8.3125 2.0859 Q8.4062 1.7109 8.7969 1.7109 L11.7656 1.7109 Q11.9531 1.7109 12.0938 1.8359 Q12.2344 1.9453 12.25 2.1172 L12.625 4.5859 Q13.2812 4.7891 13.8281 5.0703 L15.7344 3.6484 Q15.8594 3.5234 16.0625 3.5234 Q16.2344 3.5234 16.3906 3.6484 Q18.125 5.2422 18.6094 5.9297 Q18.7031 6.0391 18.7031 6.2266 Q18.7031 6.3828 18.5938 6.5391 Q18.3906 6.8203 17.9062 7.4297 Q17.4219 8.0391 17.1875 8.3672 Q17.5312 9.0391 17.7344 9.6797 L20.1875 10.0547 Q20.3594 10.0859 20.4688 10.2266 Q20.5781 10.3672 20.5781 10.5391 Z");
        onconfigItemIcon.setFill(Color.valueOf("#074675"));
        SVGPath instanceStopItemIcon = new SVGPath();
        instanceStopItemIcon.setScaleX(0.65);
        instanceStopItemIcon.setScaleY(0.65);
        instanceStopItemIcon.setContent("M19.2031 6.0078 L19.2031 17.7734 Q19.2031 18.3516 18.7812 18.7734 Q18.3594 19.1953 17.7656 19.1953 L6 19.1953 Q5.5156 19.1953 5.1562 18.8516 Q4.8125 18.4922 4.8125 18.0078 L4.8125 6.2422 Q4.8125 5.6484 5.2344 5.2266 Q5.6562 4.8047 6.2344 4.8047 L18 4.8047 Q18.5 4.8047 18.8438 5.1641 Q19.2031 5.5078 19.2031 6.0078 L19.2031 6.0078 Z");
        instanceStopItemIcon.setFill(Color.valueOf("#9f453c"));
        MenuItem addUserItem = new  MenuItem("创建用户 ( Create User )",new Group(addUserIcon));
        MenuItem modifyUserItem = new  MenuItem("重置密码 ( Reset Password )",new Group(modifyUserIcon));
        MenuItem copyItem = new  MenuItem("复制名称 ( Copy Name )              Ctrl+C",new Group(copyItemIcon));
        MenuItem packageDDLItem=new MenuItem("查看DDL ( Show Package DDL )",new Group(packageDDLItemIcon));
        MenuItem modifyToRawItem=new MenuItem("改为裸表 ( Modify To Raw ) ",new Group(modifyToRawItemIcon));
        MenuItem modifyToStandardItem=new MenuItem("改为标准表 ( Modify To Standard )",new Group(modifyToStandardItemIcon));
        MenuItem sqlHisItem=new MenuItem("历史记录 ( SQL Executed His )",new Group(sqlHisItemIcon));
        MenuItem updateStatisticsItem=new MenuItem("统计更新 ( Update Statistics )",new Group(updateStatisticsItemIcon));
        MenuItem truncateItem=new MenuItem("清空 ( Truncate )",new Group(truncateItemIcon));
        MenuItem enableItem=new MenuItem("启用 ( Enabled )",new Group(enableItemIcon));
        MenuItem disableItem=new MenuItem("禁用 ( Disabled )",new Group(disableItemIcon));
        connectFolderInfoItem = new MenuItem("分类中连接信息 ( Connects Info )",new Group(connectFolderInfoItemIcon));
        MenuItem addSystemLevle = new MenuItem("新建连接分类 ( Add System Level )",new Group(addSystemLevleIcon));
        MenuItem createConnectItem = new MenuItem("新建连接 ( Create Connection )",new Group(createConnectItemIcon));
        MenuItem connectOpenFileItem = new MenuItem("新建SQL ( New SQL File )",new Group(connectOpenFileItemIcon));
        databaseOpenFileItem = new MenuItem("新建SQL ( New SQL File )",new Group(databaseOpenFileItemIcon));
        //MenuItem disconnectAll = new MenuItem("断开所有连接(Disconnect ALL)",disconnectItemIcon);
        MenuItem disconnectFolder = new MenuItem("断开此分类下连接 ( Disconnect )",new Group(disconnectFolderIcon));
        MenuItem renameItem = new MenuItem("重命名 ( Rename )",new Group(renameItemIcon));
        MenuItem deleteItem = new MenuItem("删除 ( Delete )",new Group(deleteItemIcon));
        MenuItem expandFolderItem = new MenuItem("默认展开 ( Expanded Default )",new Group(expandFolderItemIcon));
        MenuItem flodFolderItem = new MenuItem("默认折叠 ( Collapsed Default )",new Group(flodFolderItemIcon));
        MenuItem moveItem = new MenuItem("移动 ( Move To )",new Group(moveItemIcon));
        refreshItem = new MenuItem("刷新 ( Refresh )",new Group(refreshItemIcon));
        connectInfoItem = new MenuItem("实例信息 ( Instance Info )",new Group(connectInfoItemIcon));
        MenuItem connectItem = new MenuItem("连接 ( Connect )",new Group(connectItemIcon));
        MenuItem reconnectItem = new MenuItem("重连 ( Reconnect )",new Group(reconnectItemIcon));
        MenuItem disconnectItem = new MenuItem("断开连接 ( Disconnect )",new Group(disconnectItemIcon));
        MenuItem copyconnectItem = new MenuItem("复制连接 ( Copy Connection )",new Group(copyconnectItemIcon));
        MenuItem modifyconnectItem = new MenuItem("编辑 ( Modify Connection ) ",new Group(modifyconnectItemIcon));
        MenuItem createDatabaseItem = new MenuItem("新建数据库 ( Create Database )",new Group(createDatabaseItemIcon));
        MenuItem setDefaultDatabaseItem = new MenuItem("默认库 ( Set Default Database )",new Group(setDefaultDatabaseItemIcon));
        //setDefaultDatabaseItem.disableProperty().bind(trans_not_committed_buttons_hbox.visibleProperty());
        SeparatorMenuItem separator1 = new SeparatorMenuItem(); // 第一个分隔线
        SeparatorMenuItem separator2 = new SeparatorMenuItem(); // 第一个分隔线
        MenuItem healthCheckItem = new MenuItem("一键巡检 ( Health Check )",new Group(healthCheckItemIcon));
        MenuItem onlinelogItem = new MenuItem("运行日志 ( online.log )",new Group(onlinelogItemIcon));
        MenuItem spaceManagerItem = new MenuItem("容量管理 ( DBSpace Manager )",new Group(spaceManagerItemIcon));
        MenuItem onconfigItem = new MenuItem("参数管理 ( ONCONFIG )",new Group(onconfigItemIcon));
        MenuItem instanceStopItem = new MenuItem("实例启停 ( Start & Stop )",new Group(instanceStopItemIcon));


        //右键连接信息点击响应
        connectInfoItem.setOnAction(event->{
            TreeItem<TreeData> selectedItem = treeView.getSelectionModel().getSelectedItem();
            Connect connect=new Connect((Connect) selectedItem.getValue());
            TabpaneUtil.addCustomInstanceTab(connect,0);
        });


        healthCheckItem.setOnAction(event->{
            TreeItem<TreeData> selectedItem = treeView.getSelectionModel().getSelectedItem();
            Connect connect=new Connect((Connect) selectedItem.getValue());
            TabpaneUtil.addCustomInstanceTab(connect,1);
        });

        onlinelogItem.setOnAction(event->{
            TreeItem<TreeData> selectedItem = treeView.getSelectionModel().getSelectedItem();
            Connect connect=new Connect((Connect) selectedItem.getValue());
            TabpaneUtil.addCustomInstanceTab(connect,2);
        });

        spaceManagerItem.setOnAction(event->{
            TreeItem<TreeData> selectedItem = treeView.getSelectionModel().getSelectedItem();
            Connect connect=new Connect((Connect) selectedItem.getValue());
            TabpaneUtil.addCustomInstanceTab(connect,3);
        });
        onconfigItem.setOnAction(event->{
            TreeItem<TreeData> selectedItem = treeView.getSelectionModel().getSelectedItem();
            Connect connect=new Connect((Connect) selectedItem.getValue());
            TabpaneUtil.addCustomInstanceTab(connect,4);
        });

        instanceStopItem.setOnAction(event->{
            TreeItem<TreeData> selectedItem = treeView.getSelectionModel().getSelectedItem();
            Connect connect=new Connect((Connect) selectedItem.getValue());
            TabpaneUtil.addCustomInstanceTab(connect,5);
        });

        //点击鼠标后右键弹出框隐藏
        treeView.addEventFilter(MouseEvent.MOUSE_CLICKED, event -> {
            if (event.getButton().equals(MouseButton.PRIMARY) && event.getClickCount() == 1) {
                treeview_menu.hide();
            }
        });

        //加载进度
        Main.loadProgressBar.setProgress(0.8);




        treeView.setOnKeyPressed((KeyEvent event) -> {
            TreeItem<TreeData> selectedItem = treeView.getSelectionModel().getSelectedItem();
            if (event.getCode() == KeyCode.C && event.isControlDown()) {
                if(selectedItem.isLeaf()||selectedItem.getValue() instanceof DBPackage ||selectedItem.getValue() instanceof Database)
                    copyItem.fire();
            }
        });

        copyItem.setOnAction(event->{
            TreeItem<TreeData> selectedItem = treeView.getSelectionModel().getSelectedItem();
            Clipboard clipboard = Clipboard.getSystemClipboard();
            ClipboardContent content = new ClipboardContent();
            content.putString(selectedItem.getValue().getName());
            clipboard.setContent(content);
            //NotificationUtil.showNotification(Main.mainController.notice_pane, "对象名称已复制");
        });
        packageDDLItem.setOnAction(event-> {
            TreeItem<TreeData> selectedItem = treeView.getSelectionModel().getSelectedItem();
            TreeData connect = selectedItem.getValue();
            if (selectedItem.getChildren().size()==0&&!selectedItem.isExpanded()) {
                ((DBPackage)selectedItem.getValue()).setShowDDL(true);
                selectedItem.setExpanded(true);
                selectedItem.setExpanded(false);
            } else {
                PopupWindowUtil.openDDLWindow(((DBPackage)connect).getDDL());
            }
        });


        //右键弹出框及点击响应事件结束

        //改为裸表
        modifyToRawItem.setOnAction(event -> {
            TreeItem<TreeData> selectedItem = treeView.getSelectionModel().getSelectedItem();
            TreeData connect = selectedItem.getValue();
            Boolean confirm=AlterUtil.CustomAlertConfirm("改为裸表","确定将表\""+selectedItem.getValue().getName()+"\"更改为裸表吗？裸表具有更高的性能但不支持事务回滚，不建议在生产环境使用！");
            if(confirm){
                metaDBaccessService.executeBackgroundSql(selectedItem,"alter table "+connect.getName()+" type(raw)",null);
            }
        });

        //改为标准表
        modifyToStandardItem.setOnAction(event -> {
            TreeItem<TreeData> selectedItem = treeView.getSelectionModel().getSelectedItem();
            TreeData connect = selectedItem.getValue();
            Boolean confirm=AlterUtil.CustomAlertConfirm("改为标准表","确定将表\""+selectedItem.getValue().getName()+"\"更改为标准表吗？");
            if(confirm){
                metaDBaccessService.executeBackgroundSql(selectedItem,"alter table "+connect.getName()+" type(standard)",null);
            }
        });

        //清空表事件
        truncateItem.setOnAction(event -> {
            TreeItem<TreeData> selectedItem = treeView.getSelectionModel().getSelectedItem();
            TreeData connect = selectedItem.getValue();
            Boolean confirm=AlterUtil.CustomAlertConfirm("清空表","确定要清空表\""+selectedItem.getValue().getName()+"\"吗？");
            if(confirm){
                metaDBaccessService.executeBackgroundSql(selectedItem,"truncate table "+connect.getName(),null);
            }
        });


        //禁用
        disableItem.setOnAction(event -> {
            TreeItem<TreeData> selectedItem = treeView.getSelectionModel().getSelectedItem();
            TreeData connect = selectedItem.getValue();
            if(connect instanceof Index) {//索引
                Boolean confirm=AlterUtil.CustomAlertConfirm("禁用索引","确定要禁用索引\""+selectedItem.getValue().getName()+"\"吗？索引禁用后启用需要自动重建耗费较长时间！");
                if(confirm){
                    metaDBaccessService.executeBackgroundSql(selectedItem,"set indexes "+connect.getName()+" disabled",null);
                }
            }
            if(connect instanceof Trigger) {//触发器
                Boolean confirm=AlterUtil.CustomAlertConfirm("禁用触发器","确定要禁用触发器\""+selectedItem.getValue().getName()+"\"吗？");
                if(confirm){
                    metaDBaccessService.executeBackgroundSql(selectedItem,"set triggers "+connect.getName()+" disabled",null);
                }
            }
        });

        //启用
        enableItem.setOnAction(event -> {
            TreeItem<TreeData> selectedItem = treeView.getSelectionModel().getSelectedItem();
            TreeData connect = selectedItem.getValue();
            if(connect instanceof Index) {//索引
                Boolean confirm=AlterUtil.CustomAlertConfirm("启用索引","确定要启用索引\""+selectedItem.getValue().getName()+"\"吗？启用索引可能会较长时间锁表！");
                if(confirm){
                    metaDBaccessService.executeBackgroundSql(selectedItem,"set indexes "+connect.getName()+" enabled",null);
                }
            }
            if(connect instanceof Trigger) {//触发器
                Boolean confirm=AlterUtil.CustomAlertConfirm("启用触发器","确定要启用触发器\""+selectedItem.getValue().getName()+"\"吗？");
                if(confirm){
                    metaDBaccessService.executeBackgroundSql(selectedItem,"set triggers "+connect.getName()+" enabled",null);
                }
            }
        });

        sqlHisItem.setOnAction(event->{
            TreeItem<TreeData> selectedItem = treeView.getSelectionModel().getSelectedItem();
            PopupWindowUtil.openSqlHistoryPopupWindow(((Connect)selectedItem.getValue()).getId());
        });


        connectFolderInfoItem.setOnAction(event->{
            TreeItem<TreeData> selectedItem = treeView.getSelectionModel().getSelectedItem();
            TabpaneUtil.addConnectsInfoTab((ConnectFolder)selectedItem.getValue());

        });
        /*
        connectOpenFileItem.setOnAction(event->{
            TreeItem<TreeData> selectedItem = databasemeta_treeview.getSelectionModel().getSelectedItem();
            ComstomTabUtil.addCustomSqlTab(sql_tabpane,selectedItem.getValue());
        });
    */
        databaseOpenFileItem.setOnAction(event->{
            TreeItem<TreeData> selectedItem = treeView.getSelectionModel().getSelectedItem();
            Connect connect=new Connect(MetadataTreeviewUtil.getMetaConnect(selectedItem));
            Database database=MetadataTreeviewUtil.getCurrentDatabase(selectedItem);
            connect.setProps(metaDBaccessService.modifyProps(connect,database.getDbLocale()));
            connect.setDatabase(database.getName());
            TabpaneUtil.addCustomSqlTab(connect);
        });




        //右键连接点击响应
        connectItem.setOnAction(event->{
            TreeItem<TreeData> selectedItem = treeView.getSelectionModel().getSelectedItem();
            selectedItem.getChildren().clear();
            selectedItem.setExpanded(false);
            selectedItem.setExpanded(true);
        });
        //右键重连点击响应
        reconnectItem.setOnAction(event -> {
            TreeItem<TreeData> selectedItem = treeView.getSelectionModel().getSelectedItem();
            MetadataTreeviewUtil.reconnectItem(selectedItem);
        });
        //右键断开连接点击响应
        disconnectItem.setOnAction(event -> {
            TreeItem<TreeData> selectedItem = treeView.getSelectionModel().getSelectedItem();
            disconnectItem(selectedItem);
        });



        //断开分类下所有连接
        disconnectFolder.setOnAction(event -> {
            TreeItem<TreeData> selectedItem = treeView.getSelectionModel().getSelectedItem();
            MetadataTreeviewUtil.disconnectFolder(selectedItem);
        });


        //右键新建连接点击响应
        createConnectItem.setOnAction(event -> {
            TreeItem<TreeData> selectedItem = treeView.getSelectionModel().getSelectedItem();
            TreeData connect= selectedItem.getValue();
            showCreateConnectDialog(connect,false);
        });

        //右键编辑点击响应
        modifyconnectItem.setOnAction(event -> {
            TreeItem<TreeData> selectedItem = treeView.getSelectionModel().getSelectedItem();
            Connect connect=(Connect)selectedItem.getValue();
            showCreateConnectDialog(connect,false);
        });

        //右键复制连接点击响应
        copyconnectItem.setOnAction(event -> {
            TreeItem<TreeData> selectedItem = treeView.getSelectionModel().getSelectedItem();
            Connect connect=new Connect((Connect) selectedItem.getValue());
            connect.setConn(null);
            connect.setName(SqliteDBaccessUtil.getCopyName(connect));
            showCreateConnectDialog(connect,true);
            //String result=SqliteDBaccessUtil.createConnect(connect);
            //--------/*

        });


        //右键重命名点击响应
        renameItem.setOnAction(event -> {
            MetadataTreeviewUtil.renameTreeItem(treeView);
        });

        //创建用户
        addUserItem.setOnAction(event -> {
            TreeItem<TreeData> selectedItem = treeView.getSelectionModel().getSelectedItem();
            Dialog<ButtonType> dialog=new Dialog<>();
            dialog.setTitle("创建用户");
            dialog.getDialogPane().getButtonTypes().addAll(ButtonType.FINISH, ButtonType.CANCEL);
            Button commit = (Button) dialog.getDialogPane().lookupButton(ButtonType.FINISH);
            Button cancelBtn = (Button) dialog.getDialogPane().lookupButton(ButtonType.CANCEL);
            commit.setText("创建");
            cancelBtn.setText("取消");
            dialog.initOwner(Main.scene.getWindow());


            GridPane grid = new GridPane();
            grid.setHgap(10);
            grid.setVgap(5);
            grid.setPadding(new Insets(10));
            CustomUserTextField userName = new CustomUserTextField();
            CustomPasswordField passwordField1 = new CustomPasswordField();
            CustomPasswordField passwordField2 = new CustomPasswordField();
            userName.requestFocus();
            Label nameLabel=new Label("用户名") ;
            SVGPath nameLabelIcon=new SVGPath();
            nameLabelIcon.setContent("M7.5 6.9922 Q7.5 8.8672 8.8281 10.1797 Q10.1562 11.4922 12 11.4922 Q13.8594 11.4922 15.1719 10.1797 Q16.5 8.8672 16.5 6.9922 Q16.5 5.1484 15.1719 3.8203 Q13.8594 2.4922 12 2.4922 Q10.1562 2.4922 8.8281 3.8203 Q7.5 5.1484 7.5 6.9922 ZM20 21.5078 L21 21.5078 L21 20.4922 Q21 19.0703 20.4375 17.7734 Q19.9062 16.5078 18.9531 15.5703 Q18 14.6172 16.7188 14.0547 Q15.4531 13.5078 14 13.5078 L10.0156 13.5078 Q8.5625 13.5078 7.2969 14.0547 Q6 14.6172 5.0469 15.5703 Q4.1094 16.5078 3.5625 17.7734 Q3 19.0703 3 20.4922 L3 21.5078 L20 21.5078 L20 21.5078 Z");
            nameLabelIcon.setScaleX(0.55);
            nameLabelIcon.setScaleY(0.55);
            nameLabelIcon.setFill(Color.valueOf("#888"));
            nameLabel.setGraphic(nameLabelIcon);

            Label passwordLabel=new Label("密码");

            SVGPath passwordLabelIcon=new SVGPath();
            passwordLabelIcon.setContent("M15.75 1.5 Q14.3438 1.5 13.125 2.0312 Q11.8906 2.5469 10.9688 3.4688 Q10.0625 4.375 9.5469 5.625 Q9 6.8438 9 8.25 L9 8.25 Q9 8.25 9 8.25 Q9 8.25 9 8.25 Q9 8.7812 9.0781 9.2812 Q9.1719 9.7656 9.3125 10.2656 L9.2812 10.2188 L1.5 18 L1.5 22.5 L6 22.5 L13.7812 14.7188 Q14.2344 14.8594 14.7344 14.9375 Q15.2344 15 15.7812 15 Q17.1094 15 18.2812 14.5312 Q19.4531 14.0312 20.3594 13.2031 Q21.2656 12.375 21.8281 11.25 Q22.3906 10.125 22.5 8.8281 L22.5 8.8125 Q22.5312 8.6719 22.5312 8.5156 Q22.5312 8.3438 22.5312 8.1719 Q22.5312 7.0938 22.1875 6.1094 Q21.8438 5.1094 21.2656 4.2812 L21.2656 4.3125 Q20.3438 3.0156 18.9062 2.2656 Q17.4688 1.5 15.7969 1.5 Q15.7812 1.5 15.7656 1.5 Q15.75 1.5 15.75 1.5 L15.75 1.5 L15.75 1.5 ZM15.75 13.5 Q15.3594 13.5 14.9688 13.4375 Q14.5781 13.375 14.2031 13.2656 L14.25 13.2656 L13.3906 13 L10.3594 16.0312 L9.3125 15 L8.25 16.0469 L9.2812 17.0781 L8.0938 18.2812 L7.0625 17.25 L6 18.2969 L7.0312 19.3281 L5.375 21 L3 21 L3 18.625 L11 10.6094 L10.7812 9.8906 Q10.6406 9.5312 10.5781 9.125 Q10.5312 8.7188 10.5312 8.2656 Q10.5312 6.75 11.2812 5.5156 Q12.0469 4.2656 13.2969 3.5781 L13.3125 3.5625 Q13.8594 3.2812 14.4688 3.125 Q15.0938 2.9688 15.75 2.9688 Q16.8281 2.9688 17.7656 3.375 Q18.7031 3.7656 19.4062 4.4688 Q20.1094 5.1562 20.5625 6.0625 Q20.9844 7 21 8.0625 L21 8.0625 Q21 8.125 21 8.1875 Q21 8.25 21 8.3125 Q21 9.0938 20.7812 9.7969 Q20.5781 10.5 20.1875 11.0781 L20.1875 11.0625 Q19.4844 12.1562 18.3125 12.8281 Q17.1406 13.5 15.75 13.5 Q15.75 13.5 15.75 13.5 Q15.75 13.5 15.75 13.5 L15.75 13.5 L15.75 13.5 ZM18 7.5 Q18 8.125 17.5625 8.5625 Q17.1406 9 16.5 9 Q15.875 9 15.4375 8.5625 Q15 8.125 15 7.5 Q15 6.8594 15.4375 6.4375 Q15.875 6 16.5 6 Q17.1406 6 17.5625 6.4375 Q18 6.8594 18 7.5 Z");
            passwordLabelIcon.setScaleX(0.5);
            passwordLabelIcon.setScaleY(0.5);
            passwordLabelIcon.setFill(Color.valueOf("#888"));
            passwordLabel.setGraphic(passwordLabelIcon);

            Label confirmPasswordLabel=new Label("确认密码");

            SVGPath confirmPasswordLabelIcon=new SVGPath();
            confirmPasswordLabelIcon.setContent("M15.75 1.5 Q14.3438 1.5 13.125 2.0312 Q11.8906 2.5469 10.9688 3.4688 Q10.0625 4.375 9.5469 5.625 Q9 6.8438 9 8.25 L9 8.25 Q9 8.25 9 8.25 Q9 8.25 9 8.25 Q9 8.7812 9.0781 9.2812 Q9.1719 9.7656 9.3125 10.2656 L9.2812 10.2188 L1.5 18 L1.5 22.5 L6 22.5 L13.7812 14.7188 Q14.2344 14.8594 14.7344 14.9375 Q15.2344 15 15.7812 15 Q17.1094 15 18.2812 14.5312 Q19.4531 14.0312 20.3594 13.2031 Q21.2656 12.375 21.8281 11.25 Q22.3906 10.125 22.5 8.8281 L22.5 8.8125 Q22.5312 8.6719 22.5312 8.5156 Q22.5312 8.3438 22.5312 8.1719 Q22.5312 7.0938 22.1875 6.1094 Q21.8438 5.1094 21.2656 4.2812 L21.2656 4.3125 Q20.3438 3.0156 18.9062 2.2656 Q17.4688 1.5 15.7969 1.5 Q15.7812 1.5 15.7656 1.5 Q15.75 1.5 15.75 1.5 L15.75 1.5 L15.75 1.5 ZM15.75 13.5 Q15.3594 13.5 14.9688 13.4375 Q14.5781 13.375 14.2031 13.2656 L14.25 13.2656 L13.3906 13 L10.3594 16.0312 L9.3125 15 L8.25 16.0469 L9.2812 17.0781 L8.0938 18.2812 L7.0625 17.25 L6 18.2969 L7.0312 19.3281 L5.375 21 L3 21 L3 18.625 L11 10.6094 L10.7812 9.8906 Q10.6406 9.5312 10.5781 9.125 Q10.5312 8.7188 10.5312 8.2656 Q10.5312 6.75 11.2812 5.5156 Q12.0469 4.2656 13.2969 3.5781 L13.3125 3.5625 Q13.8594 3.2812 14.4688 3.125 Q15.0938 2.9688 15.75 2.9688 Q16.8281 2.9688 17.7656 3.375 Q18.7031 3.7656 19.4062 4.4688 Q20.1094 5.1562 20.5625 6.0625 Q20.9844 7 21 8.0625 L21 8.0625 Q21 8.125 21 8.1875 Q21 8.25 21 8.3125 Q21 9.0938 20.7812 9.7969 Q20.5781 10.5 20.1875 11.0781 L20.1875 11.0625 Q19.4844 12.1562 18.3125 12.8281 Q17.1406 13.5 15.75 13.5 Q15.75 13.5 15.75 13.5 Q15.75 13.5 15.75 13.5 L15.75 13.5 L15.75 13.5 ZM18 7.5 Q18 8.125 17.5625 8.5625 Q17.1406 9 16.5 9 Q15.875 9 15.4375 8.5625 Q15 8.125 15 7.5 Q15 6.8594 15.4375 6.4375 Q15.875 6 16.5 6 Q17.1406 6 17.5625 6.4375 Q18 6.8594 18 7.5 Z");
            confirmPasswordLabelIcon.setScaleX(0.5);
            confirmPasswordLabelIcon.setScaleY(0.5);
            confirmPasswordLabelIcon.setFill(Color.valueOf("#888"));
            confirmPasswordLabel.setGraphic(confirmPasswordLabelIcon);

            grid.add(nameLabel, 0, 0);
            grid.add(userName, 1, 0);
            grid.add(passwordLabel, 0, 1);
            grid.add(passwordField1, 1, 1);
            grid.add(confirmPasswordLabel, 0, 2);
            grid.add(passwordField2, 1, 2);
            dialog.getDialogPane().setContent(grid);


            commit.addEventFilter(ActionEvent.ACTION, event1 -> {
                if (userName.getText().trim().isEmpty()) {
                    userName.requestFocus();
                    event1.consume();
                } else if (passwordField1.getText().trim().isEmpty()) {
                    passwordField1.requestFocus();
                    event1.consume();
                } else if (passwordField2.getText().trim().isEmpty()) {
                    passwordField2.requestFocus();
                    event1.consume();
                } else if (!passwordField1.getText().trim().equals(passwordField2.getText().trim())) {
                    AlterUtil.CustomAlert("错误", "两次密码输入不一致！");
                    event1.consume();
                } else {
                    metaDBaccessService.executeBackgroundSql(selectedItem, "create user " + userName.getText().trim() + " with password '" + passwordField1.getText().trim() + "'", null);
                }

            });

            dialog.showAndWait();

        });

        //创建用户
        modifyUserItem.setOnAction(event -> {
            TreeItem<TreeData> selectedItem = treeView.getSelectionModel().getSelectedItem();
            Dialog<ButtonType> dialog=new Dialog<>();
            dialog.setTitle("重置密码");
            dialog.getDialogPane().getButtonTypes().addAll(ButtonType.FINISH, ButtonType.CANCEL);
            Button commit = (Button) dialog.getDialogPane().lookupButton(ButtonType.FINISH);
            Button cancelBtn = (Button) dialog.getDialogPane().lookupButton(ButtonType.CANCEL);
            commit.setText("重置");
            cancelBtn.setText("取消");
            dialog.initOwner(Main.scene.getWindow());


            GridPane grid = new GridPane();
            grid.setHgap(10);
            grid.setVgap(5);
            grid.setPadding(new Insets(10));
            CustomUserTextField userName = new CustomUserTextField();
            CustomPasswordField passwordField1 = new CustomPasswordField();
            CustomPasswordField passwordField2 = new CustomPasswordField();


            Label passwordLabel=new Label("新密码");

            SVGPath passwordLabelIcon=new SVGPath();
            passwordLabelIcon.setContent("M15.75 1.5 Q14.3438 1.5 13.125 2.0312 Q11.8906 2.5469 10.9688 3.4688 Q10.0625 4.375 9.5469 5.625 Q9 6.8438 9 8.25 L9 8.25 Q9 8.25 9 8.25 Q9 8.25 9 8.25 Q9 8.7812 9.0781 9.2812 Q9.1719 9.7656 9.3125 10.2656 L9.2812 10.2188 L1.5 18 L1.5 22.5 L6 22.5 L13.7812 14.7188 Q14.2344 14.8594 14.7344 14.9375 Q15.2344 15 15.7812 15 Q17.1094 15 18.2812 14.5312 Q19.4531 14.0312 20.3594 13.2031 Q21.2656 12.375 21.8281 11.25 Q22.3906 10.125 22.5 8.8281 L22.5 8.8125 Q22.5312 8.6719 22.5312 8.5156 Q22.5312 8.3438 22.5312 8.1719 Q22.5312 7.0938 22.1875 6.1094 Q21.8438 5.1094 21.2656 4.2812 L21.2656 4.3125 Q20.3438 3.0156 18.9062 2.2656 Q17.4688 1.5 15.7969 1.5 Q15.7812 1.5 15.7656 1.5 Q15.75 1.5 15.75 1.5 L15.75 1.5 L15.75 1.5 ZM15.75 13.5 Q15.3594 13.5 14.9688 13.4375 Q14.5781 13.375 14.2031 13.2656 L14.25 13.2656 L13.3906 13 L10.3594 16.0312 L9.3125 15 L8.25 16.0469 L9.2812 17.0781 L8.0938 18.2812 L7.0625 17.25 L6 18.2969 L7.0312 19.3281 L5.375 21 L3 21 L3 18.625 L11 10.6094 L10.7812 9.8906 Q10.6406 9.5312 10.5781 9.125 Q10.5312 8.7188 10.5312 8.2656 Q10.5312 6.75 11.2812 5.5156 Q12.0469 4.2656 13.2969 3.5781 L13.3125 3.5625 Q13.8594 3.2812 14.4688 3.125 Q15.0938 2.9688 15.75 2.9688 Q16.8281 2.9688 17.7656 3.375 Q18.7031 3.7656 19.4062 4.4688 Q20.1094 5.1562 20.5625 6.0625 Q20.9844 7 21 8.0625 L21 8.0625 Q21 8.125 21 8.1875 Q21 8.25 21 8.3125 Q21 9.0938 20.7812 9.7969 Q20.5781 10.5 20.1875 11.0781 L20.1875 11.0625 Q19.4844 12.1562 18.3125 12.8281 Q17.1406 13.5 15.75 13.5 Q15.75 13.5 15.75 13.5 Q15.75 13.5 15.75 13.5 L15.75 13.5 L15.75 13.5 ZM18 7.5 Q18 8.125 17.5625 8.5625 Q17.1406 9 16.5 9 Q15.875 9 15.4375 8.5625 Q15 8.125 15 7.5 Q15 6.8594 15.4375 6.4375 Q15.875 6 16.5 6 Q17.1406 6 17.5625 6.4375 Q18 6.8594 18 7.5 Z");
            passwordLabelIcon.setScaleX(0.5);
            passwordLabelIcon.setScaleY(0.5);
            passwordLabelIcon.setFill(Color.valueOf("#888"));
            passwordLabel.setGraphic(passwordLabelIcon);

            Label confirmPasswordLabel=new Label("确认密码");

            SVGPath confirmPasswordLabelIcon=new SVGPath();
            confirmPasswordLabelIcon.setContent("M15.75 1.5 Q14.3438 1.5 13.125 2.0312 Q11.8906 2.5469 10.9688 3.4688 Q10.0625 4.375 9.5469 5.625 Q9 6.8438 9 8.25 L9 8.25 Q9 8.25 9 8.25 Q9 8.25 9 8.25 Q9 8.7812 9.0781 9.2812 Q9.1719 9.7656 9.3125 10.2656 L9.2812 10.2188 L1.5 18 L1.5 22.5 L6 22.5 L13.7812 14.7188 Q14.2344 14.8594 14.7344 14.9375 Q15.2344 15 15.7812 15 Q17.1094 15 18.2812 14.5312 Q19.4531 14.0312 20.3594 13.2031 Q21.2656 12.375 21.8281 11.25 Q22.3906 10.125 22.5 8.8281 L22.5 8.8125 Q22.5312 8.6719 22.5312 8.5156 Q22.5312 8.3438 22.5312 8.1719 Q22.5312 7.0938 22.1875 6.1094 Q21.8438 5.1094 21.2656 4.2812 L21.2656 4.3125 Q20.3438 3.0156 18.9062 2.2656 Q17.4688 1.5 15.7969 1.5 Q15.7812 1.5 15.7656 1.5 Q15.75 1.5 15.75 1.5 L15.75 1.5 L15.75 1.5 ZM15.75 13.5 Q15.3594 13.5 14.9688 13.4375 Q14.5781 13.375 14.2031 13.2656 L14.25 13.2656 L13.3906 13 L10.3594 16.0312 L9.3125 15 L8.25 16.0469 L9.2812 17.0781 L8.0938 18.2812 L7.0625 17.25 L6 18.2969 L7.0312 19.3281 L5.375 21 L3 21 L3 18.625 L11 10.6094 L10.7812 9.8906 Q10.6406 9.5312 10.5781 9.125 Q10.5312 8.7188 10.5312 8.2656 Q10.5312 6.75 11.2812 5.5156 Q12.0469 4.2656 13.2969 3.5781 L13.3125 3.5625 Q13.8594 3.2812 14.4688 3.125 Q15.0938 2.9688 15.75 2.9688 Q16.8281 2.9688 17.7656 3.375 Q18.7031 3.7656 19.4062 4.4688 Q20.1094 5.1562 20.5625 6.0625 Q20.9844 7 21 8.0625 L21 8.0625 Q21 8.125 21 8.1875 Q21 8.25 21 8.3125 Q21 9.0938 20.7812 9.7969 Q20.5781 10.5 20.1875 11.0781 L20.1875 11.0625 Q19.4844 12.1562 18.3125 12.8281 Q17.1406 13.5 15.75 13.5 Q15.75 13.5 15.75 13.5 Q15.75 13.5 15.75 13.5 L15.75 13.5 L15.75 13.5 ZM18 7.5 Q18 8.125 17.5625 8.5625 Q17.1406 9 16.5 9 Q15.875 9 15.4375 8.5625 Q15 8.125 15 7.5 Q15 6.8594 15.4375 6.4375 Q15.875 6 16.5 6 Q17.1406 6 17.5625 6.4375 Q18 6.8594 18 7.5 Z");
            confirmPasswordLabelIcon.setScaleX(0.5);
            confirmPasswordLabelIcon.setScaleY(0.5);
            confirmPasswordLabelIcon.setFill(Color.valueOf("#888"));
            confirmPasswordLabel.setGraphic(confirmPasswordLabelIcon);


            grid.add(passwordLabel, 0, 0);
            grid.add(passwordField1, 1, 0);
            grid.add(confirmPasswordLabel, 0, 1);
            grid.add(passwordField2, 1, 1);
            dialog.getDialogPane().setContent(grid);


            commit.addEventFilter(ActionEvent.ACTION, event1 -> {
                if (passwordField1.getText().trim().isEmpty()) {
                    passwordField1.requestFocus();
                    event1.consume();
                } else if (passwordField2.getText().trim().isEmpty()) {
                    passwordField2.requestFocus();
                    event1.consume();
                } else if (!passwordField1.getText().trim().equals(passwordField2.getText().trim())) {
                    AlterUtil.CustomAlert("错误", "两次密码输入不一致！");
                    event1.consume();
                } else {
                    metaDBaccessService.executeBackgroundSql(selectedItem, "alter user " + selectedItem.getValue().getName() + " modify password '" + passwordField1.getText().trim() + "'", null);
                }

            });

            dialog.showAndWait();

        });

        updateStatisticsItem.setOnAction(event -> {
            TreeItem<TreeData> selectedItem = treeView.getSelectionModel().getSelectedItem();
            TreeData connect = selectedItem.getValue();
            if (connect instanceof Database) {
                metaDBaccessService.executeBackgroundSql(selectedItem, "update statistics", null);
            }
            else if (connect instanceof ObjectFolder) {
                if(connect.getName().equals("系统表/视图")||connect.getName().equals("表")){
                    metaDBaccessService.executeBackgroundSql(selectedItem, "update statistics high for table force", null);
                }
                else if(connect.getName().equals("存储过程")){
                    metaDBaccessService.executeBackgroundSql(selectedItem, "update statistics for procedure", null);
                }
            }
            else if(connect instanceof SysTable||connect instanceof Table){
                metaDBaccessService.executeBackgroundSql(selectedItem, "update statistics for table "+connect.getName(),null);
            }
            else if(connect instanceof Procedure){
                metaDBaccessService.executeBackgroundSql(selectedItem, "update statistics for procedure "+connect.getName(),null);
            }
        });

        //右键删除连接点击响应
        deleteItem.setOnAction(event -> {
            MetadataTreeviewUtil.deleteTreeItem(treeView);
        });

        //右键移动连接点击响应
        moveItem.setOnAction(event -> {
            TreeItem<TreeData> selectedItem = treeView.getSelectionModel().getSelectedItem();
            Alert alert = new Alert(Alert.AlertType.CONFIRMATION);
            alert.setTitle("移动数据库连接");
            alert.setHeaderText("");
            alert.setGraphic(null); //避免显示问号
            //alert.getButtonTypes().setAll(ButtonType.YES, ButtonType.NO);
            alert.getDialogPane().getScene().getStylesheets().add(MetadataTreeviewUtil.class.getResource("/com/dbboys/css/app.css").toExternalForm());
            Stage alterstage = (Stage) alert.getDialogPane().getScene().getWindow();
            alterstage.getIcons().add(new Image("file:images/logo.png"));
            HBox hbox = new HBox();
            hbox.getChildren().add(new Label("请选择移动到  "));
            hbox.setAlignment(Pos.CENTER_LEFT);
            ChoiceBox choiceBox = new ChoiceBox();
            List<TreeData> list = new ArrayList<>();
            for (TreeItem<TreeData> treeItem : treeView.getRoot().getChildren()) {
                if ( !treeItem.getValue().getName().equals(selectedItem.getParent().getValue().getName())) {
                    list.add(treeItem.getValue());
                }
            }
            choiceBox.setItems(FXCollections.observableArrayList(list));
            choiceBox.getSelectionModel().select(0);
            hbox.getChildren().add(choiceBox);
            alert.getDialogPane().setContent(hbox);

            // 自定义按钮
            ButtonType buttonTypeOk = new ButtonType("确认", ButtonBar.ButtonData.OK_DONE);
            ButtonType buttonTypeCancel = new ButtonType("取消", ButtonBar.ButtonData.CANCEL_CLOSE);
            alert.getButtonTypes().setAll(buttonTypeOk, buttonTypeCancel);
            Button button = (Button) alert.getDialogPane().lookupButton(buttonTypeOk);
            choiceBox.requestFocus();
            choiceBox.setPrefWidth(150);
            Connect connect = (Connect) selectedItem.getValue();
            connect.setParentId(((ConnectFolder) choiceBox.getSelectionModel().getSelectedItem()).getId());
            choiceBox.getSelectionModel().selectedItemProperty().addListener((observable, oldValue, newValue) -> {
                connect.setParentId(((ConnectFolder) newValue).getId());
            });

            ButtonType result = alert.showAndWait().orElse(buttonTypeCancel);
            if (result == buttonTypeOk) {
                selectedItem.setValue(connect);
                SqliteDBaccessUtil.updateConnect(connect);
                selectedItem.getParent().getChildren().remove(selectedItem);
                MetadataTreeviewUtil.treeViewMoveConnectItem(treeView,selectedItem);
            }
        });


        //右键展开层级点击响应
        expandFolderItem.setOnAction(event -> {
            TreeItem<TreeData> selectedItem = treeView.getSelectionModel().getSelectedItem();
            ConnectFolder connectFolder =(ConnectFolder) selectedItem.getValue();
            connectFolder.setExpand(1);
            SqliteDBaccessUtil.updateConnectFolder(connectFolder);
            selectedItem.setExpanded(true);
        });

        //右键折叠点击响应
        flodFolderItem.setOnAction(event -> {
            TreeItem<TreeData> selectedItem = treeView.getSelectionModel().getSelectedItem();
            ConnectFolder connectFolder =(ConnectFolder) selectedItem.getValue();
            connectFolder.setExpand(0);
            SqliteDBaccessUtil.updateConnectFolder(connectFolder);
            selectedItem.setExpanded(false);
        });


        //右键新建数据库点击响应
        createDatabaseItem.setOnAction(event -> {
            TreeItem<TreeData> selectedItem = treeView.getSelectionModel().getSelectedItem();
            Alert alert = new Alert(Alert.AlertType.CONFIRMATION);
            alert.setTitle("新建数据库");
            alert.setHeaderText("");
            alert.setGraphic(null); //避免显示问号
            //alert.getButtonTypes().setAll(ButtonType.YES, ButtonType.NO);
            alert.getDialogPane().getScene().getStylesheets().add(MetadataTreeviewUtil.class.getResource("/com/dbboys/css/app.css").toExternalForm());
            Stage alterstage = (Stage) alert.getDialogPane().getScene().getWindow();
            alterstage.getIcons().add(new Image("file:images/logo.png"));
            VBox vbox = new VBox();
            HBox hbox = new HBox();
            hbox.getChildren().add(new Label("数据库名称 "));
            hbox.setAlignment(Pos.CENTER_LEFT);
            CustomUserTextField textField = new CustomUserTextField();
            // 定义过滤器，只允许 ASCII 字符输入（禁止中文）
            UnaryOperator<TextFormatter.Change> filter = change -> {
                String newText = change.getControlNewText();
                if (newText.matches("[\\x00-\\x7F]*")) {
                    return change;  // 如果输入是 ASCII 字符（英文、数字等），则允许修改
                } else {
                    return null;  // 禁止输入中文字符
                }
            };
            // 将过滤器应用到 TextField
            TextFormatter<String> textFormatter = new TextFormatter<>(filter);
            textField.setTextFormatter(textFormatter);
            textField.setTooltip(new Tooltip("不可使用中文或空格或数字开头"));
            textField.setPrefWidth(240);
            hbox.getChildren().add(textField);
            hbox.setPrefHeight(30);
            hbox.setAlignment(Pos.CENTER_LEFT);

            HBox hbox1 = new HBox();
            ChoiceBox<String> comboBox = new ChoiceBox<>();
            comboBox.getItems().addAll("ZH_CN.UTF8(推荐)", "ZH_CN.GB18030-2000(兼容GBK)", "EN_US.819(ISO8859-1)");
            comboBox.setValue("ZH_CN.UTF8(推荐)");
            comboBox.setId("createDatabaseCharset");
            hbox1.getChildren().add(new Label("选择字符集 "));
            hbox1.getChildren().add(comboBox);
            hbox1.setPrefHeight(30);
            hbox1.setAlignment(Pos.CENTER_LEFT);

            HBox hbox2 = new HBox();
            ChoiceBox<String> comboBox1 = new ChoiceBox<>();
            comboBox1.setId("createDatabaseDbspace");
            hbox2.getChildren().add(new Label("选存储空间 "));
            hbox2.getChildren().add(comboBox1);
            hbox2.setPrefHeight(30);
            hbox2.setAlignment(Pos.CENTER_LEFT);

            ObservableList<String> list = null;
            try {
                list = FXCollections.observableArrayList(metaDBaccessService.getDBspaceForCreateDatabase((Connect) selectedItem.getParent().getValue()));
            }catch (SQLException e){
                log.error(e.getMessage(),e);

                if(e.getErrorCode()==-79716||e.getErrorCode()==-79730) {
                    Platform.runLater(() -> {
                        if (AlterUtil.CustomAlertConfirm("错误", "数据库已断开连接，是否需要重新连接？")) {
                            MetadataTreeviewUtil.reconnectItem(selectedItem);
                        }
                    });
                }else{
                    AlterUtil.CustomAlert("错误", "[" + e.getErrorCode() + "]" + e.getMessage());
                }
            }
            catch (Exception e) {
                AlterUtil.CustomAlert("错误",e.toString());
            }
            comboBox1.setItems(list);
            comboBox1.setValue(list.get(0));

            vbox.getChildren().addAll(hbox,hbox1,hbox2);
            alert.getDialogPane().setContent(vbox);

            // 自定义按钮
            ButtonType buttonTypeOk = new ButtonType("确认", ButtonBar.ButtonData.OK_DONE);
            ButtonType buttonTypeCancel = new ButtonType("取消", ButtonBar.ButtonData.CANCEL_CLOSE);
            alert.getButtonTypes().setAll(buttonTypeOk, buttonTypeCancel);
            Button button = (Button) alert.getDialogPane().lookupButton(buttonTypeOk);
            button.setDisable(true);
            textField.requestFocus();
            textField.textProperty().addListener((observable, oldValue, newValue) -> {
                textField.setText(newValue.replace(" ", ""));
                if (textField.getText().isEmpty()){
                    button.setDisable(true);
                } else {
                    button.setDisable(false);
                }
            });

            ButtonType result = alert.showAndWait().orElse(buttonTypeCancel);
            if (result == buttonTypeOk) {
                metaDBaccessService.executeBackgroundSql(selectedItem,"create database "+textField.getText()+" in "+(String)comboBox1.getValue().replaceAll("\\([^()]*\\)","") +" with log",(String)comboBox.getValue().replaceAll("\\([^()]*\\)",""));

            }
        });
        refreshItem.setOnAction(event->{
            TreeItem<TreeData> selectedItem = treeView.getSelectionModel().getSelectedItem();
            if(selectedItem.isLeaf()){
                if(selectedItem.getValue() instanceof Table||selectedItem.getValue() instanceof SysTable){
                    Task TableMetaTask = new Task<>() {
                        @Override
                        protected Void call() throws Exception {
                            Table table=metaDBaccessService.getTable(selectedItem);
                            if(table.getName()!=null){
                                selectedItem.setValue(table);
                            }
                            return null;
                        }
                    };
                    TableMetaTask.setOnSucceeded(event1 -> {
                        selectedItem.getValue().setRunning(false);
                    });
                    MetadataTreeviewUtil.getMetaConnect(selectedItem).executeSqlTask(new Thread(TableMetaTask));
                    selectedItem.getValue().setRunning(true);
                }
                else if(selectedItem.getValue() instanceof Index){
                    Task TableMetaTask = new Task<>() {
                        @Override
                        protected Void call() throws Exception {
                            Index index=metaDBaccessService.getIndex(selectedItem);
                            if(index.getName()!=null){
                                selectedItem.setValue(index);
                            }
                            return null;
                        }
                    };
                    TableMetaTask.setOnSucceeded(event1 -> {
                        selectedItem.getValue().setRunning(false);
                    });
                    MetadataTreeviewUtil.getMetaConnect(selectedItem).executeSqlTask(new Thread(TableMetaTask));
                    selectedItem.getValue().setRunning(true);
                }
                else if(selectedItem.getValue() instanceof Trigger){
                    Task TableMetaTask = new Task<>() {
                        @Override
                        protected Void call() throws Exception {
                            Trigger trigger=metaDBaccessService.getTrigger(selectedItem);
                            if(trigger.getName()!=null){
                                selectedItem.setValue(trigger);
                            }
                            return null;
                        }
                    };
                    TableMetaTask.setOnSucceeded(event1 -> {
                        selectedItem.getValue().setRunning(false);
                    });
                    MetadataTreeviewUtil.getMetaConnect(selectedItem).executeSqlTask(new Thread(TableMetaTask));
                    selectedItem.getValue().setRunning(true);
                }

            }else{
                selectedItem.getChildren().clear();
                selectedItem.setExpanded(false);
                selectedItem.setExpanded(true);
            }
        });
        //设置默认数据库
        setDefaultDatabaseItem.setOnAction(event-> {
            TreeItem<TreeData> selectedItem = treeView.getSelectionModel().getSelectedItem();
            metaDBaccessService.changeDefaultDatabase(MetadataTreeviewUtil.getMetaConnect(selectedItem),MetadataTreeviewUtil.getCurrentDatabase(selectedItem));
            treeView.refresh();
        });



        //自定义treecell
        treeView.setCellFactory(param -> new CustomTreeCell());

        //右键内容及处理逻辑
        treeView.setOnContextMenuRequested(event -> {
            TreeItem<TreeData> selectedItem = treeView.getSelectionModel().getSelectedItem();
            if (selectedItem != null) {
                treeview_menu.getItems().clear();
                //设置初始值
                expandFolderItem.setDisable(false);
                flodFolderItem.setDisable(false);
                disconnectItem.setDisable(false);
                reconnectItem.setDisable(false);
                connectItem.setDisable(false);
                moveItem.setDisable(false);
                modifyconnectItem.setDisable(false);
                setDefaultDatabaseItem.setDisable(false);
                connectFolderInfoItem.setDisable(false);
                createDatabaseItem.setDisable(false);
                deleteItem.setDisable(false);
                renameItem.setDisable(false);
                truncateItem.setDisable(false);
                disableItem.setDisable(false);
                enableItem.setDisable(false);
                updateStatisticsItem.setDisable(false);
                sqlHisItem.setDisable(false);
                modifyToRawItem.setDisable(false);
                modifyToStandardItem.setDisable(false);

                //如果是只读连接，禁用右键变更
                if(!(selectedItem.getValue() instanceof ConnectFolder)&&!(selectedItem.getValue() instanceof Connect)) {
                    Connect connectcheck = MetadataTreeviewUtil.getMetaConnect(selectedItem);
                    if (connectcheck.getReadonly() != null && connectcheck.getReadonly()) {
                        deleteItem.setDisable(true);
                        renameItem.setDisable(true);
                        truncateItem.setDisable(true);
                        disableItem.setDisable(true);
                        enableItem.setDisable(true);
                        updateStatisticsItem.setDisable(true);
                        modifyToRawItem.setDisable(true);
                        modifyToStandardItem.setDisable(true);
                        createDatabaseItem.setDisable(true);
                    }
                }
                if(selectedItem.getValue() instanceof Connect&&((Connect) selectedItem.getValue()).getReadonly()){
                    sqlHisItem.setDisable(true);
                }

                //如果是系统库，禁用变更操作
                if(selectedItem.getValue() instanceof Database||
                        selectedItem.getValue() instanceof ObjectFolder||
                        selectedItem.getValue() instanceof SysTable||
                        selectedItem.getValue() instanceof Table||
                        selectedItem.getValue() instanceof View||
                        selectedItem.getValue() instanceof Index||
                        selectedItem.getValue() instanceof Sequence||
                        selectedItem.getValue() instanceof Synonym||
                        selectedItem.getValue() instanceof Trigger||
                        selectedItem.getValue() instanceof Function||
                        selectedItem.getValue() instanceof Procedure||
                        selectedItem.getValue() instanceof DBPackage
                ) {
                    String database = MetadataTreeviewUtil.getCurrentDatabase(selectedItem).getName();
                    if (database.equals("sysmaster") || database.equals("sysuser") || database.equals("sysadmin") || database.equals("sysutils") || database.equals("sysha") || database.equals("syscdr") || database.equals("syscdcv1") || database.equals("gbasedbt") || database.equals("sys")) {
                        truncateItem.setDisable(true);
                        deleteItem.setDisable(true);
                        renameItem.setDisable(true);
                        enableItem.setDisable(true);
                        disableItem.setDisable(true);
                        modifyToRawItem.setDisable(true);
                        modifyToStandardItem.setDisable(true);
                    }
                }

                //连接分类
                if(selectedItem.getValue() instanceof ConnectFolder){
                    treeview_menu.getItems().add(connectFolderInfoItem);
                    if(selectedItem.getChildren().size()==0){
                        connectFolderInfoItem.setDisable(true);
                    }
                    treeview_menu.getItems().add(createConnectItem);
                    //treeview_menu.getItems().add(addSystemLevle);
                    treeview_menu.getItems().add(disconnectFolder);
                    if (selectedItem.getParent().getChildren().size() <= 1) {
                        deleteItem.setDisable(true);
                    }
                    treeview_menu.getItems().add(expandFolderItem);
                    treeview_menu.getItems().add(flodFolderItem);
                    //根据节点状态设置右键展开和折叠是否disable
                    if (((ConnectFolder)selectedItem.getValue()).getExpand() == 1) {
                        expandFolderItem.setDisable(true);
                        flodFolderItem.setDisable(false);
                    } else {
                        expandFolderItem.setDisable(false);
                        flodFolderItem.setDisable(true);
                    }
                    treeview_menu.getItems().add(renameItem);
                    treeview_menu.getItems().add(deleteItem);
                }
                //连接
                else if(selectedItem.getValue() instanceof Connect){
                    Connect connect =(Connect)selectedItem.getValue();
                    if(!connect.getUsername().equals("gbasedbt")){
                        healthCheckItem.setDisable(true);
                        onlinelogItem.setDisable(true);
                        spaceManagerItem.setDisable(true);
                        onconfigItem.setDisable(true);
                        instanceStopItem.setDisable(true);
                    }else{
                        healthCheckItem.setDisable(false);
                        onlinelogItem.setDisable(false);
                        spaceManagerItem.setDisable(false);
                        onconfigItem.setDisable(false);
                        instanceStopItem.setDisable(false);
                    }
                    //treeview_menu.getItems().add(createConnectItem);
                    treeview_menu.getItems().add(sqlHisItem);
                    treeview_menu.getItems().add(separator1);
                    //treeview_menu.getItems().add(connectOpenFileItem);
                    treeview_menu.getItems().add(connectItem);
                    treeview_menu.getItems().add(reconnectItem);
                    treeview_menu.getItems().add(disconnectItem);
                    treeview_menu.getItems().add(copyconnectItem);
                    treeview_menu.getItems().add(moveItem);
                    treeview_menu.getItems().add(modifyconnectItem);
                    //treeview_menu.getItems().add(refreshItem);
                    treeview_menu.getItems().add(renameItem);
                    treeview_menu.getItems().add(deleteItem);
                    treeview_menu.getItems().add(separator2);
                    treeview_menu.getItems().add(connectInfoItem);
                    treeview_menu.getItems().add(healthCheckItem);
                    treeview_menu.getItems().add(onlinelogItem);
                    treeview_menu.getItems().add(spaceManagerItem);
                    treeview_menu.getItems().add(onconfigItem);
                    treeview_menu.getItems().add(instanceStopItem);



                    try {
                        if (!(connect.getConn()==null || connect.getConn().isClosed())) {
                            modifyconnectItem.setDisable(true);
                            renameItem.setDisable(true);
                            deleteItem.setDisable(true);
                            connectItem.setDisable(true);
                        }else{
                            reconnectItem.setDisable(true);
                            disconnectItem.setDisable(true);
                        }
                    } catch (SQLException e) {
                        log.error(e.getMessage(),e);

                        throw new RuntimeException(e);
                    }

                    if (treeView.getRoot().getChildren().size() <= 1) {
                        moveItem.setDisable(true);
                    }
                }
                //数据库对象文件夹
                else if(selectedItem.getValue() instanceof DatabaseFolder){
                    treeview_menu.getItems().add(createDatabaseItem);
                    treeview_menu.getItems().add(refreshItem);
                }
                else if(selectedItem.getValue() instanceof UserFolder) {
                    treeview_menu.getItems().add(addUserItem);
                    treeview_menu.getItems().add(refreshItem);
                }
                else if(selectedItem.getValue() instanceof User) {
                    treeview_menu.getItems().add(modifyUserItem);
                    treeview_menu.getItems().add(deleteItem);
                }
                //数据库
                else if(selectedItem.getValue() instanceof Database) {
                    treeview_menu.getItems().add(databaseOpenFileItem);
                    treeview_menu.getItems().add(setDefaultDatabaseItem);
                    treeview_menu.getItems().add(updateStatisticsItem);
                    treeview_menu.getItems().add(copyItem);
                    treeview_menu.getItems().add(refreshItem);
                    treeview_menu.getItems().add(renameItem);
                    treeview_menu.getItems().add(deleteItem);
                }
                //对象文件夹
                else if(selectedItem.getValue() instanceof ObjectFolder) {
                    treeview_menu.getItems().add(refreshItem);
                    if(//selectedItem.getValue().getName().equals("系统表/视图")||
                            selectedItem.getValue().getName().equals("表")
                                    ||selectedItem.getValue().getName().equals("存储过程")
                    ){
                        treeview_menu.getItems().add(updateStatisticsItem);
                    }
                }
                //系统表
                else if(selectedItem.getValue() instanceof SysTable) {
                    if(!((SysTable)selectedItem.getValue()).getTableType().equals("view")){
                        treeview_menu.getItems().add(updateStatisticsItem);
                        treeview_menu.getItems().add(copyItem);
                        treeview_menu.getItems().add(refreshItem);
                    }
                }
                //表
                else if(selectedItem.getValue() instanceof Table) {
                    if(!((Table)selectedItem.getValue()).getTableType().equals("external")){
                        treeview_menu.getItems().add(updateStatisticsItem);
                        treeview_menu.getItems().add(modifyToRawItem);
                        treeview_menu.getItems().add(modifyToStandardItem);
                        treeview_menu.getItems().add(truncateItem);
                    }
                    if(((Table)selectedItem.getValue()).getTableType().equals("raw")){
                        modifyToRawItem.setDisable(true);
                    }else{
                        modifyToStandardItem.setDisable(true);
                    }
                    treeview_menu.getItems().add(copyItem);
                    treeview_menu.getItems().add(refreshItem);
                    treeview_menu.getItems().add(renameItem);
                    treeview_menu.getItems().add(deleteItem);
                }
                //视图
                else if(selectedItem.getValue() instanceof View) {
                    treeview_menu.getItems().add(copyItem);
                    treeview_menu.getItems().add(deleteItem);
                }
                //索引
                else if(selectedItem.getValue() instanceof Index) {
                    treeview_menu.getItems().add(enableItem);
                    treeview_menu.getItems().add(disableItem);
                    treeview_menu.getItems().add(copyItem);
                    treeview_menu.getItems().add(refreshItem);
                    treeview_menu.getItems().add(renameItem);
                    treeview_menu.getItems().add(deleteItem);
                    if(((Index)selectedItem.getValue()).getIsdisabled()) {
                        disableItem.setDisable(true);
                    }else{
                        enableItem.setDisable(true);
                    }
                    if(selectedItem.getValue().getName().charAt(0)==' '){
                        enableItem.setDisable(true);
                        disableItem.setDisable(true);
                        renameItem.setDisable(true);
                        deleteItem.setDisable(true);
                    }
                }
                //序列
                else if(selectedItem.getValue() instanceof Sequence) {
                    treeview_menu.getItems().add(copyItem);
                    treeview_menu.getItems().add(renameItem);
                    treeview_menu.getItems().add(deleteItem);
                }
                //同义词
                else if(selectedItem.getValue() instanceof Synonym) {
                    treeview_menu.getItems().add(copyItem);
                    treeview_menu.getItems().add(deleteItem);
                }
                //触发器
                else if(selectedItem.getValue() instanceof Trigger) {
                    treeview_menu.getItems().add(enableItem);
                    treeview_menu.getItems().add(disableItem);
                    treeview_menu.getItems().add(copyItem);
                    treeview_menu.getItems().add(refreshItem);
                    treeview_menu.getItems().add(deleteItem);
                    if(((Trigger)selectedItem.getValue()).isIsdisabled()) {
                        disableItem.setDisable(true);
                    }else{
                        enableItem.setDisable(true);
                    }
                }
                //函数
                else if(selectedItem.getValue() instanceof Function) {
                    treeview_menu.getItems().add(copyItem);
                    treeview_menu.getItems().add(deleteItem);
                }
                //存储过程
                else if(selectedItem.getValue() instanceof Procedure) {
                    treeview_menu.getItems().add(updateStatisticsItem);
                    treeview_menu.getItems().add(copyItem);
                    treeview_menu.getItems().add(deleteItem);
                }
                //包
                else if(selectedItem.getValue() instanceof DBPackage) {
                    treeview_menu.getItems().add(packageDDLItem);
                    treeview_menu.getItems().add(copyItem);
                    treeview_menu.getItems().add(refreshItem);
                    treeview_menu.getItems().add(deleteItem);
                }
                else if(selectedItem.getValue() instanceof PackageFunction||selectedItem.getValue() instanceof PackageProcedure) {
                    treeview_menu.getItems().add(copyItem);
                }

                // 树中右键框显示
                treeview_menu.show(treeView, event.getScreenX(), event.getScreenY());
            }
        });


    }

    //创建一个TreeItem,重构ifLeaf显示箭头
    public static TreeItem<TreeData> createTreeItem(TreeData treeData) {
        TreeItem<TreeData> treeItem = new TreeItem<>(treeData){
            @Override
            public boolean isLeaf() {
                return false;
            }
        };
        if(!(treeData instanceof ConnectFolder)){
            treeItem.expandedProperty().addListener((obs, wasExpanded, isNowExpanded) -> {
                if (isNowExpanded&& treeItem.getChildren().isEmpty()){
                    treeItemAddChildrens(treeItem);
                };
            });
        }
        return treeItem;
    }


    //创建一个TreeItem,重构ifLeaf显示箭头
    public static TreeItem<TreeData> createLeafTreeItem(TreeData treeData) {
        TreeItem<TreeData> treeItem = new TreeItem<>(treeData){
            @Override
            public boolean isLeaf() {
                return true;
            }
        };
        return treeItem;

    }

    //创建连接分类文件夹
    public static void createConnectFolder(TreeView<TreeData> treeView) {
        Alert alert = new Alert(Alert.AlertType.CONFIRMATION);
        alert.setTitle("新建连接分类");
        alert.setHeaderText("");
        alert.setGraphic(null);
        //alert.getButtonTypes().setAll(ButtonType.YES, ButtonType.NO);
        alert.getDialogPane().getScene().getStylesheets().add(MetadataTreeviewUtil.class.getResource("/com/dbboys/css/app.css").toExternalForm());
        Stage alterstage = (Stage) alert.getDialogPane().getScene().getWindow();
        alterstage.getIcons().add(new Image("file:images/logo.png"));
        HBox hbox = new HBox();
        hbox.getChildren().add(new Label("请输入连接分类名称  "));
        hbox.setAlignment(Pos.CENTER_LEFT);
        TextField textField = new TextField();
        textField.setPrefWidth(200);
        hbox.getChildren().add(textField);
        alert.getDialogPane().setContent(hbox);

        // 自定义按钮
        ButtonType buttonTypeOk = new ButtonType("确认", ButtonBar.ButtonData.OK_DONE);
        ButtonType buttonTypeCancel = new ButtonType("取消", ButtonBar.ButtonData.CANCEL_CLOSE);
        alert.getButtonTypes().setAll(buttonTypeOk, buttonTypeCancel);
        Button button = (Button) alert.getDialogPane().lookupButton(buttonTypeOk);
        button.setDisable(true);
        textField.requestFocus();
        textField.textProperty().addListener((observable, oldValue, newValue) -> {
            textField.setText(newValue.replace(" ", ""));
            if (!textField.getText().isEmpty()) {
                Boolean exists = false;
                for (TreeItem<TreeData> treeItem : treeView.getRoot().getChildren()) {
                    if (treeItem.getValue().getName().equals(textField.getText())) {
                        exists = true;
                    }
                }
                if (exists) {
                    button.setDisable(true);
                } else {
                    button.setDisable(false);
                }
            } else {
                button.setDisable(true);
            }
        });

        ButtonType result = alert.showAndWait().orElse(buttonTypeCancel);
        if (result == buttonTypeOk) {
            ConnectFolder connectFolder = new ConnectFolder();
            connectFolder.setName(textField.getText());
            connectFolder.setExpand(1);
            SqliteDBaccessUtil.createConnectFolder(connectFolder);
            TreeItem treeItem= MetadataTreeviewUtil.createTreeItem(connectFolder);
            //ConnectTreeViewUtil.treeViewAddItem(databaseobjects_treeview,treeItem);
            treeView.getRoot().getChildren().add(treeItem);
            reorderTreeview(treeView,treeItem);
        }
    }

    //创建一个连接节点
    public static void createConnectLeaf(TreeView<TreeData> treeView,TreeItem<TreeData> treeItem) {
        for (TreeItem<TreeData> folderTreeItem : treeView.getRoot().getChildren()) {
            if (((ConnectFolder)folderTreeItem.getValue()).getId() == ((Connect)treeItem.getValue()).getParentId()) {
                folderTreeItem.getChildren().add(treeItem);
                if(!folderTreeItem.isExpanded()){
                    folderTreeItem.setExpanded(true);
                }
                reorderTreeview(treeView,treeItem);
                break;

            }
        }
    }
    //重命名节点
    public static void renameTreeItem(TreeView<TreeData> treeView) {
        TreeItem<TreeData> selectedItem = treeView.getSelectionModel().getSelectedItem();
        Alert alert = new Alert(Alert.AlertType.CONFIRMATION);
        String title="重命名";
        if(selectedItem.getValue() instanceof ConnectFolder){
            title="重命名连接分类："+selectedItem.getValue().getName();
        }else if(selectedItem.getValue() instanceof Connect){
            title="重命名数据库连接："+selectedItem.getValue().getName();
        }else if(selectedItem.getValue() instanceof Database){
            title="重命名数据库："+selectedItem.getValue().getName();
        }else if(selectedItem.getValue() instanceof Table){
            title="重命名表："+selectedItem.getValue().getName();
        }else if(selectedItem.getValue() instanceof Index){
            title="重命名索引："+selectedItem.getValue().getName();
        }else if(selectedItem.getValue() instanceof Sequence){
            title="重命名序列："+selectedItem.getValue().getName();
        }else if(selectedItem.getValue() instanceof Trigger){
            title="重命名触发器："+selectedItem.getValue().getName();
        }else if(selectedItem.getValue() instanceof Function){
            title="重命名函数："+selectedItem.getValue().getName();
        }else if(selectedItem.getValue() instanceof Procedure){
            title="重命名存储过程："+selectedItem.getValue().getName();
        }
        alert.setTitle(title);
        alert.setHeaderText("");
        alert.setGraphic(null); //避免显示问号
        //alert.getButtonTypes().setAll(ButtonType.YES, ButtonType.NO);
        alert.getDialogPane().getScene().getStylesheets().add(MetadataTreeviewUtil.class.getResource("/com/dbboys/css/app.css").toExternalForm());
        Stage alterstage = (Stage) alert.getDialogPane().getScene().getWindow();
        alterstage.getIcons().add(new Image("file:images/logo.png"));
        HBox hbox = new HBox();
        hbox.getChildren().add(new Label("请输入重命名名称  "));
        hbox.setAlignment(Pos.CENTER_LEFT);
        CustomUserTextField textField = new CustomUserTextField();
        textField.setPrefWidth(200);
        textField.setText(selectedItem.getValue().getName());
        textField.positionCaret(textField.getText().length());
        hbox.getChildren().add(textField);
        alert.getDialogPane().setContent(hbox);

        // 自定义按钮
        ButtonType buttonTypeOk = new ButtonType("确认", ButtonBar.ButtonData.OK_DONE);
        ButtonType buttonTypeCancel = new ButtonType("取消", ButtonBar.ButtonData.CANCEL_CLOSE);
        alert.getButtonTypes().setAll(buttonTypeOk, buttonTypeCancel);
        Button button = (Button) alert.getDialogPane().lookupButton(buttonTypeOk);
        button.setDisable(true);
        textField.requestFocus();
        textField.textProperty().addListener((observable, oldValue, newValue) -> {
            textField.setText(newValue.replace(" ", ""));
            if (!textField.getText().isEmpty() && !textField.getText().equals(selectedItem.getValue().getName())) {
                Boolean exists = false;

                //如果是数据库连接，需要判断所有分类里是否重复
                if(selectedItem.getValue() instanceof Connect){
                    for (TreeItem<TreeData> treeItem : treeView.getRoot().getChildren()){
                        for (TreeItem<TreeData> treeItem1 : treeItem.getChildren()){
                            if (treeItem1.getValue().getName().equals(textField.getText())) {
                                exists = true;
                            }
                        }
                    }
                }else{
                    for (TreeItem<TreeData> treeItem : selectedItem.getParent().getChildren()) {
                        if (treeItem.getValue().getName().equals(textField.getText())) {
                            exists = true;
                        }
                    }
                }
                if (exists) {
                    button.setDisable(true);
                } else {
                    button.setDisable(false);
                }
            } else {
                button.setDisable(true);
            }
        });

        ButtonType result = alert.showAndWait().orElse(buttonTypeCancel);
        if (result == buttonTypeOk) {
            TreeData treeData = selectedItem.getValue();
            if (selectedItem.getValue() instanceof ConnectFolder) {
                treeData.setName(textField.getText());
                if (selectedItem.getParent().getChildren().size() > 1) { //多于1个分类，重新排序
                    reorderTreeview(treeView, selectedItem);
                }
                SqliteDBaccessUtil.updateConnectFolder((ConnectFolder) treeData);
                NotificationUtil.showNotification(Main.mainController.notice_pane, "分类已重命名为：" + selectedItem.getValue().getName());
            }else if(selectedItem.getValue() instanceof Connect){
                selectedItem.getValue().setName(textField.getText());
                //connect_list_treeview.refresh();
                if(selectedItem.getParent().getChildren().size()>1) {//多于1个连接重新排序
                    MetadataTreeviewUtil.reorderTreeview(treeView, selectedItem);
                }
                SqliteDBaccessUtil.updateConnect((Connect) selectedItem.getValue());
                TabpaneUtil.refreshConnectList();
                NotificationUtil.showNotification(Main.mainController.notice_pane, "连接已重命名为："+selectedItem.getValue().getName());
            }else if(selectedItem.getValue() instanceof Database){
                metaDBaccessService.executeBackgroundSql(selectedItem, "rename database "+selectedItem.getValue().getName()+" to "+textField.getText(),null);
            }else if(selectedItem.getValue() instanceof Table){
                metaDBaccessService.executeBackgroundSql(selectedItem, "rename table "+selectedItem.getValue().getName()+" to "+textField.getText(),null);
            }else if(selectedItem.getValue() instanceof Index){
                metaDBaccessService.executeBackgroundSql(selectedItem, "rename index "+selectedItem.getValue().getName()+" to "+textField.getText(),null);
            }else if(selectedItem.getValue() instanceof Sequence){
                metaDBaccessService.executeBackgroundSql(selectedItem, "rename sequece "+selectedItem.getValue().getName()+" to "+textField.getText(),null);
            }else if(selectedItem.getValue() instanceof Synonym){
                metaDBaccessService.executeBackgroundSql(selectedItem, "rename synonym "+selectedItem.getValue().getName()+" to "+textField.getText(),null);
            }else if(selectedItem.getValue() instanceof Trigger){
                metaDBaccessService.executeBackgroundSql(selectedItem, "rename trigger "+selectedItem.getValue().getName()+" to "+textField.getText(),null);
            }else if(selectedItem.getValue() instanceof Function){
                metaDBaccessService.executeBackgroundSql(selectedItem, "rename function "+selectedItem.getValue().getName()+" to "+textField.getText(),null);
            }else if(selectedItem.getValue() instanceof Procedure){
                metaDBaccessService.executeBackgroundSql(selectedItem, "rename procedure "+selectedItem.getValue().getName()+" to "+textField.getText(),null);
            }
        }
    }

    //删除节点
    public static void deleteTreeItem(TreeView<TreeData> treeView) {
        TreeItem<TreeData> selectedItem = treeView.getSelectionModel().getSelectedItem();
        TreeData treeData = selectedItem.getValue();
        if(treeData instanceof  ConnectFolder){
            if (selectedItem.getParent().getChildren().size() <= 1) {
                AlterUtil.CustomAlert("删除连接分类","当前只有一个连接分类，不可删除！");
            } else if (selectedItem.getChildren().size() > 0) {
                Boolean confirm=AlterUtil.CustomAlertConfirm("删除连接分类","删除连接分类\""+selectedItem.getValue().getName()+"\"将删除该分类下【" + selectedItem.getChildren().size() + "】个连接，确定要删除该分类吗？");
                if (confirm) {
                    disconnectFolder(selectedItem);
                    selectedItem.getParent().getChildren().remove(selectedItem);
                    SqliteDBaccessUtil.deleteConnectFolder((ConnectFolder) selectedItem.getValue());
                    NotificationUtil.showNotification(Main.mainController.notice_pane, "数据库连接分类\""+selectedItem.getValue().getName()+"\"已删除！");
                }
            } else {
                SqliteDBaccessUtil.deleteConnectFolder((ConnectFolder)selectedItem.getValue());
                selectedItem.getParent().getChildren().remove(selectedItem);
                NotificationUtil.showNotification(Main.mainController.notice_pane, "数据库连接分类\""+selectedItem.getValue().getName()+"\"已删除！");
            }

        }else if(selectedItem.getValue() instanceof Connect){
            if (AlterUtil.CustomAlertConfirm("删除连接","确定要删除连接\""+selectedItem.getValue().getName()+"\"吗？")) {
                Connect connect = (Connect) selectedItem.getValue();
                try {
                    if (!selectedItem.getChildren().isEmpty()) {
                        connect.getConn().close();
                        selectedItem.getChildren().clear();
                    }
                } catch (SQLException e) {
                    log.error(e.getMessage(),e);
                    throw new RuntimeException(e);
                }
                SqliteDBaccessUtil.deleteConnectLeaf(connect);
                selectedItem.getParent().getChildren().remove(selectedItem);
                TabpaneUtil.refreshConnectList();
                NotificationUtil.showNotification(Main.mainController.notice_pane, "数据库连接\""+selectedItem.getValue().getName()+"\"已删除！");
            }
        }else if(selectedItem.getValue() instanceof Database){
            metaDBaccessService.executeBackgroundSql(selectedItem,"drop database "+selectedItem.getValue().getName(),null);
        }else if(selectedItem.getValue() instanceof Table){
            metaDBaccessService.executeBackgroundSql(selectedItem, "drop table "+selectedItem.getValue().getName(),null);
        }else if(selectedItem.getValue() instanceof View){
            metaDBaccessService.executeBackgroundSql(selectedItem, "drop view "+selectedItem.getValue().getName(),null);
        }else if(selectedItem.getValue() instanceof Index){
            metaDBaccessService.executeBackgroundSql(selectedItem, "drop index "+selectedItem.getValue().getName(),null);
        }else if(selectedItem.getValue() instanceof Sequence){
            metaDBaccessService.executeBackgroundSql(selectedItem, "drop sequece "+selectedItem.getValue().getName(),null);
        }else if(selectedItem.getValue() instanceof Synonym){
            metaDBaccessService.executeBackgroundSql(selectedItem, "drop synonym "+selectedItem.getValue().getName(),null);
        }else if(selectedItem.getValue() instanceof Trigger){
            metaDBaccessService.executeBackgroundSql(selectedItem, "drop trigger "+selectedItem.getValue().getName(),null);
        }else if(selectedItem.getValue() instanceof Function){
            metaDBaccessService.executeBackgroundSql(selectedItem, "drop function "+selectedItem.getValue().getName(),null);
        }else if(selectedItem.getValue() instanceof Procedure){
            metaDBaccessService.executeBackgroundSql(selectedItem, "drop procedure "+selectedItem.getValue().getName(),null);
        }else if(selectedItem.getValue() instanceof DBPackage){
            metaDBaccessService.executeBackgroundSql(selectedItem, "drop package "+selectedItem.getValue().getName(),null);
        }else if(selectedItem.getValue() instanceof User){
            metaDBaccessService.executeBackgroundSql(selectedItem, "drop user "+selectedItem.getValue().getName(),null);
        }
    }

    //连接创建后需要重新排序
    public static void reorderTreeview(TreeView<TreeData> treeView,TreeItem<TreeData> treeItem) {
        Comparator<TreeItem<TreeData>> treeItemComparator = (o1, o2) -> o1.getValue().getName().compareTo(o2.getValue().getName());
        treeItem.getParent().getChildren().sort(treeItemComparator);
        //排序后当前选择的元素到了最后一个，需重新设置当前选择项
        treeView.getSelectionModel().select(treeItem);
        treeView.scrollTo(treeView.getSelectionModel().getSelectedIndex());
    }

    //增加子节点
    public static void  treeItemAddChildrens(TreeItem<TreeData> treeItem){
        if(treeItem.getValue() instanceof Connect){
            treeItem.getChildren().add(createLeafTreeItem(new Connecting("Connecting")));
        }else{
            treeItem.getChildren().add(createLeafTreeItem(new Loading("Loading")));
        }
        if(treeItem.getValue() instanceof Connect){
            Connect connect =(Connect)treeItem.getValue();
            MetadataTreeviewUtil.getMetaConnect(treeItem).executeSqlTask(
                    new Thread(() -> {
                        try{
                            connect.setConn(metaDBaccessService.getConnection(connect));
                            //连接之后切换到gbase模式
                            metaDBaccessService.sessionChangeToGbaseMode(connect.getConn());
                            DatabaseFolder databaseTreeData = new DatabaseFolder("数据库");
                            TreeItem<TreeData> databaseItem=createTreeItem(databaseTreeData);
                            UserFolder userTreeData = new UserFolder("用户");
                            TreeItem<TreeData> userItem = createTreeItem(userTreeData);


                            //TreeItem<TreeData> scanItem=createTreeItem(checkTreeData);
                            //TreeItem<TreeData> monItem=createTreeItem(monTreeData);

                            //查询到结果后删除loading节点
                            Platform.runLater(() -> {
                                treeItem.getChildren().clear();
                                //查询到的结果添加到数据库条目下
                                treeItem.getChildren().add(databaseItem);
                                if(connect.getUsername().equals("gbasedbt")) {
                                    treeItem.getChildren().add(userItem);
                                }
                                // treeItem.getChildren().add(scanItem);
                                //treeItem.getChildren().add(monItem);
                                //addExpandedPropertyListen(treeItem);
                            });
                        } catch (SQLException e) {
                            log.error(e.getMessage(),e);

                            Platform.runLater(() -> {
                                treeItem.getChildren().clear();
                                treeItem.setExpanded(false);
                                AlterUtil.CustomAlert("错误", "[" + e.getErrorCode() + "]" + e.getMessage());
                            });
                        }
                        catch (Exception e) {
                            Platform.runLater(() -> {
                                treeItem.getChildren().clear();
                                treeItem.setExpanded(false);
                                AlterUtil.CustomAlert("错误",e.toString());
                            });
                        }
                    }));
        }else if(treeItem.getValue() instanceof DatabaseFolder){
            //创建子线程加载数据库
            MetadataTreeviewUtil.getMetaConnect(treeItem).executeSqlTask(
                    new Thread(() -> {
                        List<Database> databases = metaDBaccessService.getDatabases(getMetaConnect(treeItem));
                        //查询到结果后删除loading节点
                        if(databases.size()>0){
                            Platform.runLater(() -> {
                                treeItem.getChildren().clear();
                                //查询到的结果添加到数据库条目下
                                for (Database database : databases) {
                                    TreeItem<TreeData> item = createTreeItem(database);
                                    treeItem.getChildren().add(item);
                                }
                            });
                        }else{
                            Platform.runLater(() -> {
                                treeItem.getChildren().clear();
                                treeItem.setExpanded(false);
                            });
                        }
                    }));
        }else if(treeItem.getValue() instanceof UserFolder){
            //创建子线程加载数据库
            MetadataTreeviewUtil.getMetaConnect(treeItem).executeSqlTask(
                    new Thread(() -> {
                        List<User> users = metaDBaccessService.getUsers(treeItem);
                        //查询到结果后删除loading节点
                        if(users.size()>0){
                            Platform.runLater(() -> {
                                treeItem.getChildren().clear();
                                //查询到的结果添加到数据库条目下
                                for (User user : users) {
                                    TreeItem<TreeData> item = createLeafTreeItem(user);
                                    treeItem.getChildren().add(item);
                                }
                            });
                        }else{
                            Platform.runLater(() -> {
                                treeItem.getChildren().clear();
                                treeItem.setExpanded(false);
                            });
                        }
                    }));
        }
        else if(treeItem.getValue() instanceof Database){
            MetadataTreeviewUtil.getMetaConnect(treeItem).executeSqlTask(
                    new Thread(() -> {
                        ObjectList objectList = metaDBaccessService.getDatabaseObjects(treeItem);
                        if(objectList.getSuccess()!=null) {
                            if(objectList.getInfo()==null){
                                Platform.runLater(() -> {
                                    NotificationUtil.showNotification(Main.mainController.notice_pane, "未找到当前数据库，数据库已被删除！");
                                    treeItem.getParent().getChildren().remove(treeItem);
                                });
                            }else {
                                treeItem.setValue((Database) objectList.getInfo());
                                //查询到结果后删除loading节点
                                Platform.runLater(() -> {
                                    treeItem.getChildren().clear();
                                    //查询到的结果添加到数据库条目下
                                    ObjectFolder objectFolder = new ObjectFolder("系统表/视图");
                                    objectFolder.setDescription(objectList.getItems().get(0).toString());
                                    TreeItem<TreeData> systableTreeItem = createTreeItem(objectFolder);
                                    objectFolder = new ObjectFolder("表");
                                    objectFolder.setDescription(objectList.getItems().get(1).toString());
                                    TreeItem<TreeData> tableTreeItem = createTreeItem(objectFolder);
                                    objectFolder = new ObjectFolder("视图");
                                    objectFolder.setDescription(objectList.getItems().get(2).toString());
                                    TreeItem<TreeData> viewTreeItem = createTreeItem(objectFolder);
                                    objectFolder = new ObjectFolder("索引");
                                    objectFolder.setDescription(objectList.getItems().get(3).toString());
                                    TreeItem<TreeData> indexTreeItem = createTreeItem(objectFolder);
                                    objectFolder = new ObjectFolder("序列");
                                    objectFolder.setDescription(objectList.getItems().get(4).toString());
                                    TreeItem<TreeData> sequenceTreeItem = createTreeItem(objectFolder);
                                    objectFolder = new ObjectFolder("同义词");
                                    objectFolder.setDescription(objectList.getItems().get(5).toString());
                                    TreeItem<TreeData> synTreeItem = createTreeItem(objectFolder);
                                    objectFolder = new ObjectFolder("触发器");
                                    objectFolder.setDescription(objectList.getItems().get(6).toString());
                                    TreeItem<TreeData> triggerTreeItem = createTreeItem(objectFolder);
                                    objectFolder = new ObjectFolder("函数");
                                    objectFolder.setDescription(objectList.getItems().get(7).toString());
                                    TreeItem<TreeData> functionTreeItem = createTreeItem(objectFolder);
                                    objectFolder = new ObjectFolder("存储过程");
                                    objectFolder.setDescription(objectList.getItems().get(8).toString());
                                    TreeItem<TreeData> procedureTreeItem = createTreeItem(objectFolder);
                                    objectFolder = new ObjectFolder("包");
                                    objectFolder.setDescription(objectList.getItems().get(9).toString());
                                    TreeItem<TreeData> packageTreeItem = createTreeItem(objectFolder);
                                    treeItem.getChildren().add(systableTreeItem);
                                    treeItem.getChildren().add(tableTreeItem);
                                    treeItem.getChildren().add(viewTreeItem);
                                    treeItem.getChildren().add(indexTreeItem);
                                    treeItem.getChildren().add(sequenceTreeItem);
                                    treeItem.getChildren().add(synTreeItem);
                                    treeItem.getChildren().add(triggerTreeItem);
                                    treeItem.getChildren().add(functionTreeItem);
                                    treeItem.getChildren().add(procedureTreeItem);
                                    treeItem.getChildren().add(packageTreeItem);
                                    //addExpandedPropertyListen(treeItem);
                                });
                            }
                        }else{
                            Platform.runLater(() -> {
                                treeItem.getChildren().clear();
                                treeItem.setExpanded(false);
                            });
                        }
                    }));
        }else if(treeItem.getValue() instanceof ObjectFolder && treeItem.getValue().getName().equals("系统表/视图")){
            MetadataTreeviewUtil.getMetaConnect(treeItem).executeSqlTask(
                    new Thread(() -> {
                        ObjectList objectList = metaDBaccessService.getSystemtables(treeItem);
                        if(objectList.getInfo()!=null&&!objectList.getItems().isEmpty()) {
                            ((ObjectFolder) treeItem.getValue()).setDescription((String)objectList.getInfo());
                            Platform.runLater(() -> {
                                treeItem.getChildren().clear();
                                List<SysTable> systables = objectList.getItems();
                                for (SysTable tabname : systables) {
                                    TreeItem<TreeData> item = createLeafTreeItem(tabname);
                                    treeItem.getChildren().add(item);
                                }
                            });
                        }else{
                            Platform.runLater(() -> {
                                treeItem.getChildren().clear();
                                treeItem.setExpanded(false);
                            });
                        }
                    }));
        }else if(treeItem.getValue() instanceof ObjectFolder && treeItem.getValue().getName().equals("表")){
            MetadataTreeviewUtil.getMetaConnect(treeItem).executeSqlTask(
                    new Thread(() -> {
                        ObjectList objectList = metaDBaccessService.getTables(treeItem);
                        if(objectList.getInfo()!=null&&!objectList.getItems().isEmpty()) {
                            ((ObjectFolder) treeItem.getValue()).setDescription((String)objectList.getInfo());
                            Platform.runLater(() -> {
                                treeItem.getChildren().clear();
                                List<Table> tables = objectList.getItems();
                                for (Table tabname : tables) {
                                    TreeItem<TreeData> item = createLeafTreeItem(tabname);
                                    treeItem.getChildren().add(item);
                                }
                            });
                        }else{
                            Platform.runLater(() -> {
                                treeItem.getChildren().clear();
                                treeItem.setExpanded(false);
                            });
                        }
                    }));
        }else if(treeItem.getValue() instanceof ObjectFolder && treeItem.getValue().getName().equals("视图")){
            MetadataTreeviewUtil.getMetaConnect(treeItem).executeSqlTask(
                    new Thread(() -> {
                        ObjectList objectList = metaDBaccessService.getViews(treeItem);
                        if(objectList.getInfo()!=null&&!objectList.getItems().isEmpty()) {
                            ((ObjectFolder) treeItem.getValue()).setDescription((String)objectList.getInfo());
                            Platform.runLater(() -> {
                                treeItem.getChildren().clear();
                                List<View> views = objectList.getItems();
                                for (View view : views) {
                                    TreeItem<TreeData> item = createLeafTreeItem(view);
                                    treeItem.getChildren().add(item);
                                }
                            });
                        }else{
                            Platform.runLater(() -> {
                                treeItem.getChildren().clear();
                                treeItem.setExpanded(false);
                            });
                        }
                    }));
        }else if(treeItem.getValue() instanceof ObjectFolder && treeItem.getValue().getName().equals("索引")){
            MetadataTreeviewUtil.getMetaConnect(treeItem).executeSqlTask(
                    new Thread(() -> {
                        ObjectList objectList = metaDBaccessService.getIndexes(treeItem);
                        if(objectList.getInfo()!=null&&!objectList.getItems().isEmpty()) {
                            ((ObjectFolder) treeItem.getValue()).setDescription((String)objectList.getInfo());
                            Platform.runLater(() -> {
                                treeItem.getChildren().clear();
                                List<Index> indexes = objectList.getItems();
                                for (Index index : indexes) {
                                    TreeItem<TreeData> item = createLeafTreeItem(index);
                                    treeItem.getChildren().add(item);
                                }
                            });
                        }else{
                            Platform.runLater(() -> {
                                treeItem.getChildren().clear();
                                treeItem.setExpanded(false);
                            });
                        }
                    }));
        }else if(treeItem.getValue() instanceof ObjectFolder && treeItem.getValue().getName().equals("序列")){
            MetadataTreeviewUtil.getMetaConnect(treeItem).executeSqlTask(
                    new Thread(() -> {
                        ObjectList objectList = metaDBaccessService.getSequences(treeItem);
                        if(objectList.getInfo()!=null&&!objectList.getItems().isEmpty()) {
                            ((ObjectFolder) treeItem.getValue()).setDescription((String)objectList.getInfo());
                            Platform.runLater(() -> {
                                treeItem.getChildren().clear();
                                List<Sequence> sequences = objectList.getItems();
                                for (Sequence sequence : sequences) {
                                    TreeItem<TreeData> item = createLeafTreeItem(sequence);
                                    treeItem.getChildren().add(item);
                                }
                            });
                        }else{
                            Platform.runLater(() -> {
                                treeItem.getChildren().clear();
                                treeItem.setExpanded(false);
                            });
                        }
                    }));
        }else if(treeItem.getValue() instanceof ObjectFolder && treeItem.getValue().getName().equals("同义词")){
            MetadataTreeviewUtil.getMetaConnect(treeItem).executeSqlTask(
                    new Thread(() -> {
                        ObjectList objectList = metaDBaccessService.getSynonyms(treeItem);
                        if(objectList.getInfo()!=null&&!objectList.getItems().isEmpty()) {
                            ((ObjectFolder) treeItem.getValue()).setDescription((String)objectList.getInfo());
                            Platform.runLater(() -> {
                                treeItem.getChildren().clear();
                                List<Synonym> synonyms = objectList.getItems();
                                for (Synonym synonym : synonyms) {
                                    TreeItem<TreeData> item = createLeafTreeItem(synonym);
                                    treeItem.getChildren().add(item);
                                }
                            });
                        }else{
                            Platform.runLater(() -> {
                                treeItem.getChildren().clear();
                                treeItem.setExpanded(false);
                            });
                        }
                    }));
        }else if(treeItem.getValue() instanceof ObjectFolder && treeItem.getValue().getName().equals("触发器")){
            MetadataTreeviewUtil.getMetaConnect(treeItem).executeSqlTask(
                    new Thread(() -> {
                        ObjectList objectList = metaDBaccessService.getTriggers(treeItem);
                        if(objectList.getInfo()!=null&&!objectList.getItems().isEmpty()) {
                            ((ObjectFolder) treeItem.getValue()).setDescription((String)objectList.getInfo());
                            Platform.runLater(() -> {
                                treeItem.getChildren().clear();
                                List<Trigger> triggers = objectList.getItems();
                                for (Trigger trigger : triggers) {
                                    TreeItem<TreeData> item = createLeafTreeItem(trigger);
                                    treeItem.getChildren().add(item);
                                }
                            });
                        }else{
                            Platform.runLater(() -> {
                                treeItem.getChildren().clear();
                                treeItem.setExpanded(false);
                            });
                        }
                    }));
        }else if(treeItem.getValue() instanceof ObjectFolder && treeItem.getValue().getName().equals("函数")){
            MetadataTreeviewUtil.getMetaConnect(treeItem).executeSqlTask(
                    new Thread(() -> {
                        ObjectList objectList = metaDBaccessService.getFunctions(treeItem);
                        if(objectList.getInfo()!=null&&!objectList.getItems().isEmpty()) {
                            ((ObjectFolder) treeItem.getValue()).setDescription((String)objectList.getInfo());
                            Platform.runLater(() -> {
                                treeItem.getChildren().clear();
                                List<Function> functions = objectList.getItems();
                                for (Function function : functions) {
                                    TreeItem<TreeData> item = createLeafTreeItem(function);
                                    treeItem.getChildren().add(item);
                                }
                            });
                        }else{
                            Platform.runLater(() -> {
                                treeItem.getChildren().clear();
                                treeItem.setExpanded(false);
                            });
                        }
                    }));
        }else if(treeItem.getValue() instanceof ObjectFolder && treeItem.getValue().getName().equals("存储过程")){
            MetadataTreeviewUtil.getMetaConnect(treeItem).executeSqlTask(
                    new Thread(() -> {
                        ObjectList objectList = metaDBaccessService.getProcedures(treeItem);
                        if(objectList.getInfo()!=null&&!objectList.getItems().isEmpty()) {
                            ((ObjectFolder) treeItem.getValue()).setDescription((String)objectList.getInfo());
                            Platform.runLater(() -> {
                                treeItem.getChildren().clear();
                                List<Procedure> procedures = objectList.getItems();
                                for (Procedure procedure : procedures) {
                                    TreeItem<TreeData> item = createLeafTreeItem(procedure);
                                    treeItem.getChildren().add(item);
                                }
                            });
                        }else{
                            Platform.runLater(() -> {
                                treeItem.getChildren().clear();
                                treeItem.setExpanded(false);
                            });
                        }
                    }));
        }else if(treeItem.getValue() instanceof ObjectFolder && treeItem.getValue().getName().equals("包")){
            MetadataTreeviewUtil.getMetaConnect(treeItem).executeSqlTask(
                    new Thread(() -> {
                        ObjectList objectList = metaDBaccessService.getDBPackages(treeItem);
                        if(objectList.getInfo()!=null&&!objectList.getItems().isEmpty()) {
                            ((ObjectFolder) treeItem.getValue()).setDescription((String)objectList.getInfo());
                            Platform.runLater(() -> {
                                treeItem.getChildren().clear();
                                List<DBPackage> packages = objectList.getItems();
                                for (DBPackage pkg : packages) {
                                    TreeItem<TreeData> item = createTreeItem(pkg);
                                    treeItem.getChildren().add(item);
                                }
                            });
                        }else{
                            Platform.runLater(() -> {
                                treeItem.getChildren().clear();
                                treeItem.setExpanded(false);
                            });
                        }
                    }));
        }else if(treeItem.getValue() instanceof DBPackage){
            MetadataTreeviewUtil.getMetaConnect(treeItem).executeSqlTask(
                    new Thread(() -> {
                        String packageDDL = "";
                        packageDDL = metaDBaccessService.getDDL(treeItem);
                        if (!packageDDL.isEmpty()) {
                            ((DBPackage) treeItem.getValue()).setDDL(packageDDL);

                            String STRING_PATTERN = "'([^'\\\\]*(\\\\.[^'\\\\]*)*)'" + "|" + "'[\\s\\S]*";
                            String DOUBLE_STRING_PATTERN = "\"[^\"]*\"" + "|" + "\"[\\s\\S]*";
                            String FANYINHAO_STRING_PATTERN = "`[^`]*`" + "|" + "`[\\s\\S]*";
                            String COMMENT_PATTERN = "--[^\n]*" + "|" + "/\\*[\\s\\S]*?\\*/" + "|" + "/\\*[\\s\\S]*" + "|" + "\\{[\\s\\S]*?\\}";//正常，未堆栈溢出
                            String BODY_PATTERN = "(?i)\\bcreate\\s+(OR\\s+REPLACE\\s+)?(package)\\s+body\\s+([a-zA-Z_][a-zA-Z0-9_$.]*)\\s+(AS|IS)";
                            String FUNCTION_PATTERN = "(?i)function\\s+(?<FUNC>[a-zA-Z0-9_$.]*)\\s*\\([\\s\\S]*?\\)\\s+return\\s+([a-zA-Z0-9_$.]*)\\s+(PIPELINED\\s+|DETERMINISTIC\\s+|RESULT_CACHE\\s+)?(AS|IS)" + "|" +
                                    "(?i)procedure\\s+(?<PROC>[a-zA-Z0-9_$.]*)\\s*\\([\\s\\S]*?\\)\\s+(AS|IS)";

                            Pattern pattern = Pattern.compile(
                                    "(?<STRING>" + STRING_PATTERN + ")"
                                            + "|(?<DOUBLESTRING>" + DOUBLE_STRING_PATTERN + ")"
                                            + "|(?<COMMENT>" + COMMENT_PATTERN + ")"
                                            + "|(?<BODY>" + BODY_PATTERN + ")"
                            );
                            Matcher matcher = pattern.matcher(packageDDL);
                            String bodySql = "";
                            while (matcher.find()) {
                                if (matcher.group("BODY") != null) {
                                    bodySql = packageDDL.substring(matcher.start("BODY"));
                                }
                            }

                            pattern = Pattern.compile(
                                    STRING_PATTERN
                                            + "|" + DOUBLE_STRING_PATTERN
                                            + "|" + COMMENT_PATTERN
                                            + "|" + FUNCTION_PATTERN
                            );
                            matcher = pattern.matcher(bodySql);

                            Platform.runLater(() -> {
                                treeItem.getChildren().clear();
                            });

                            while (matcher.find()) {
                                if (matcher.group("FUNC") != null) {
                                    String functionname = matcher.group("FUNC");
                                    PackageFunction packageFunction = new PackageFunction(functionname);
                                    packageFunction.setDescription("FUNC");
                                    TreeItem<TreeData> item = createLeafTreeItem(packageFunction);
                                    Platform.runLater(() -> {
                                        treeItem.getChildren().add(item);
                                    });
                                }
                                if (matcher.group("PROC") != null) {
                                    String functionname = matcher.group("PROC");
                                    PackageProcedure packageProcedure = new PackageProcedure(functionname);
                                    packageProcedure.setDescription("PROC");
                                    TreeItem<TreeData> item = createLeafTreeItem(packageProcedure);
                                    Platform.runLater(() -> {
                                        treeItem.getChildren().add(item);
                                    });
                                }
                            }

                            if (((DBPackage) treeItem.getValue()).getShowDDL()) {
                                String finalPackageDDL = packageDDL;
                                Platform.runLater(() -> {
                                    PopupWindowUtil.openDDLWindow(finalPackageDDL);
                                    Platform.runLater(() -> {
                                        ((DBPackage) treeItem.getValue()).setShowDDL(false);
                                    });
                                });
                            }
                        } else {
                            Platform.runLater(() -> {
                                treeItem.getChildren().clear();
                                treeItem.setExpanded(false);
                            });
                        }

                    }));

        }



    }

    public static void connectionDisconnected(){
        TreeItem<TreeData> treeItem=getMetaConnTreeItem(Main.mainController.databasemeta_treeview.getSelectionModel().getSelectedItem());
        try {
            ((Connect)treeItem.getValue()).getConn().close();
        } catch (SQLException e) {
            log.error(e.getMessage(),e);
            ((Connect)treeItem.getValue()).setConn(null);
        }

        Platform.runLater(() -> {

            if (AlterUtil.CustomAlertConfirm("错误", "数据库已断开连接，是否需要重新连接？")) {
                treeItem.getChildren().clear();
                treeItem.setExpanded(false);
                treeItem.setExpanded(true);

            }
        });
    }

    public static TreeItem<TreeData> getMetaConnTreeItem(TreeItem<TreeData> treeItem){
        TreeItem<TreeData> retrunTreeItem=treeItem;
        if(retrunTreeItem.getValue() instanceof Connect){
            return  retrunTreeItem;
        }else if(retrunTreeItem.getValue() instanceof DatabaseFolder){
            return  retrunTreeItem.getParent();
        }else if(retrunTreeItem.getValue() instanceof UserFolder){
            return  retrunTreeItem.getParent();
        }else if(retrunTreeItem.getValue() instanceof User){
            return  retrunTreeItem.getParent().getParent();
        }else if(retrunTreeItem.getValue() instanceof Database){
            return  retrunTreeItem.getParent().getParent();
        }else if(retrunTreeItem.getValue() instanceof ObjectFolder){
            return  retrunTreeItem.getParent().getParent().getParent();
        }else if(
                retrunTreeItem.getValue() instanceof SysTable||
                        retrunTreeItem.getValue() instanceof Table||
                        retrunTreeItem.getValue() instanceof View||
                        retrunTreeItem.getValue() instanceof Index||
                        retrunTreeItem.getValue() instanceof Sequence||
                        retrunTreeItem.getValue() instanceof Synonym||
                        retrunTreeItem.getValue() instanceof Trigger||
                        retrunTreeItem.getValue() instanceof Function||
                        retrunTreeItem.getValue() instanceof Procedure||
                        retrunTreeItem.getValue() instanceof DBPackage
        ){
            return  retrunTreeItem.getParent().getParent().getParent().getParent();
        }
        else if(
                retrunTreeItem.getValue() instanceof PackageFunction||
                        retrunTreeItem.getValue() instanceof PackageProcedure

        ){
            return  retrunTreeItem.getParent().getParent().getParent().getParent().getParent();
        }
        else{
            return  retrunTreeItem;
        }
    }

    public static Connect getMetaConnect(TreeItem<TreeData> treeItem){
        return (Connect)getMetaConnTreeItem(treeItem).getValue();
    }



    public static Database getCurrentDatabase(TreeItem<TreeData> treeItem){
        TreeItem<TreeData> retrunTreeItem=treeItem;
        if(retrunTreeItem.getValue() instanceof Database){
            return  (Database) retrunTreeItem.getValue();
        }else if(retrunTreeItem.getValue() instanceof ObjectFolder){
            return  (Database) retrunTreeItem.getParent().getValue();
        }else if(retrunTreeItem.getValue() instanceof UserFolder||retrunTreeItem.getValue() instanceof User){
            Database db=new Database("sysuser");
            db.setDbLocale("en_US.819");
            return db;
        }else if(
                retrunTreeItem.getValue() instanceof SysTable||
                        retrunTreeItem.getValue() instanceof Table||
                        retrunTreeItem.getValue() instanceof View||
                        retrunTreeItem.getValue() instanceof Index||
                        retrunTreeItem.getValue() instanceof Sequence||
                        retrunTreeItem.getValue() instanceof Synonym||
                        retrunTreeItem.getValue() instanceof Trigger||
                        retrunTreeItem.getValue() instanceof Function||
                        retrunTreeItem.getValue() instanceof Procedure||
                        retrunTreeItem.getValue() instanceof DBPackage
        ){
            return  (Database) retrunTreeItem.getParent().getParent().getValue();
        }else if(
                retrunTreeItem.getValue() instanceof PackageFunction|| retrunTreeItem.getValue() instanceof PackageProcedure
        ){
            return  (Database) retrunTreeItem.getParent().getParent().getParent().getValue();
        }
        return  (Database) retrunTreeItem.getValue();

    }



    public static void disconnectItem(TreeItem<TreeData> selectedItem) {
        Connect connect =(Connect)selectedItem.getValue();
        try {
            //关闭主连接
            if(connect.getConn()!=null&&!connect.getConn().isClosed()) {
                connect.getConn().close();
                for(Tab tab :Main.mainController.sql_tabpane.getTabs()){
                    if(tab instanceof CustomSqlTab) {
                        if (selectedItem.getValue().getName().equals(((CustomSqlTab) tab).sqlTabController.SQLConnect.getName())) {
                            ((CustomSqlTab) tab).sqlTabController.closeConn();
                        }
                    }

                }
            }
            CustomInstanceTab needToRemove=null;
            for(Tab tab :Main.mainController.sql_tabpane.getTabs()) {
                if (tab instanceof CustomInstanceTab) {
                    if (("[instance check]"+selectedItem.getValue().getName()).equals( ((CustomInstanceTab) tab).getTitle())) {
                        needToRemove=(CustomInstanceTab)tab;
                    }
                }
            }
            if(needToRemove!=null)Main.mainController.sql_tabpane.getTabs().remove(needToRemove);
        } catch (SQLException e) {
            log.error(e.getMessage(),e);
            //new CustomAlert("错误",e.toString());
        }
        selectedItem.setExpanded(false);
        if(selectedItem.getChildren().size()>0) {
            selectedItem.getChildren().clear();
        }



    }


    public static void disconnectFolder(TreeItem<TreeData> selectedItem) {
        for (TreeItem<TreeData> t : selectedItem.getChildren()) {
            disconnectItem(t);
        }
        //Main.mainController.connect_list_treeview.refresh();
        //刷新
        //ConnectTreeViewUtil.reorderTreeview(connect_list_treeview,selectedItem);

    }

    public static void reconnectItem(TreeItem<TreeData> selectedItem) {
        TreeItem connTreeItem=getMetaConnTreeItem(selectedItem);
        disconnectItem(connTreeItem);
        connTreeItem.setExpanded(true);
    }

    public static void treeViewMoveConnectItem(TreeView<TreeData> treeView, TreeItem<TreeData> treeItem) {
        for (TreeItem<TreeData> ti : treeView.getRoot().getChildren()) {
            if (((ConnectFolder)ti.getValue()).getId() == ((Connect)treeItem.getValue()).getParentId()) {
                ti.getChildren().add(treeItem);
            }
        }
        treeView.getSelectionModel().select(treeItem);
        reorderTreeview(treeView, treeItem);
    }

    public static void searchTree(TreeView treeView,String searchText,Button nextButton) {
        nextButton.setOnAction(e -> findNext(treeView));
        nextButton.setDisable(true);
        //String searchText = searchField.getText().trim();
        if (searchText.isEmpty()) {
            return;
        }

        // 清空之前的搜索结果
        searchResults.clear();
        currentIndex = -1;

        // 执行搜索
        TreeItem<TreeData> root = treeView.getRoot();
        if (root != null) {
            traverseNode(root, searchText);
        }

        // 处理搜索结果
        if (searchResults.isEmpty()) {
            NotificationUtil.showNotification(Main.mainController.notice_pane,"未搜索到匹配项，请确保需查找的对象已加载！");
        } else {
            findNext(treeView);
            // 更新按钮状态
            if(searchResults.size()>1){
                nextButton.setDisable(false);
            }
        }
    }

    /**
     * 查找下一个匹配项
     */
    private static void findNext(TreeView treeView) {
        if (searchResults.isEmpty()) {
            return;
        }

        // 更新当前索引
        currentIndex = (currentIndex + 1) % searchResults.size();

        // 获取当前匹配项
        TreeItem<TreeData> currentItem = searchResults.get(currentIndex);

        // 滚动到并选中当前项
        treeView.getSelectionModel().select(currentItem);
        treeView.scrollTo(treeView.getRow(currentItem));

        // 如果是最后一个，提示用户下一次将从头开始
        if (currentIndex == searchResults.size() - 1) {
            if(currentIndex==0){
                NotificationUtil.showNotification(Main.mainController.notice_pane,"仅匹配当前一个！");
            }else{
                NotificationUtil.showNotification(Main.mainController.notice_pane,"搜索已到最后，下一个从头开始搜索！");
            }
        }
    }

    /**
     * 递归遍历节点及其子节点，收集匹配的叶子节点
     */
    private static void traverseNode(TreeItem<TreeData> node, String searchText) {

        //rootitem未设置值可能为null
        if(node.getValue()!=null&&node.getValue().getName().toLowerCase().contains(searchText.toLowerCase())){
            searchResults.add(node);
        }
        // 如果节点未展开，则不继续遍历其子节点
        if (!node.isExpanded()) {
            if(node.getChildren().size()>0){
                //node.setExpanded(true);
            }else{
                return;
            }
        }

        // 如果是叶子节点，检查其值

        // 不是叶子节点，则递归遍历所有子节点

        for (TreeItem<TreeData> child : node.getChildren()) {
            traverseNode(child, searchText);
        }

    }


    //弹出创建连接对话框
    public static void showCreateConnectDialog(TreeData treedataPram,Boolean isCopy)  {
        try {
            FXMLLoader loader = new FXMLLoader(CreateConnectController.class.getResource("/com/dbboys/fxml/CreateConnect.fxml"));
            DialogPane dialogPane = loader.load();
            CreateConnectController controller = loader.getController();
            Dialog<ButtonType> dialog = new Dialog<>();
            controller.init(treedataPram, isCopy,dialog);
            dialog.setDialogPane(dialogPane);
            dialog.setTitle("新建/编辑/复制数据库连接");
            Stage alterstage = (Stage) dialog.getDialogPane().getScene().getWindow();
            alterstage.getIcons().add(new Image("file:images/logo.png"));
            dialogPane.getScene().getStylesheets().add(MetadataTreeviewUtil.class.getResource("/com/dbboys/css/app.css").toExternalForm());
            TextField connectname_textfield = (TextField) loader.getNamespace().get("connectname_textfield");
            dialogPane.getScene().getWindow().setOnShown(event -> {
                connectname_textfield.requestFocus();
            });
            dialog.setOnCloseRequest(e -> {
                dialog.close();
            });
            dialog.showAndWait();
        } catch (Exception e) {
            throw new RuntimeException(e);
        }

    }

}
